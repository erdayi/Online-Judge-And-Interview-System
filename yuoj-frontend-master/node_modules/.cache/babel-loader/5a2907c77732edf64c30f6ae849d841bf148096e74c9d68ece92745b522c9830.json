{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nlet StickyScrollController = class StickyScrollController extends Disposable {\n  constructor(_editor, _contextMenuService, _languageFeaturesService, _instaService, _languageConfigurationService, _languageFeatureDebounceService, _contextKeyService) {\n    super();\n    this._editor = _editor;\n    this._contextMenuService = _contextMenuService;\n    this._languageFeaturesService = _languageFeaturesService;\n    this._instaService = _instaService;\n    this._contextKeyService = _contextKeyService;\n    this._sessionStore = new DisposableStore();\n    this._maxStickyLines = Number.MAX_SAFE_INTEGER;\n    this._candidateDefinitionsLength = -1;\n    this._focusedStickyElementIndex = -1;\n    this._enabled = false;\n    this._focused = false;\n    this._positionRevealed = false;\n    this._onMouseDown = false;\n    this._stickyScrollWidget = new StickyScrollWidget(this._editor);\n    this._stickyLineCandidateProvider = new StickyLineCandidateProvider(this._editor, _languageFeaturesService, _languageConfigurationService);\n    this._register(this._stickyScrollWidget);\n    this._register(this._stickyLineCandidateProvider);\n    this._widgetState = new StickyScrollWidgetState([], 0);\n    this._readConfiguration();\n    this._register(this._editor.onDidChangeConfiguration(e => {\n      if (e.hasChanged(113 /* EditorOption.stickyScroll */)) {\n        this._readConfiguration();\n      }\n    }));\n    this._register(dom.addDisposableListener(this._stickyScrollWidget.getDomNode(), dom.EventType.CONTEXT_MENU, event => __awaiter(this, void 0, void 0, function* () {\n      this._onContextMenu(event);\n    })));\n    this._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService);\n    this._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);\n    const focusTracker = this._register(dom.trackFocus(this._stickyScrollWidget.getDomNode()));\n    this._register(focusTracker.onDidBlur(_ => {\n      const height = this._stickyScrollWidget.getDomNode().clientHeight;\n      // Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n      // This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n      if (this._positionRevealed === false && height === 0) {\n        this._focusedStickyElementIndex = -1;\n        this.focus();\n      }\n      // In all other casees, dispose the focus on the sticky scroll\n      else {\n        this._disposeFocusStickyScrollStore();\n      }\n    }));\n    this._register(focusTracker.onDidFocus(_ => {\n      this.focus();\n    }));\n    this._register(this._createClickLinkGesture());\n    // Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n    this._register(dom.addDisposableListener(this._stickyScrollWidget.getDomNode(), dom.EventType.MOUSE_DOWN, e => {\n      this._onMouseDown = true;\n    }));\n  }\n  static get(editor) {\n    return editor.getContribution(StickyScrollController.ID);\n  }\n  _disposeFocusStickyScrollStore() {\n    var _a;\n    this._stickyScrollFocusedContextKey.set(false);\n    (_a = this._focusDisposableStore) === null || _a === void 0 ? void 0 : _a.dispose();\n    this._focused = false;\n    this._positionRevealed = false;\n    this._onMouseDown = false;\n  }\n  focus() {\n    // If the mouse is down, do not focus on the sticky scroll\n    if (this._onMouseDown) {\n      this._onMouseDown = false;\n      this._editor.focus();\n      return;\n    }\n    const focusState = this._stickyScrollFocusedContextKey.get();\n    if (focusState === true) {\n      return;\n    }\n    this._focused = true;\n    this._focusDisposableStore = new DisposableStore();\n    this._stickyScrollFocusedContextKey.set(true);\n    const rootNode = this._stickyScrollWidget.getDomNode();\n    rootNode.lastElementChild.focus();\n    this._stickyElements = rootNode.children;\n    this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n  }\n  focusNext() {\n    if (this._focusedStickyElementIndex < this._stickyElements.length - 1) {\n      this._focusNav(true);\n    }\n  }\n  focusPrevious() {\n    if (this._focusedStickyElementIndex > 0) {\n      this._focusNav(false);\n    }\n  }\n  selectEditor() {\n    this._editor.focus();\n  }\n  // True is next, false is previous\n  _focusNav(direction) {\n    this._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n    this._stickyElements.item(this._focusedStickyElementIndex).focus();\n  }\n  goToFocused() {\n    const lineNumbers = this._stickyScrollWidget.lineNumbers;\n    this._disposeFocusStickyScrollStore();\n    this._revealPosition({\n      lineNumber: lineNumbers[this._focusedStickyElementIndex],\n      column: 1\n    });\n  }\n  _revealPosition(position) {\n    this._positionRevealed = true;\n    this._editor.revealPosition(position);\n    this._editor.setSelection(Range.fromPositions(position));\n    this._editor.focus();\n  }\n  _createClickLinkGesture() {\n    const linkGestureStore = new DisposableStore();\n    const sessionStore = new DisposableStore();\n    linkGestureStore.add(sessionStore);\n    const gesture = new ClickLinkGesture(this._editor, true);\n    linkGestureStore.add(gesture);\n    linkGestureStore.add(gesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, _keyboardEvent]) => {\n      if (!this._editor.hasModel() || !mouseEvent.hasTriggerModifier) {\n        sessionStore.clear();\n        return;\n      }\n      const targetMouseEvent = mouseEvent.target;\n      if (targetMouseEvent.detail === this._stickyScrollWidget.getId() && targetMouseEvent.element.innerText === targetMouseEvent.element.innerHTML) {\n        const text = targetMouseEvent.element.innerText;\n        if (this._stickyScrollWidget.hoverOnColumn === -1) {\n          return;\n        }\n        const lineNumber = this._stickyScrollWidget.hoverOnLine;\n        const column = this._stickyScrollWidget.hoverOnColumn;\n        const stickyPositionProjectedOnEditor = new Range(lineNumber, column, lineNumber, column + text.length);\n        if (!stickyPositionProjectedOnEditor.equalsRange(this._stickyRangeProjectedOnEditor)) {\n          this._stickyRangeProjectedOnEditor = stickyPositionProjectedOnEditor;\n          sessionStore.clear();\n        } else if (targetMouseEvent.element.style.textDecoration === 'underline') {\n          return;\n        }\n        const cancellationToken = new CancellationTokenSource();\n        sessionStore.add(toDisposable(() => cancellationToken.dispose(true)));\n        let currentHTMLChild;\n        getDefinitionsAtPosition(this._languageFeaturesService.definitionProvider, this._editor.getModel(), new Position(lineNumber, column + 1), cancellationToken.token).then(candidateDefinitions => {\n          if (cancellationToken.token.isCancellationRequested) {\n            return;\n          }\n          if (candidateDefinitions.length !== 0) {\n            this._candidateDefinitionsLength = candidateDefinitions.length;\n            const childHTML = targetMouseEvent.element;\n            if (currentHTMLChild !== childHTML) {\n              sessionStore.clear();\n              currentHTMLChild = childHTML;\n              currentHTMLChild.style.textDecoration = 'underline';\n              sessionStore.add(toDisposable(() => {\n                currentHTMLChild.style.textDecoration = 'none';\n              }));\n            } else if (!currentHTMLChild) {\n              currentHTMLChild = childHTML;\n              currentHTMLChild.style.textDecoration = 'underline';\n              sessionStore.add(toDisposable(() => {\n                currentHTMLChild.style.textDecoration = 'none';\n              }));\n            }\n          } else {\n            sessionStore.clear();\n          }\n        });\n      } else {\n        sessionStore.clear();\n      }\n    }));\n    linkGestureStore.add(gesture.onCancel(() => {\n      sessionStore.clear();\n    }));\n    linkGestureStore.add(gesture.onExecute(e => __awaiter(this, void 0, void 0, function* () {\n      if (e.target.detail !== this._stickyScrollWidget.getId()) {\n        return;\n      }\n      if (e.hasTriggerModifier) {\n        // Control click\n        if (this._candidateDefinitionsLength > 1) {\n          if (this._focused) {\n            this._disposeFocusStickyScrollStore();\n          }\n          this._revealPosition({\n            lineNumber: this._stickyScrollWidget.hoverOnLine,\n            column: 1\n          });\n        }\n        this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, {\n          uri: this._editor.getModel().uri,\n          range: this._stickyRangeProjectedOnEditor\n        });\n      } else if (!e.isRightClick) {\n        // Normal click\n        if (this._focused) {\n          this._disposeFocusStickyScrollStore();\n        }\n        this._revealPosition({\n          lineNumber: this._stickyScrollWidget.hoverOnLine,\n          column: this._stickyScrollWidget.hoverOnColumn\n        });\n      }\n    })));\n    return linkGestureStore;\n  }\n  _onContextMenu(e) {\n    const event = new StandardMouseEvent(e);\n    this._contextMenuService.showContextMenu({\n      menuId: MenuId.StickyScrollContext,\n      getAnchor: () => event\n    });\n  }\n  _readConfiguration() {\n    const options = this._editor.getOption(113 /* EditorOption.stickyScroll */);\n    if (options.enabled === false) {\n      this._editor.removeOverlayWidget(this._stickyScrollWidget);\n      this._sessionStore.clear();\n      this._enabled = false;\n      return;\n    } else if (options.enabled && !this._enabled) {\n      // When sticky scroll was just enabled, add the listeners on the sticky scroll\n      this._editor.addOverlayWidget(this._stickyScrollWidget);\n      this._sessionStore.add(this._editor.onDidScrollChange(() => this._renderStickyScroll()));\n      this._sessionStore.add(this._editor.onDidLayoutChange(() => this._onDidResize()));\n      this._sessionStore.add(this._editor.onDidChangeModelTokens(e => this._onTokensChange(e)));\n      this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(() => this._renderStickyScroll()));\n      this._enabled = true;\n    }\n    const lineNumberOption = this._editor.getOption(66 /* EditorOption.lineNumbers */);\n    if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n      this._sessionStore.add(this._editor.onDidChangeCursorPosition(() => this._renderStickyScroll()));\n    }\n  }\n  _needsUpdate(event) {\n    const stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n    for (const stickyLineNumber of stickyLineNumbers) {\n      for (const range of event.ranges) {\n        if (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  _onTokensChange(event) {\n    if (this._needsUpdate(event)) {\n      this._renderStickyScroll();\n    }\n  }\n  _onDidResize() {\n    const layoutInfo = this._editor.getLayoutInfo();\n    const width = layoutInfo.width - layoutInfo.minimap.minimapCanvasOuterWidth - layoutInfo.verticalScrollbarWidth;\n    this._stickyScrollWidget.getDomNode().style.width = `${width}px`;\n    // Make sure sticky scroll doesn't take up more than 25% of the editor\n    const theoreticalLines = layoutInfo.height / this._editor.getOption(65 /* EditorOption.lineHeight */);\n    this._maxStickyLines = Math.round(theoreticalLines * .25);\n  }\n  _renderStickyScroll() {\n    if (!this._editor.hasModel()) {\n      return;\n    }\n    const model = this._editor.getModel();\n    const stickyLineVersion = this._stickyLineCandidateProvider.getVersionId();\n    if (stickyLineVersion === undefined || stickyLineVersion === model.getVersionId()) {\n      this._widgetState = this.findScrollWidgetState();\n      this._stickyScrollVisibleContextKey.set(!(this._widgetState.lineNumbers.length === 0));\n      if (!this._focused) {\n        this._stickyScrollWidget.setState(this._widgetState);\n      } else {\n        this._stickyElements = this._stickyScrollWidget.getDomNode().children;\n        // Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n        if (this._focusedStickyElementIndex === -1) {\n          this._stickyScrollWidget.setState(this._widgetState);\n          this._focusedStickyElementIndex = this._stickyElements.length - 1;\n          if (this._focusedStickyElementIndex !== -1) {\n            this._stickyElements.item(this._focusedStickyElementIndex).focus();\n          }\n        } else {\n          const focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n          this._stickyScrollWidget.setState(this._widgetState);\n          // Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n          if (this._stickyElements.length === 0) {\n            this._focusedStickyElementIndex = -1;\n          } else {\n            const previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber);\n            // If the line number is still there, do not change anything\n            // If the line number is not there, set the new focused line to be the last line\n            if (!previousFocusedLineNumberExists) {\n              this._focusedStickyElementIndex = this._stickyElements.length - 1;\n            }\n            this._stickyElements.item(this._focusedStickyElementIndex).focus();\n          }\n        }\n      }\n    }\n  }\n  findScrollWidgetState() {\n    const lineHeight = this._editor.getOption(65 /* EditorOption.lineHeight */);\n    const maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(113 /* EditorOption.stickyScroll */).maxLineCount);\n    const scrollTop = this._editor.getScrollTop();\n    let lastLineRelativePosition = 0;\n    const lineNumbers = [];\n    const arrayVisibleRanges = this._editor.getVisibleRanges();\n    if (arrayVisibleRanges.length !== 0) {\n      const fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n      const candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n      for (const range of candidateRanges) {\n        const start = range.startLineNumber;\n        const end = range.endLineNumber;\n        const depth = range.nestingDepth;\n        if (end - start > 0) {\n          const topOfElementAtDepth = (depth - 1) * lineHeight;\n          const bottomOfElementAtDepth = depth * lineHeight;\n          const bottomOfBeginningLine = this._editor.getBottomForLineNumber(start) - scrollTop;\n          const topOfEndLine = this._editor.getTopForLineNumber(end) - scrollTop;\n          const bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n          if (topOfElementAtDepth > topOfEndLine && topOfElementAtDepth <= bottomOfEndLine) {\n            lineNumbers.push(start);\n            lastLineRelativePosition = bottomOfEndLine - bottomOfElementAtDepth;\n            break;\n          } else if (bottomOfElementAtDepth > bottomOfBeginningLine && bottomOfElementAtDepth <= bottomOfEndLine) {\n            lineNumbers.push(start);\n          }\n          if (lineNumbers.length === maxNumberStickyLines) {\n            break;\n          }\n        }\n      }\n    }\n    return new StickyScrollWidgetState(lineNumbers, lastLineRelativePosition);\n  }\n  dispose() {\n    super.dispose();\n    this._sessionStore.dispose();\n  }\n};\nStickyScrollController.ID = 'store.contrib.stickyScrollController';\nStickyScrollController = __decorate([__param(1, IContextMenuService), __param(2, ILanguageFeaturesService), __param(3, IInstantiationService), __param(4, ILanguageConfigurationService), __param(5, ILanguageFeatureDebounceService), __param(6, IContextKeyService)], StickyScrollController);\nexport { StickyScrollController };","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Disposable","DisposableStore","toDisposable","ILanguageFeaturesService","StickyScrollWidget","StickyScrollWidgetState","StickyLineCandidateProvider","IInstantiationService","IContextMenuService","MenuId","IContextKeyService","EditorContextKeys","ClickLinkGesture","Range","getDefinitionsAtPosition","goToDefinitionWithLocation","Position","CancellationTokenSource","ILanguageConfigurationService","ILanguageFeatureDebounceService","dom","StickyRange","StandardMouseEvent","StickyScrollController","constructor","_editor","_contextMenuService","_languageFeaturesService","_instaService","_languageConfigurationService","_languageFeatureDebounceService","_contextKeyService","_sessionStore","_maxStickyLines","Number","MAX_SAFE_INTEGER","_candidateDefinitionsLength","_focusedStickyElementIndex","_enabled","_focused","_positionRevealed","_onMouseDown","_stickyScrollWidget","_stickyLineCandidateProvider","_register","_widgetState","_readConfiguration","onDidChangeConfiguration","hasChanged","addDisposableListener","getDomNode","EventType","CONTEXT_MENU","event","_onContextMenu","_stickyScrollFocusedContextKey","stickyScrollFocused","bindTo","_stickyScrollVisibleContextKey","stickyScrollVisible","focusTracker","trackFocus","onDidBlur","_","height","clientHeight","focus","_disposeFocusStickyScrollStore","onDidFocus","_createClickLinkGesture","MOUSE_DOWN","get","editor","getContribution","ID","_a","set","_focusDisposableStore","dispose","focusState","rootNode","lastElementChild","_stickyElements","children","lineNumbers","focusNext","_focusNav","focusPrevious","selectEditor","direction","item","goToFocused","_revealPosition","lineNumber","column","position","revealPosition","setSelection","fromPositions","linkGestureStore","sessionStore","add","gesture","onMouseMoveOrRelevantKeyDown","mouseEvent","_keyboardEvent","hasModel","hasTriggerModifier","clear","targetMouseEvent","detail","getId","element","innerText","innerHTML","text","hoverOnColumn","hoverOnLine","stickyPositionProjectedOnEditor","equalsRange","_stickyRangeProjectedOnEditor","style","textDecoration","cancellationToken","currentHTMLChild","definitionProvider","getModel","token","candidateDefinitions","isCancellationRequested","childHTML","onCancel","onExecute","invokeFunction","uri","range","isRightClick","showContextMenu","menuId","StickyScrollContext","getAnchor","options","getOption","enabled","removeOverlayWidget","addOverlayWidget","onDidScrollChange","_renderStickyScroll","onDidLayoutChange","_onDidResize","onDidChangeModelTokens","_onTokensChange","onDidChangeStickyScroll","lineNumberOption","renderType","onDidChangeCursorPosition","_needsUpdate","stickyLineNumbers","getCurrentLines","stickyLineNumber","ranges","fromLineNumber","toLineNumber","layoutInfo","getLayoutInfo","width","minimap","minimapCanvasOuterWidth","verticalScrollbarWidth","theoreticalLines","Math","round","model","stickyLineVersion","getVersionId","undefined","findScrollWidgetState","setState","focusedStickyElementLineNumber","previousFocusedLineNumberExists","includes","lineHeight","maxNumberStickyLines","min","maxLineCount","scrollTop","getScrollTop","lastLineRelativePosition","arrayVisibleRanges","getVisibleRanges","fullVisibleRange","startLineNumber","endLineNumber","candidateRanges","getCandidateStickyLinesIntersecting","start","end","depth","nestingDepth","topOfElementAtDepth","bottomOfElementAtDepth","bottomOfBeginningLine","getBottomForLineNumber","topOfEndLine","getTopForLineNumber","bottomOfEndLine","push"],"sources":["D:/code/java/program/oj/code/yuoj-frontend-master/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollController.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nimport { StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nlet StickyScrollController = class StickyScrollController extends Disposable {\n    constructor(_editor, _contextMenuService, _languageFeaturesService, _instaService, _languageConfigurationService, _languageFeatureDebounceService, _contextKeyService) {\n        super();\n        this._editor = _editor;\n        this._contextMenuService = _contextMenuService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instaService = _instaService;\n        this._contextKeyService = _contextKeyService;\n        this._sessionStore = new DisposableStore();\n        this._maxStickyLines = Number.MAX_SAFE_INTEGER;\n        this._candidateDefinitionsLength = -1;\n        this._focusedStickyElementIndex = -1;\n        this._enabled = false;\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n        this._stickyScrollWidget = new StickyScrollWidget(this._editor);\n        this._stickyLineCandidateProvider = new StickyLineCandidateProvider(this._editor, _languageFeaturesService, _languageConfigurationService);\n        this._register(this._stickyScrollWidget);\n        this._register(this._stickyLineCandidateProvider);\n        this._widgetState = new StickyScrollWidgetState([], 0);\n        this._readConfiguration();\n        this._register(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(113 /* EditorOption.stickyScroll */)) {\n                this._readConfiguration();\n            }\n        }));\n        this._register(dom.addDisposableListener(this._stickyScrollWidget.getDomNode(), dom.EventType.CONTEXT_MENU, (event) => __awaiter(this, void 0, void 0, function* () {\n            this._onContextMenu(event);\n        })));\n        this._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService);\n        this._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);\n        const focusTracker = this._register(dom.trackFocus(this._stickyScrollWidget.getDomNode()));\n        this._register(focusTracker.onDidBlur(_ => {\n            const height = this._stickyScrollWidget.getDomNode().clientHeight;\n            // Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n            // This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n            if (this._positionRevealed === false && height === 0) {\n                this._focusedStickyElementIndex = -1;\n                this.focus();\n            }\n            // In all other casees, dispose the focus on the sticky scroll\n            else {\n                this._disposeFocusStickyScrollStore();\n            }\n        }));\n        this._register(focusTracker.onDidFocus(_ => {\n            this.focus();\n        }));\n        this._register(this._createClickLinkGesture());\n        // Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n        this._register(dom.addDisposableListener(this._stickyScrollWidget.getDomNode(), dom.EventType.MOUSE_DOWN, (e) => {\n            this._onMouseDown = true;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(StickyScrollController.ID);\n    }\n    _disposeFocusStickyScrollStore() {\n        var _a;\n        this._stickyScrollFocusedContextKey.set(false);\n        (_a = this._focusDisposableStore) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._focused = false;\n        this._positionRevealed = false;\n        this._onMouseDown = false;\n    }\n    focus() {\n        // If the mouse is down, do not focus on the sticky scroll\n        if (this._onMouseDown) {\n            this._onMouseDown = false;\n            this._editor.focus();\n            return;\n        }\n        const focusState = this._stickyScrollFocusedContextKey.get();\n        if (focusState === true) {\n            return;\n        }\n        this._focused = true;\n        this._focusDisposableStore = new DisposableStore();\n        this._stickyScrollFocusedContextKey.set(true);\n        const rootNode = this._stickyScrollWidget.getDomNode();\n        rootNode.lastElementChild.focus();\n        this._stickyElements = rootNode.children;\n        this._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n    }\n    focusNext() {\n        if (this._focusedStickyElementIndex < this._stickyElements.length - 1) {\n            this._focusNav(true);\n        }\n    }\n    focusPrevious() {\n        if (this._focusedStickyElementIndex > 0) {\n            this._focusNav(false);\n        }\n    }\n    selectEditor() {\n        this._editor.focus();\n    }\n    // True is next, false is previous\n    _focusNav(direction) {\n        this._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n        this._stickyElements.item(this._focusedStickyElementIndex).focus();\n    }\n    goToFocused() {\n        const lineNumbers = this._stickyScrollWidget.lineNumbers;\n        this._disposeFocusStickyScrollStore();\n        this._revealPosition({ lineNumber: lineNumbers[this._focusedStickyElementIndex], column: 1 });\n    }\n    _revealPosition(position) {\n        this._positionRevealed = true;\n        this._editor.revealPosition(position);\n        this._editor.setSelection(Range.fromPositions(position));\n        this._editor.focus();\n    }\n    _createClickLinkGesture() {\n        const linkGestureStore = new DisposableStore();\n        const sessionStore = new DisposableStore();\n        linkGestureStore.add(sessionStore);\n        const gesture = new ClickLinkGesture(this._editor, true);\n        linkGestureStore.add(gesture);\n        linkGestureStore.add(gesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, _keyboardEvent]) => {\n            if (!this._editor.hasModel() || !mouseEvent.hasTriggerModifier) {\n                sessionStore.clear();\n                return;\n            }\n            const targetMouseEvent = mouseEvent.target;\n            if (targetMouseEvent.detail === this._stickyScrollWidget.getId()\n                && targetMouseEvent.element.innerText === targetMouseEvent.element.innerHTML) {\n                const text = targetMouseEvent.element.innerText;\n                if (this._stickyScrollWidget.hoverOnColumn === -1) {\n                    return;\n                }\n                const lineNumber = this._stickyScrollWidget.hoverOnLine;\n                const column = this._stickyScrollWidget.hoverOnColumn;\n                const stickyPositionProjectedOnEditor = new Range(lineNumber, column, lineNumber, column + text.length);\n                if (!stickyPositionProjectedOnEditor.equalsRange(this._stickyRangeProjectedOnEditor)) {\n                    this._stickyRangeProjectedOnEditor = stickyPositionProjectedOnEditor;\n                    sessionStore.clear();\n                }\n                else if (targetMouseEvent.element.style.textDecoration === 'underline') {\n                    return;\n                }\n                const cancellationToken = new CancellationTokenSource();\n                sessionStore.add(toDisposable(() => cancellationToken.dispose(true)));\n                let currentHTMLChild;\n                getDefinitionsAtPosition(this._languageFeaturesService.definitionProvider, this._editor.getModel(), new Position(lineNumber, column + 1), cancellationToken.token).then((candidateDefinitions => {\n                    if (cancellationToken.token.isCancellationRequested) {\n                        return;\n                    }\n                    if (candidateDefinitions.length !== 0) {\n                        this._candidateDefinitionsLength = candidateDefinitions.length;\n                        const childHTML = targetMouseEvent.element;\n                        if (currentHTMLChild !== childHTML) {\n                            sessionStore.clear();\n                            currentHTMLChild = childHTML;\n                            currentHTMLChild.style.textDecoration = 'underline';\n                            sessionStore.add(toDisposable(() => {\n                                currentHTMLChild.style.textDecoration = 'none';\n                            }));\n                        }\n                        else if (!currentHTMLChild) {\n                            currentHTMLChild = childHTML;\n                            currentHTMLChild.style.textDecoration = 'underline';\n                            sessionStore.add(toDisposable(() => {\n                                currentHTMLChild.style.textDecoration = 'none';\n                            }));\n                        }\n                    }\n                    else {\n                        sessionStore.clear();\n                    }\n                }));\n            }\n            else {\n                sessionStore.clear();\n            }\n        }));\n        linkGestureStore.add(gesture.onCancel(() => {\n            sessionStore.clear();\n        }));\n        linkGestureStore.add(gesture.onExecute((e) => __awaiter(this, void 0, void 0, function* () {\n            if (e.target.detail !== this._stickyScrollWidget.getId()) {\n                return;\n            }\n            if (e.hasTriggerModifier) {\n                // Control click\n                if (this._candidateDefinitionsLength > 1) {\n                    if (this._focused) {\n                        this._disposeFocusStickyScrollStore();\n                    }\n                    this._revealPosition({ lineNumber: this._stickyScrollWidget.hoverOnLine, column: 1 });\n                }\n                this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, { uri: this._editor.getModel().uri, range: this._stickyRangeProjectedOnEditor });\n            }\n            else if (!e.isRightClick) {\n                // Normal click\n                if (this._focused) {\n                    this._disposeFocusStickyScrollStore();\n                }\n                this._revealPosition({ lineNumber: this._stickyScrollWidget.hoverOnLine, column: this._stickyScrollWidget.hoverOnColumn });\n            }\n        })));\n        return linkGestureStore;\n    }\n    _onContextMenu(e) {\n        const event = new StandardMouseEvent(e);\n        this._contextMenuService.showContextMenu({\n            menuId: MenuId.StickyScrollContext,\n            getAnchor: () => event,\n        });\n    }\n    _readConfiguration() {\n        const options = this._editor.getOption(113 /* EditorOption.stickyScroll */);\n        if (options.enabled === false) {\n            this._editor.removeOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.clear();\n            this._enabled = false;\n            return;\n        }\n        else if (options.enabled && !this._enabled) {\n            // When sticky scroll was just enabled, add the listeners on the sticky scroll\n            this._editor.addOverlayWidget(this._stickyScrollWidget);\n            this._sessionStore.add(this._editor.onDidScrollChange(() => this._renderStickyScroll()));\n            this._sessionStore.add(this._editor.onDidLayoutChange(() => this._onDidResize()));\n            this._sessionStore.add(this._editor.onDidChangeModelTokens((e) => this._onTokensChange(e)));\n            this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(() => this._renderStickyScroll()));\n            this._enabled = true;\n        }\n        const lineNumberOption = this._editor.getOption(66 /* EditorOption.lineNumbers */);\n        if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            this._sessionStore.add(this._editor.onDidChangeCursorPosition(() => this._renderStickyScroll()));\n        }\n    }\n    _needsUpdate(event) {\n        const stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n        for (const stickyLineNumber of stickyLineNumbers) {\n            for (const range of event.ranges) {\n                if (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    _onTokensChange(event) {\n        if (this._needsUpdate(event)) {\n            this._renderStickyScroll();\n        }\n    }\n    _onDidResize() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        const width = layoutInfo.width - layoutInfo.minimap.minimapCanvasOuterWidth - layoutInfo.verticalScrollbarWidth;\n        this._stickyScrollWidget.getDomNode().style.width = `${width}px`;\n        // Make sure sticky scroll doesn't take up more than 25% of the editor\n        const theoreticalLines = layoutInfo.height / this._editor.getOption(65 /* EditorOption.lineHeight */);\n        this._maxStickyLines = Math.round(theoreticalLines * .25);\n    }\n    _renderStickyScroll() {\n        if (!(this._editor.hasModel())) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const stickyLineVersion = this._stickyLineCandidateProvider.getVersionId();\n        if (stickyLineVersion === undefined || stickyLineVersion === model.getVersionId()) {\n            this._widgetState = this.findScrollWidgetState();\n            this._stickyScrollVisibleContextKey.set(!(this._widgetState.lineNumbers.length === 0));\n            if (!this._focused) {\n                this._stickyScrollWidget.setState(this._widgetState);\n            }\n            else {\n                this._stickyElements = this._stickyScrollWidget.getDomNode().children;\n                // Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n                if (this._focusedStickyElementIndex === -1) {\n                    this._stickyScrollWidget.setState(this._widgetState);\n                    this._focusedStickyElementIndex = this._stickyElements.length - 1;\n                    if (this._focusedStickyElementIndex !== -1) {\n                        this._stickyElements.item(this._focusedStickyElementIndex).focus();\n                    }\n                }\n                else {\n                    const focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n                    this._stickyScrollWidget.setState(this._widgetState);\n                    // Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n                    if (this._stickyElements.length === 0) {\n                        this._focusedStickyElementIndex = -1;\n                    }\n                    else {\n                        const previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber);\n                        // If the line number is still there, do not change anything\n                        // If the line number is not there, set the new focused line to be the last line\n                        if (!previousFocusedLineNumberExists) {\n                            this._focusedStickyElementIndex = this._stickyElements.length - 1;\n                        }\n                        this._stickyElements.item(this._focusedStickyElementIndex).focus();\n                    }\n                }\n            }\n        }\n    }\n    findScrollWidgetState() {\n        const lineHeight = this._editor.getOption(65 /* EditorOption.lineHeight */);\n        const maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(113 /* EditorOption.stickyScroll */).maxLineCount);\n        const scrollTop = this._editor.getScrollTop();\n        let lastLineRelativePosition = 0;\n        const lineNumbers = [];\n        const arrayVisibleRanges = this._editor.getVisibleRanges();\n        if (arrayVisibleRanges.length !== 0) {\n            const fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n            const candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n            for (const range of candidateRanges) {\n                const start = range.startLineNumber;\n                const end = range.endLineNumber;\n                const depth = range.nestingDepth;\n                if (end - start > 0) {\n                    const topOfElementAtDepth = (depth - 1) * lineHeight;\n                    const bottomOfElementAtDepth = depth * lineHeight;\n                    const bottomOfBeginningLine = this._editor.getBottomForLineNumber(start) - scrollTop;\n                    const topOfEndLine = this._editor.getTopForLineNumber(end) - scrollTop;\n                    const bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n                    if (topOfElementAtDepth > topOfEndLine && topOfElementAtDepth <= bottomOfEndLine) {\n                        lineNumbers.push(start);\n                        lastLineRelativePosition = bottomOfEndLine - bottomOfElementAtDepth;\n                        break;\n                    }\n                    else if (bottomOfElementAtDepth > bottomOfBeginningLine && bottomOfElementAtDepth <= bottomOfEndLine) {\n                        lineNumbers.push(start);\n                    }\n                    if (lineNumbers.length === maxNumberStickyLines) {\n                        break;\n                    }\n                }\n            }\n        }\n        return new StickyScrollWidgetState(lineNumbers, lastLineRelativePosition);\n    }\n    dispose() {\n        super.dispose();\n        this._sessionStore.dispose();\n    }\n};\nStickyScrollController.ID = 'store.contrib.stickyScrollController';\nStickyScrollController = __decorate([\n    __param(1, IContextMenuService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IInstantiationService),\n    __param(4, ILanguageConfigurationService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, IContextKeyService)\n], StickyScrollController);\nexport { StickyScrollController };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}