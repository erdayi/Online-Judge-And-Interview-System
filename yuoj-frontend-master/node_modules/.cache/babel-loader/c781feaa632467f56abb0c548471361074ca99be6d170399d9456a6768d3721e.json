{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { HoverAction, HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { HoverParticipantRegistry, HoverRangeAnchor } from './hoverTypes.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ResizableContentWidget } from './resizableContentWidget.js';\nconst $ = dom.$;\nlet ContentHoverController = class ContentHoverController extends Disposable {\n  constructor(_editor, _instantiationService, _keybindingService) {\n    super();\n    this._editor = _editor;\n    this._instantiationService = _instantiationService;\n    this._keybindingService = _keybindingService;\n    this._currentResult = null;\n    const minimumHeight = this._editor.getOption(65 /* EditorOption.lineHeight */) + 8;\n    const minimumWidth = 4 / 3 * minimumHeight;\n    const minimumSize = new dom.Dimension(minimumWidth, minimumHeight);\n    this._widget = this._register(this._instantiationService.createInstance(ContentHoverWidget, this._editor, minimumSize));\n    // Instantiate participants and sort them by `hoverOrdinal` which is relevant for rendering order.\n    this._participants = [];\n    for (const participant of HoverParticipantRegistry.getAll()) {\n      this._participants.push(this._instantiationService.createInstance(participant, this._editor));\n    }\n    this._participants.sort((p1, p2) => p1.hoverOrdinal - p2.hoverOrdinal);\n    this._computer = new ContentHoverComputer(this._editor, this._participants);\n    this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n    this._register(this._hoverOperation.onResult(result => {\n      if (!this._computer.anchor) {\n        // invalid state, ignore result\n        return;\n      }\n      const messages = result.hasLoadingMessage ? this._addLoadingMessage(result.value) : result.value;\n      this._withResult(new HoverResult(this._computer.anchor, messages, result.isComplete));\n    }));\n    this._register(dom.addStandardDisposableListener(this._widget.getDomNode(), 'keydown', e => {\n      if (e.equals(9 /* KeyCode.Escape */)) {\n        this.hide();\n      }\n    }));\n    this._register(TokenizationRegistry.onDidChange(() => {\n      if (this._widget.position && this._currentResult) {\n        this._setCurrentResult(this._currentResult); // render again\n      }\n    }));\n  }\n\n  get widget() {\n    return this._widget;\n  }\n  /**\n   * Returns true if the hover shows now or will show.\n   */\n  maybeShowAt(mouseEvent) {\n    if (this._widget.isResizing) {\n      return true;\n    }\n    const anchorCandidates = [];\n    for (const participant of this._participants) {\n      if (participant.suggestHoverAnchor) {\n        const anchor = participant.suggestHoverAnchor(mouseEvent);\n        if (anchor) {\n          anchorCandidates.push(anchor);\n        }\n      }\n    }\n    const target = mouseEvent.target;\n    if (target.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n      anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n    }\n    if (target.type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n      const epsilon = this._editor.getOption(49 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth / 2;\n      if (!target.detail.isAfterLines && typeof target.detail.horizontalDistanceToText === 'number' && target.detail.horizontalDistanceToText < epsilon) {\n        // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\n        anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n      }\n    }\n    if (anchorCandidates.length === 0) {\n      return this._startShowingOrUpdateHover(null, 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n    }\n    anchorCandidates.sort((a, b) => b.priority - a.priority);\n    return this._startShowingOrUpdateHover(anchorCandidates[0], 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n  }\n  startShowingAtRange(range, mode, source, focus) {\n    this._startShowingOrUpdateHover(new HoverRangeAnchor(0, range, undefined, undefined), mode, source, focus, null);\n  }\n  /**\n   * Returns true if the hover shows now or will show.\n   */\n  _startShowingOrUpdateHover(anchor, mode, source, focus, mouseEvent) {\n    if (!this._widget.position || !this._currentResult) {\n      // The hover is not visible\n      if (anchor) {\n        this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n        return true;\n      }\n      return false;\n    }\n    // The hover is currently visible\n    const hoverIsSticky = this._editor.getOption(59 /* EditorOption.hover */).sticky;\n    const isGettingCloser = hoverIsSticky && mouseEvent && this._widget.isMouseGettingCloser(mouseEvent.event.posx, mouseEvent.event.posy);\n    if (isGettingCloser) {\n      // The mouse is getting closer to the hover, so we will keep the hover untouched\n      // But we will kick off a hover update at the new anchor, insisting on keeping the hover visible.\n      if (anchor) {\n        this._startHoverOperationIfNecessary(anchor, mode, source, focus, true);\n      }\n      return true;\n    }\n    if (!anchor) {\n      this._setCurrentResult(null);\n      return false;\n    }\n    if (anchor && this._currentResult.anchor.equals(anchor)) {\n      // The widget is currently showing results for the exact same anchor, so no update is needed\n      return true;\n    }\n    if (!anchor.canAdoptVisibleHover(this._currentResult.anchor, this._widget.position)) {\n      // The new anchor is not compatible with the previous anchor\n      this._setCurrentResult(null);\n      this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n      return true;\n    }\n    // We aren't getting any closer to the hover, so we will filter existing results\n    // and keep those which also apply to the new anchor.\n    this._setCurrentResult(this._currentResult.filter(anchor));\n    this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n    return true;\n  }\n  _startHoverOperationIfNecessary(anchor, mode, source, focus, insistOnKeepingHoverVisible) {\n    if (this._computer.anchor && this._computer.anchor.equals(anchor)) {\n      // We have to start a hover operation at the exact same anchor as before, so no work is needed\n      return;\n    }\n    this._hoverOperation.cancel();\n    this._computer.anchor = anchor;\n    this._computer.shouldFocus = focus;\n    this._computer.source = source;\n    this._computer.insistOnKeepingHoverVisible = insistOnKeepingHoverVisible;\n    this._hoverOperation.start(mode);\n  }\n  _setCurrentResult(hoverResult) {\n    if (this._currentResult === hoverResult) {\n      // avoid updating the DOM to avoid resetting the user selection\n      return;\n    }\n    if (hoverResult && hoverResult.messages.length === 0) {\n      hoverResult = null;\n    }\n    this._currentResult = hoverResult;\n    if (this._currentResult) {\n      this._renderMessages(this._currentResult.anchor, this._currentResult.messages);\n    } else {\n      this._widget.hide();\n    }\n  }\n  hide() {\n    this._computer.anchor = null;\n    this._hoverOperation.cancel();\n    this._setCurrentResult(null);\n  }\n  get isColorPickerVisible() {\n    return this._widget.isColorPickerVisible;\n  }\n  get isVisibleFromKeyboard() {\n    return this._widget.isVisibleFromKeyboard;\n  }\n  get isVisible() {\n    return this._widget.isVisible;\n  }\n  get isFocused() {\n    return this._widget.isFocused;\n  }\n  get isResizing() {\n    return this._widget.isResizing;\n  }\n  containsNode(node) {\n    return node ? this._widget.getDomNode().contains(node) : false;\n  }\n  _addLoadingMessage(result) {\n    if (this._computer.anchor) {\n      for (const participant of this._participants) {\n        if (participant.createLoadingMessage) {\n          const loadingMessage = participant.createLoadingMessage(this._computer.anchor);\n          if (loadingMessage) {\n            return result.slice(0).concat([loadingMessage]);\n          }\n        }\n      }\n    }\n    return result;\n  }\n  _withResult(hoverResult) {\n    if (this._widget.position && this._currentResult && this._currentResult.isComplete) {\n      // The hover is visible with a previous complete result.\n      if (!hoverResult.isComplete) {\n        // Instead of rendering the new partial result, we wait for the result to be complete.\n        return;\n      }\n      if (this._computer.insistOnKeepingHoverVisible && hoverResult.messages.length === 0) {\n        // The hover would now hide normally, so we'll keep the previous messages\n        return;\n      }\n    }\n    this._setCurrentResult(hoverResult);\n  }\n  _renderMessages(anchor, messages) {\n    const {\n      showAtPosition,\n      showAtSecondaryPosition,\n      highlightRange\n    } = ContentHoverController.computeHoverRanges(this._editor, anchor.range, messages);\n    const disposables = new DisposableStore();\n    const statusBar = disposables.add(new EditorHoverStatusBar(this._keybindingService));\n    const fragment = document.createDocumentFragment();\n    let colorPicker = null;\n    const context = {\n      fragment,\n      statusBar,\n      setColorPicker: widget => colorPicker = widget,\n      onContentsChanged: () => this._widget.onContentsChanged(),\n      setMinimumDimensions: dimensions => this._widget.setMinimumDimensions(dimensions),\n      hide: () => this.hide()\n    };\n    for (const participant of this._participants) {\n      const hoverParts = messages.filter(msg => msg.owner === participant);\n      if (hoverParts.length > 0) {\n        disposables.add(participant.renderHoverParts(context, hoverParts));\n      }\n    }\n    const isBeforeContent = messages.some(m => m.isBeforeContent);\n    if (statusBar.hasContent) {\n      fragment.appendChild(statusBar.hoverElement);\n    }\n    if (fragment.hasChildNodes()) {\n      if (highlightRange) {\n        const highlightDecoration = this._editor.createDecorationsCollection();\n        highlightDecoration.set([{\n          range: highlightRange,\n          options: ContentHoverController._DECORATION_OPTIONS\n        }]);\n        disposables.add(toDisposable(() => {\n          highlightDecoration.clear();\n        }));\n      }\n      this._widget.showAt(fragment, new ContentHoverVisibleData(colorPicker, showAtPosition, showAtSecondaryPosition, this._editor.getOption(59 /* EditorOption.hover */).above, this._computer.shouldFocus, this._computer.source, isBeforeContent, anchor.initialMousePosX, anchor.initialMousePosY, disposables));\n    } else {\n      disposables.dispose();\n    }\n  }\n  static computeHoverRanges(editor, anchorRange, messages) {\n    let startColumnBoundary = 1;\n    if (editor.hasModel()) {\n      // Ensure the range is on the current view line\n      const viewModel = editor._getViewModel();\n      const coordinatesConverter = viewModel.coordinatesConverter;\n      const anchorViewRange = coordinatesConverter.convertModelRangeToViewRange(anchorRange);\n      const anchorViewRangeStart = new Position(anchorViewRange.startLineNumber, viewModel.getLineMinColumn(anchorViewRange.startLineNumber));\n      startColumnBoundary = coordinatesConverter.convertViewPositionToModelPosition(anchorViewRangeStart).column;\n    }\n    // The anchor range is always on a single line\n    const anchorLineNumber = anchorRange.startLineNumber;\n    let renderStartColumn = anchorRange.startColumn;\n    let highlightRange = messages[0].range;\n    let forceShowAtRange = null;\n    for (const msg of messages) {\n      highlightRange = Range.plusRange(highlightRange, msg.range);\n      if (msg.range.startLineNumber === anchorLineNumber && msg.range.endLineNumber === anchorLineNumber) {\n        // this message has a range that is completely sitting on the line of the anchor\n        renderStartColumn = Math.max(Math.min(renderStartColumn, msg.range.startColumn), startColumnBoundary);\n      }\n      if (msg.forceShowAtRange) {\n        forceShowAtRange = msg.range;\n      }\n    }\n    return {\n      showAtPosition: forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchorLineNumber, anchorRange.startColumn),\n      showAtSecondaryPosition: forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchorLineNumber, renderStartColumn),\n      highlightRange\n    };\n  }\n  focus() {\n    this._widget.focus();\n  }\n  scrollUp() {\n    this._widget.scrollUp();\n  }\n  scrollDown() {\n    this._widget.scrollDown();\n  }\n  scrollLeft() {\n    this._widget.scrollLeft();\n  }\n  scrollRight() {\n    this._widget.scrollRight();\n  }\n  pageUp() {\n    this._widget.pageUp();\n  }\n  pageDown() {\n    this._widget.pageDown();\n  }\n  goToTop() {\n    this._widget.goToTop();\n  }\n  goToBottom() {\n    this._widget.goToBottom();\n  }\n};\nContentHoverController._DECORATION_OPTIONS = ModelDecorationOptions.register({\n  description: 'content-hover-highlight',\n  className: 'hoverHighlight'\n});\nContentHoverController = __decorate([__param(1, IInstantiationService), __param(2, IKeybindingService)], ContentHoverController);\nexport { ContentHoverController };\nclass HoverResult {\n  constructor(anchor, messages, isComplete) {\n    this.anchor = anchor;\n    this.messages = messages;\n    this.isComplete = isComplete;\n  }\n  filter(anchor) {\n    const filteredMessages = this.messages.filter(m => m.isValidForHoverAnchor(anchor));\n    if (filteredMessages.length === this.messages.length) {\n      return this;\n    }\n    return new FilteredHoverResult(this, this.anchor, filteredMessages, this.isComplete);\n  }\n}\nclass FilteredHoverResult extends HoverResult {\n  constructor(original, anchor, messages, isComplete) {\n    super(anchor, messages, isComplete);\n    this.original = original;\n  }\n  filter(anchor) {\n    return this.original.filter(anchor);\n  }\n}\nclass ContentHoverVisibleData {\n  constructor(colorPicker, showAtPosition, showAtSecondaryPosition, preferAbove, stoleFocus, source, isBeforeContent, initialMousePosX, initialMousePosY, disposables) {\n    this.colorPicker = colorPicker;\n    this.showAtPosition = showAtPosition;\n    this.showAtSecondaryPosition = showAtSecondaryPosition;\n    this.preferAbove = preferAbove;\n    this.stoleFocus = stoleFocus;\n    this.source = source;\n    this.isBeforeContent = isBeforeContent;\n    this.initialMousePosX = initialMousePosX;\n    this.initialMousePosY = initialMousePosY;\n    this.disposables = disposables;\n    this.closestMouseDistance = undefined;\n  }\n}\nconst HORIZONTAL_SCROLLING_BY = 30;\nconst SCROLLBAR_WIDTH = 10;\nconst CONTAINER_HEIGHT_PADDING = 6;\nlet ContentHoverWidget = class ContentHoverWidget extends ResizableContentWidget {\n  get isColorPickerVisible() {\n    var _a;\n    return Boolean((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker);\n  }\n  get isVisibleFromKeyboard() {\n    var _a;\n    return ((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.source) === 1 /* HoverStartSource.Keyboard */;\n  }\n\n  get isVisible() {\n    var _a;\n    return (_a = this._hoverVisibleKey.get()) !== null && _a !== void 0 ? _a : false;\n  }\n  get isFocused() {\n    var _a;\n    return (_a = this._hoverFocusedKey.get()) !== null && _a !== void 0 ? _a : false;\n  }\n  constructor(editor, minimumSize, contextKeyService) {\n    super(editor, minimumSize);\n    this._hover = this._register(new HoverWidget());\n    this._hoverVisibleKey = EditorContextKeys.hoverVisible.bindTo(contextKeyService);\n    this._hoverFocusedKey = EditorContextKeys.hoverFocused.bindTo(contextKeyService);\n    dom.append(this._resizableNode.domNode, this._hover.containerDomNode);\n    this._resizableNode.domNode.style.zIndex = '50';\n    this._register(this._editor.onDidLayoutChange(() => this._layout()));\n    this._register(this._editor.onDidChangeConfiguration(e => {\n      if (e.hasChanged(49 /* EditorOption.fontInfo */)) {\n        this._updateFont();\n      }\n    }));\n    const focusTracker = this._register(dom.trackFocus(this._resizableNode.domNode));\n    this._register(focusTracker.onDidFocus(() => {\n      this._hoverFocusedKey.set(true);\n    }));\n    this._register(focusTracker.onDidBlur(() => {\n      this._hoverFocusedKey.set(false);\n    }));\n    this._setHoverData(undefined);\n    this._layout();\n    this._editor.addContentWidget(this);\n  }\n  dispose() {\n    var _a;\n    super.dispose();\n    (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.disposables.dispose();\n    this._editor.removeContentWidget(this);\n  }\n  getId() {\n    return ContentHoverWidget.ID;\n  }\n  static _applyDimensions(container, width, height) {\n    const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n    const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n    container.style.width = transformedWidth;\n    container.style.height = transformedHeight;\n  }\n  _setContentsDomNodeDimensions(width, height) {\n    const contentsDomNode = this._hover.contentsDomNode;\n    return ContentHoverWidget._applyDimensions(contentsDomNode, width, height);\n  }\n  _setContainerDomNodeDimensions(width, height) {\n    const containerDomNode = this._hover.containerDomNode;\n    return ContentHoverWidget._applyDimensions(containerDomNode, width, height);\n  }\n  _setHoverWidgetDimensions(width, height) {\n    this._setContentsDomNodeDimensions(width, height);\n    this._setContainerDomNodeDimensions(width, height);\n    this._layoutContentWidget();\n  }\n  static _applyMaxDimensions(container, width, height) {\n    const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n    const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n    container.style.maxWidth = transformedWidth;\n    container.style.maxHeight = transformedHeight;\n  }\n  _setHoverWidgetMaxDimensions(width, height) {\n    ContentHoverWidget._applyMaxDimensions(this._hover.contentsDomNode, width, height);\n    ContentHoverWidget._applyMaxDimensions(this._hover.containerDomNode, width, height);\n    this._hover.containerDomNode.style.setProperty('--hover-maxWidth', typeof width === 'number' ? `${width}px` : width);\n    this._layoutContentWidget();\n  }\n  _hasHorizontalScrollbar() {\n    const scrollDimensions = this._hover.scrollbar.getScrollDimensions();\n    const hasHorizontalScrollbar = scrollDimensions.scrollWidth > scrollDimensions.width;\n    return hasHorizontalScrollbar;\n  }\n  _adjustContentsBottomPadding() {\n    const contentsDomNode = this._hover.contentsDomNode;\n    const extraBottomPadding = `${this._hover.scrollbar.options.horizontalScrollbarSize}px`;\n    if (contentsDomNode.style.paddingBottom !== extraBottomPadding) {\n      contentsDomNode.style.paddingBottom = extraBottomPadding;\n    }\n  }\n  _setAdjustedHoverWidgetDimensions(size) {\n    this._setHoverWidgetMaxDimensions('none', 'none');\n    const width = size.width;\n    const height = size.height;\n    this._setHoverWidgetDimensions(width, height);\n    // measure if widget has horizontal scrollbar after setting the dimensions\n    if (this._hasHorizontalScrollbar()) {\n      this._adjustContentsBottomPadding();\n      this._setContentsDomNodeDimensions(width, height - SCROLLBAR_WIDTH);\n    }\n  }\n  _setResizableNodeMaxDimensions() {\n    var _a, _b;\n    const maxRenderingWidth = (_a = this._findMaximumRenderingWidth()) !== null && _a !== void 0 ? _a : Infinity;\n    const maxRenderingHeight = (_b = this._findMaximumRenderingHeight()) !== null && _b !== void 0 ? _b : Infinity;\n    this._resizableNode.maxSize = new dom.Dimension(maxRenderingWidth, maxRenderingHeight);\n    this._setHoverWidgetMaxDimensions(maxRenderingWidth, maxRenderingHeight);\n  }\n  _resize(size) {\n    var _a, _b;\n    ContentHoverWidget._lastDimensions = new dom.Dimension(size.width, size.height);\n    this._setAdjustedHoverWidgetDimensions(size);\n    this._resizableNode.layout(size.height, size.width);\n    this._setResizableNodeMaxDimensions();\n    this._hover.scrollbar.scanDomNode();\n    this._editor.layoutContentWidget(this);\n    (_b = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker) === null || _b === void 0 ? void 0 : _b.layout();\n  }\n  _findAvailableSpaceVertically() {\n    var _a;\n    const position = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition;\n    if (!position) {\n      return;\n    }\n    return this._positionPreference === 1 /* ContentWidgetPositionPreference.ABOVE */ ? this._availableVerticalSpaceAbove(position) : this._availableVerticalSpaceBelow(position);\n  }\n  _findMaximumRenderingHeight() {\n    const availableSpace = this._findAvailableSpaceVertically();\n    if (!availableSpace) {\n      return;\n    }\n    // Padding needed in order to stop the resizing down to a smaller height\n    let maximumHeight = CONTAINER_HEIGHT_PADDING;\n    Array.from(this._hover.contentsDomNode.children).forEach(hoverPart => {\n      maximumHeight += hoverPart.clientHeight;\n    });\n    if (this._hasHorizontalScrollbar()) {\n      maximumHeight += SCROLLBAR_WIDTH;\n    }\n    return Math.min(availableSpace, maximumHeight);\n  }\n  _findMaximumRenderingWidth() {\n    if (!this._editor || !this._editor.hasModel()) {\n      return;\n    }\n    const bodyBoxWidth = dom.getClientArea(document.body).width;\n    const horizontalPadding = 14;\n    return bodyBoxWidth - horizontalPadding;\n  }\n  isMouseGettingCloser(posx, posy) {\n    if (!this._visibleData) {\n      return false;\n    }\n    if (typeof this._visibleData.initialMousePosX === 'undefined' || typeof this._visibleData.initialMousePosY === 'undefined') {\n      this._visibleData.initialMousePosX = posx;\n      this._visibleData.initialMousePosY = posy;\n      return false;\n    }\n    const widgetRect = dom.getDomNodePagePosition(this.getDomNode());\n    if (typeof this._visibleData.closestMouseDistance === 'undefined') {\n      this._visibleData.closestMouseDistance = computeDistanceFromPointToRectangle(this._visibleData.initialMousePosX, this._visibleData.initialMousePosY, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n    }\n    const distance = computeDistanceFromPointToRectangle(posx, posy, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n    if (distance > this._visibleData.closestMouseDistance + 4 /* tolerance of 4 pixels */) {\n      // The mouse is getting farther away\n      return false;\n    }\n    this._visibleData.closestMouseDistance = Math.min(this._visibleData.closestMouseDistance, distance);\n    return true;\n  }\n  _setHoverData(hoverData) {\n    var _a;\n    (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.disposables.dispose();\n    this._visibleData = hoverData;\n    this._hoverVisibleKey.set(!!hoverData);\n    this._hover.containerDomNode.classList.toggle('hidden', !hoverData);\n  }\n  _layout() {\n    const {\n      fontSize,\n      lineHeight\n    } = this._editor.getOption(49 /* EditorOption.fontInfo */);\n    const contentsDomNode = this._hover.contentsDomNode;\n    contentsDomNode.style.fontSize = `${fontSize}px`;\n    contentsDomNode.style.lineHeight = `${lineHeight / fontSize}`;\n    this._updateMaxDimensions();\n  }\n  _updateFont() {\n    const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n    codeClasses.forEach(node => this._editor.applyFontInfo(node));\n  }\n  _updateContent(node) {\n    const contentsDomNode = this._hover.contentsDomNode;\n    contentsDomNode.style.paddingBottom = '';\n    contentsDomNode.textContent = '';\n    contentsDomNode.appendChild(node);\n  }\n  _layoutContentWidget() {\n    this._editor.layoutContentWidget(this);\n    this._hover.onContentsChanged();\n  }\n  _updateMaxDimensions() {\n    const height = Math.max(this._editor.getLayoutInfo().height / 4, 250, ContentHoverWidget._lastDimensions.height);\n    const width = Math.max(this._editor.getLayoutInfo().width * 0.66, 500, ContentHoverWidget._lastDimensions.width);\n    this._setHoverWidgetMaxDimensions(width, height);\n  }\n  _render(node, hoverData) {\n    this._setHoverData(hoverData);\n    this._updateFont();\n    this._updateContent(node);\n    this._updateMaxDimensions();\n    this.onContentsChanged();\n    // Simply force a synchronous render on the editor\n    // such that the widget does not really render with left = '0px'\n    this._editor.render();\n  }\n  getPosition() {\n    var _a;\n    if (!this._visibleData) {\n      return null;\n    }\n    return {\n      position: this._visibleData.showAtPosition,\n      secondaryPosition: this._visibleData.showAtSecondaryPosition,\n      positionAffinity: this._visibleData.isBeforeContent ? 3 /* PositionAffinity.LeftOfInjectedText */ : undefined,\n      preference: [(_a = this._positionPreference) !== null && _a !== void 0 ? _a : 1 /* ContentWidgetPositionPreference.ABOVE */]\n    };\n  }\n\n  showAt(node, hoverData) {\n    var _a, _b;\n    if (!this._editor || !this._editor.hasModel()) {\n      return;\n    }\n    this._render(node, hoverData);\n    const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n    const widgetPosition = hoverData.showAtPosition;\n    this._positionPreference = (_a = this._findPositionPreference(widgetHeight, widgetPosition)) !== null && _a !== void 0 ? _a : 1 /* ContentWidgetPositionPreference.ABOVE */;\n    // See https://github.com/microsoft/vscode/issues/140339\n    // TODO: Doing a second layout of the hover after force rendering the editor\n    this.onContentsChanged();\n    if (hoverData.stoleFocus) {\n      this._hover.containerDomNode.focus();\n    }\n    (_b = hoverData.colorPicker) === null || _b === void 0 ? void 0 : _b.layout();\n  }\n  hide() {\n    if (!this._visibleData) {\n      return;\n    }\n    const stoleFocus = this._visibleData.stoleFocus || this._hoverFocusedKey.get();\n    this._setHoverData(undefined);\n    this._resizableNode.maxSize = new dom.Dimension(Infinity, Infinity);\n    this._resizableNode.clearSashHoverState();\n    this._hoverFocusedKey.set(false);\n    this._editor.layoutContentWidget(this);\n    if (stoleFocus) {\n      this._editor.focus();\n    }\n  }\n  _removeConstraintsRenderNormally() {\n    // Added because otherwise the initial size of the hover content is smaller than should be\n    const layoutInfo = this._editor.getLayoutInfo();\n    this._resizableNode.layout(layoutInfo.height, layoutInfo.width);\n    this._setHoverWidgetDimensions('auto', 'auto');\n  }\n  _adjustHoverHeightForScrollbar(height) {\n    var _a;\n    const containerDomNode = this._hover.containerDomNode;\n    const contentsDomNode = this._hover.contentsDomNode;\n    const maxRenderingHeight = (_a = this._findMaximumRenderingHeight()) !== null && _a !== void 0 ? _a : Infinity;\n    this._setContainerDomNodeDimensions(dom.getTotalWidth(containerDomNode), Math.min(maxRenderingHeight, height));\n    this._setContentsDomNodeDimensions(dom.getTotalWidth(contentsDomNode), Math.min(maxRenderingHeight, height - SCROLLBAR_WIDTH));\n  }\n  setMinimumDimensions(dimensions) {\n    this._resizableNode.minSize = dimensions;\n  }\n  onContentsChanged() {\n    var _a;\n    this._removeConstraintsRenderNormally();\n    const containerDomNode = this._hover.containerDomNode;\n    let height = dom.getTotalHeight(containerDomNode);\n    let width = dom.getTotalWidth(containerDomNode);\n    this._resizableNode.layout(height, width);\n    this._setHoverWidgetDimensions(width, height);\n    height = dom.getTotalHeight(containerDomNode);\n    width = dom.getTotalWidth(containerDomNode);\n    this._resizableNode.layout(height, width);\n    if (this._hasHorizontalScrollbar()) {\n      this._adjustContentsBottomPadding();\n      this._adjustHoverHeightForScrollbar(height);\n    }\n    if ((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition) {\n      const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n      this._positionPreference = this._findPositionPreference(widgetHeight, this._visibleData.showAtPosition);\n    }\n    this._layoutContentWidget();\n  }\n  focus() {\n    this._hover.containerDomNode.focus();\n  }\n  scrollUp() {\n    const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n    const fontInfo = this._editor.getOption(49 /* EditorOption.fontInfo */);\n    this._hover.scrollbar.setScrollPosition({\n      scrollTop: scrollTop - fontInfo.lineHeight\n    });\n  }\n  scrollDown() {\n    const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n    const fontInfo = this._editor.getOption(49 /* EditorOption.fontInfo */);\n    this._hover.scrollbar.setScrollPosition({\n      scrollTop: scrollTop + fontInfo.lineHeight\n    });\n  }\n  scrollLeft() {\n    const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n    this._hover.scrollbar.setScrollPosition({\n      scrollLeft: scrollLeft - HORIZONTAL_SCROLLING_BY\n    });\n  }\n  scrollRight() {\n    const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n    this._hover.scrollbar.setScrollPosition({\n      scrollLeft: scrollLeft + HORIZONTAL_SCROLLING_BY\n    });\n  }\n  pageUp() {\n    const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n    const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n    this._hover.scrollbar.setScrollPosition({\n      scrollTop: scrollTop - scrollHeight\n    });\n  }\n  pageDown() {\n    const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n    const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n    this._hover.scrollbar.setScrollPosition({\n      scrollTop: scrollTop + scrollHeight\n    });\n  }\n  goToTop() {\n    this._hover.scrollbar.setScrollPosition({\n      scrollTop: 0\n    });\n  }\n  goToBottom() {\n    this._hover.scrollbar.setScrollPosition({\n      scrollTop: this._hover.scrollbar.getScrollDimensions().scrollHeight\n    });\n  }\n};\nContentHoverWidget.ID = 'editor.contrib.resizableContentHoverWidget';\nContentHoverWidget._lastDimensions = new dom.Dimension(0, 0);\nContentHoverWidget = __decorate([__param(2, IContextKeyService)], ContentHoverWidget);\nexport { ContentHoverWidget };\nlet EditorHoverStatusBar = class EditorHoverStatusBar extends Disposable {\n  get hasContent() {\n    return this._hasContent;\n  }\n  constructor(_keybindingService) {\n    super();\n    this._keybindingService = _keybindingService;\n    this._hasContent = false;\n    this.hoverElement = $('div.hover-row.status-bar');\n    this.actionsElement = dom.append(this.hoverElement, $('div.actions'));\n  }\n  addAction(actionOptions) {\n    const keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\n    const keybindingLabel = keybinding ? keybinding.getLabel() : null;\n    this._hasContent = true;\n    return this._register(HoverAction.render(this.actionsElement, actionOptions, keybindingLabel));\n  }\n  append(element) {\n    const result = dom.append(this.actionsElement, element);\n    this._hasContent = true;\n    return result;\n  }\n};\nEditorHoverStatusBar = __decorate([__param(0, IKeybindingService)], EditorHoverStatusBar);\nexport { EditorHoverStatusBar };\nclass ContentHoverComputer {\n  get anchor() {\n    return this._anchor;\n  }\n  set anchor(value) {\n    this._anchor = value;\n  }\n  get shouldFocus() {\n    return this._shouldFocus;\n  }\n  set shouldFocus(value) {\n    this._shouldFocus = value;\n  }\n  get source() {\n    return this._source;\n  }\n  set source(value) {\n    this._source = value;\n  }\n  get insistOnKeepingHoverVisible() {\n    return this._insistOnKeepingHoverVisible;\n  }\n  set insistOnKeepingHoverVisible(value) {\n    this._insistOnKeepingHoverVisible = value;\n  }\n  constructor(_editor, _participants) {\n    this._editor = _editor;\n    this._participants = _participants;\n    this._anchor = null;\n    this._shouldFocus = false;\n    this._source = 0 /* HoverStartSource.Mouse */;\n    this._insistOnKeepingHoverVisible = false;\n  }\n  static _getLineDecorations(editor, anchor) {\n    if (anchor.type !== 1 /* HoverAnchorType.Range */ && !anchor.supportsMarkerHover) {\n      return [];\n    }\n    const model = editor.getModel();\n    const lineNumber = anchor.range.startLineNumber;\n    if (lineNumber > model.getLineCount()) {\n      // invalid line\n      return [];\n    }\n    const maxColumn = model.getLineMaxColumn(lineNumber);\n    return editor.getLineDecorations(lineNumber).filter(d => {\n      if (d.options.isWholeLine) {\n        return true;\n      }\n      const startColumn = d.range.startLineNumber === lineNumber ? d.range.startColumn : 1;\n      const endColumn = d.range.endLineNumber === lineNumber ? d.range.endColumn : maxColumn;\n      if (d.options.showIfCollapsed) {\n        // Relax check around `showIfCollapsed` decorations to also include +/- 1 character\n        if (startColumn > anchor.range.startColumn + 1 || anchor.range.endColumn - 1 > endColumn) {\n          return false;\n        }\n      } else {\n        if (startColumn > anchor.range.startColumn || anchor.range.endColumn > endColumn) {\n          return false;\n        }\n      }\n      return true;\n    });\n  }\n  computeAsync(token) {\n    const anchor = this._anchor;\n    if (!this._editor.hasModel() || !anchor) {\n      return AsyncIterableObject.EMPTY;\n    }\n    const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, anchor);\n    return AsyncIterableObject.merge(this._participants.map(participant => {\n      if (!participant.computeAsync) {\n        return AsyncIterableObject.EMPTY;\n      }\n      return participant.computeAsync(anchor, lineDecorations, token);\n    }));\n  }\n  computeSync() {\n    if (!this._editor.hasModel() || !this._anchor) {\n      return [];\n    }\n    const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, this._anchor);\n    let result = [];\n    for (const participant of this._participants) {\n      result = result.concat(participant.computeSync(this._anchor, lineDecorations));\n    }\n    return coalesce(result);\n  }\n}\nfunction computeDistanceFromPointToRectangle(pointX, pointY, left, top, width, height) {\n  const x = left + width / 2; // x center of rectangle\n  const y = top + height / 2; // y center of rectangle\n  const dx = Math.max(Math.abs(pointX - x) - width / 2, 0);\n  const dy = Math.max(Math.abs(pointY - y) - height / 2, 0);\n  return Math.sqrt(dx * dx + dy * dy);\n}","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","dom","HoverAction","HoverWidget","coalesce","Disposable","DisposableStore","toDisposable","Position","Range","ModelDecorationOptions","TokenizationRegistry","HoverOperation","HoverParticipantRegistry","HoverRangeAnchor","IInstantiationService","IKeybindingService","AsyncIterableObject","EditorContextKeys","IContextKeyService","ResizableContentWidget","$","ContentHoverController","constructor","_editor","_instantiationService","_keybindingService","_currentResult","minimumHeight","getOption","minimumWidth","minimumSize","Dimension","_widget","_register","createInstance","ContentHoverWidget","_participants","participant","getAll","push","sort","p1","p2","hoverOrdinal","_computer","ContentHoverComputer","_hoverOperation","onResult","result","anchor","messages","hasLoadingMessage","_addLoadingMessage","value","_withResult","HoverResult","isComplete","addStandardDisposableListener","getDomNode","e","equals","hide","onDidChange","position","_setCurrentResult","widget","maybeShowAt","mouseEvent","isResizing","anchorCandidates","suggestHoverAnchor","type","range","event","posx","posy","epsilon","typicalHalfwidthCharacterWidth","detail","isAfterLines","horizontalDistanceToText","_startShowingOrUpdateHover","a","b","priority","startShowingAtRange","mode","source","focus","undefined","_startHoverOperationIfNecessary","hoverIsSticky","sticky","isGettingCloser","isMouseGettingCloser","canAdoptVisibleHover","filter","insistOnKeepingHoverVisible","cancel","shouldFocus","start","hoverResult","_renderMessages","isColorPickerVisible","isVisibleFromKeyboard","isVisible","isFocused","containsNode","node","contains","createLoadingMessage","loadingMessage","slice","concat","showAtPosition","showAtSecondaryPosition","highlightRange","computeHoverRanges","disposables","statusBar","add","EditorHoverStatusBar","fragment","document","createDocumentFragment","colorPicker","context","setColorPicker","onContentsChanged","setMinimumDimensions","dimensions","hoverParts","msg","owner","renderHoverParts","isBeforeContent","some","m","hasContent","appendChild","hoverElement","hasChildNodes","highlightDecoration","createDecorationsCollection","set","options","_DECORATION_OPTIONS","clear","showAt","ContentHoverVisibleData","above","initialMousePosX","initialMousePosY","dispose","editor","anchorRange","startColumnBoundary","hasModel","viewModel","_getViewModel","coordinatesConverter","anchorViewRange","convertModelRangeToViewRange","anchorViewRangeStart","startLineNumber","getLineMinColumn","convertViewPositionToModelPosition","column","anchorLineNumber","renderStartColumn","startColumn","forceShowAtRange","plusRange","endLineNumber","Math","max","min","getStartPosition","scrollUp","scrollDown","scrollLeft","scrollRight","pageUp","pageDown","goToTop","goToBottom","register","description","className","filteredMessages","isValidForHoverAnchor","FilteredHoverResult","original","preferAbove","stoleFocus","closestMouseDistance","HORIZONTAL_SCROLLING_BY","SCROLLBAR_WIDTH","CONTAINER_HEIGHT_PADDING","_a","Boolean","_visibleData","_hoverVisibleKey","get","_hoverFocusedKey","contextKeyService","_hover","hoverVisible","bindTo","hoverFocused","append","_resizableNode","domNode","containerDomNode","style","zIndex","onDidLayoutChange","_layout","onDidChangeConfiguration","hasChanged","_updateFont","focusTracker","trackFocus","onDidFocus","onDidBlur","_setHoverData","addContentWidget","removeContentWidget","getId","ID","_applyDimensions","container","width","height","transformedWidth","transformedHeight","_setContentsDomNodeDimensions","contentsDomNode","_setContainerDomNodeDimensions","_setHoverWidgetDimensions","_layoutContentWidget","_applyMaxDimensions","maxWidth","maxHeight","_setHoverWidgetMaxDimensions","setProperty","_hasHorizontalScrollbar","scrollDimensions","scrollbar","getScrollDimensions","hasHorizontalScrollbar","scrollWidth","_adjustContentsBottomPadding","extraBottomPadding","horizontalScrollbarSize","paddingBottom","_setAdjustedHoverWidgetDimensions","size","_setResizableNodeMaxDimensions","_b","maxRenderingWidth","_findMaximumRenderingWidth","Infinity","maxRenderingHeight","_findMaximumRenderingHeight","maxSize","_resize","_lastDimensions","layout","scanDomNode","layoutContentWidget","_findAvailableSpaceVertically","_positionPreference","_availableVerticalSpaceAbove","_availableVerticalSpaceBelow","availableSpace","maximumHeight","Array","from","children","forEach","hoverPart","clientHeight","bodyBoxWidth","getClientArea","body","horizontalPadding","widgetRect","getDomNodePagePosition","computeDistanceFromPointToRectangle","left","top","distance","hoverData","classList","toggle","fontSize","lineHeight","_updateMaxDimensions","codeClasses","prototype","call","getElementsByClassName","applyFontInfo","_updateContent","textContent","getLayoutInfo","_render","render","getPosition","secondaryPosition","positionAffinity","preference","widgetHeight","getTotalHeight","widgetPosition","_findPositionPreference","clearSashHoverState","_removeConstraintsRenderNormally","layoutInfo","_adjustHoverHeightForScrollbar","getTotalWidth","minSize","scrollTop","getScrollPosition","fontInfo","setScrollPosition","scrollHeight","_hasContent","actionsElement","addAction","actionOptions","keybinding","lookupKeybinding","commandId","keybindingLabel","getLabel","element","_anchor","_shouldFocus","_source","_insistOnKeepingHoverVisible","_getLineDecorations","supportsMarkerHover","model","getModel","lineNumber","getLineCount","maxColumn","getLineMaxColumn","getLineDecorations","isWholeLine","endColumn","showIfCollapsed","computeAsync","token","EMPTY","lineDecorations","merge","map","computeSync","pointX","pointY","x","y","dx","abs","dy","sqrt"],"sources":["D:/code/java/program/oj/code/yuoj-frontend-master/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHover.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { HoverAction, HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { HoverParticipantRegistry, HoverRangeAnchor } from './hoverTypes.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ResizableContentWidget } from './resizableContentWidget.js';\nconst $ = dom.$;\nlet ContentHoverController = class ContentHoverController extends Disposable {\n    constructor(_editor, _instantiationService, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._currentResult = null;\n        const minimumHeight = this._editor.getOption(65 /* EditorOption.lineHeight */) + 8;\n        const minimumWidth = 4 / 3 * minimumHeight;\n        const minimumSize = new dom.Dimension(minimumWidth, minimumHeight);\n        this._widget = this._register(this._instantiationService.createInstance(ContentHoverWidget, this._editor, minimumSize));\n        // Instantiate participants and sort them by `hoverOrdinal` which is relevant for rendering order.\n        this._participants = [];\n        for (const participant of HoverParticipantRegistry.getAll()) {\n            this._participants.push(this._instantiationService.createInstance(participant, this._editor));\n        }\n        this._participants.sort((p1, p2) => p1.hoverOrdinal - p2.hoverOrdinal);\n        this._computer = new ContentHoverComputer(this._editor, this._participants);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._register(this._hoverOperation.onResult((result) => {\n            if (!this._computer.anchor) {\n                // invalid state, ignore result\n                return;\n            }\n            const messages = (result.hasLoadingMessage ? this._addLoadingMessage(result.value) : result.value);\n            this._withResult(new HoverResult(this._computer.anchor, messages, result.isComplete));\n        }));\n        this._register(dom.addStandardDisposableListener(this._widget.getDomNode(), 'keydown', (e) => {\n            if (e.equals(9 /* KeyCode.Escape */)) {\n                this.hide();\n            }\n        }));\n        this._register(TokenizationRegistry.onDidChange(() => {\n            if (this._widget.position && this._currentResult) {\n                this._setCurrentResult(this._currentResult); // render again\n            }\n        }));\n    }\n    get widget() {\n        return this._widget;\n    }\n    /**\n     * Returns true if the hover shows now or will show.\n     */\n    maybeShowAt(mouseEvent) {\n        if (this._widget.isResizing) {\n            return true;\n        }\n        const anchorCandidates = [];\n        for (const participant of this._participants) {\n            if (participant.suggestHoverAnchor) {\n                const anchor = participant.suggestHoverAnchor(mouseEvent);\n                if (anchor) {\n                    anchorCandidates.push(anchor);\n                }\n            }\n        }\n        const target = mouseEvent.target;\n        if (target.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n            anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n        }\n        if (target.type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n            const epsilon = this._editor.getOption(49 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth / 2;\n            if (!target.detail.isAfterLines && typeof target.detail.horizontalDistanceToText === 'number' && target.detail.horizontalDistanceToText < epsilon) {\n                // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\n                anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n            }\n        }\n        if (anchorCandidates.length === 0) {\n            return this._startShowingOrUpdateHover(null, 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n        }\n        anchorCandidates.sort((a, b) => b.priority - a.priority);\n        return this._startShowingOrUpdateHover(anchorCandidates[0], 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n    }\n    startShowingAtRange(range, mode, source, focus) {\n        this._startShowingOrUpdateHover(new HoverRangeAnchor(0, range, undefined, undefined), mode, source, focus, null);\n    }\n    /**\n     * Returns true if the hover shows now or will show.\n     */\n    _startShowingOrUpdateHover(anchor, mode, source, focus, mouseEvent) {\n        if (!this._widget.position || !this._currentResult) {\n            // The hover is not visible\n            if (anchor) {\n                this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n                return true;\n            }\n            return false;\n        }\n        // The hover is currently visible\n        const hoverIsSticky = this._editor.getOption(59 /* EditorOption.hover */).sticky;\n        const isGettingCloser = (hoverIsSticky && mouseEvent && this._widget.isMouseGettingCloser(mouseEvent.event.posx, mouseEvent.event.posy));\n        if (isGettingCloser) {\n            // The mouse is getting closer to the hover, so we will keep the hover untouched\n            // But we will kick off a hover update at the new anchor, insisting on keeping the hover visible.\n            if (anchor) {\n                this._startHoverOperationIfNecessary(anchor, mode, source, focus, true);\n            }\n            return true;\n        }\n        if (!anchor) {\n            this._setCurrentResult(null);\n            return false;\n        }\n        if (anchor && this._currentResult.anchor.equals(anchor)) {\n            // The widget is currently showing results for the exact same anchor, so no update is needed\n            return true;\n        }\n        if (!anchor.canAdoptVisibleHover(this._currentResult.anchor, this._widget.position)) {\n            // The new anchor is not compatible with the previous anchor\n            this._setCurrentResult(null);\n            this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n            return true;\n        }\n        // We aren't getting any closer to the hover, so we will filter existing results\n        // and keep those which also apply to the new anchor.\n        this._setCurrentResult(this._currentResult.filter(anchor));\n        this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n        return true;\n    }\n    _startHoverOperationIfNecessary(anchor, mode, source, focus, insistOnKeepingHoverVisible) {\n        if (this._computer.anchor && this._computer.anchor.equals(anchor)) {\n            // We have to start a hover operation at the exact same anchor as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        this._computer.anchor = anchor;\n        this._computer.shouldFocus = focus;\n        this._computer.source = source;\n        this._computer.insistOnKeepingHoverVisible = insistOnKeepingHoverVisible;\n        this._hoverOperation.start(mode);\n    }\n    _setCurrentResult(hoverResult) {\n        if (this._currentResult === hoverResult) {\n            // avoid updating the DOM to avoid resetting the user selection\n            return;\n        }\n        if (hoverResult && hoverResult.messages.length === 0) {\n            hoverResult = null;\n        }\n        this._currentResult = hoverResult;\n        if (this._currentResult) {\n            this._renderMessages(this._currentResult.anchor, this._currentResult.messages);\n        }\n        else {\n            this._widget.hide();\n        }\n    }\n    hide() {\n        this._computer.anchor = null;\n        this._hoverOperation.cancel();\n        this._setCurrentResult(null);\n    }\n    get isColorPickerVisible() {\n        return this._widget.isColorPickerVisible;\n    }\n    get isVisibleFromKeyboard() {\n        return this._widget.isVisibleFromKeyboard;\n    }\n    get isVisible() {\n        return this._widget.isVisible;\n    }\n    get isFocused() {\n        return this._widget.isFocused;\n    }\n    get isResizing() {\n        return this._widget.isResizing;\n    }\n    containsNode(node) {\n        return (node ? this._widget.getDomNode().contains(node) : false);\n    }\n    _addLoadingMessage(result) {\n        if (this._computer.anchor) {\n            for (const participant of this._participants) {\n                if (participant.createLoadingMessage) {\n                    const loadingMessage = participant.createLoadingMessage(this._computer.anchor);\n                    if (loadingMessage) {\n                        return result.slice(0).concat([loadingMessage]);\n                    }\n                }\n            }\n        }\n        return result;\n    }\n    _withResult(hoverResult) {\n        if (this._widget.position && this._currentResult && this._currentResult.isComplete) {\n            // The hover is visible with a previous complete result.\n            if (!hoverResult.isComplete) {\n                // Instead of rendering the new partial result, we wait for the result to be complete.\n                return;\n            }\n            if (this._computer.insistOnKeepingHoverVisible && hoverResult.messages.length === 0) {\n                // The hover would now hide normally, so we'll keep the previous messages\n                return;\n            }\n        }\n        this._setCurrentResult(hoverResult);\n    }\n    _renderMessages(anchor, messages) {\n        const { showAtPosition, showAtSecondaryPosition, highlightRange } = ContentHoverController.computeHoverRanges(this._editor, anchor.range, messages);\n        const disposables = new DisposableStore();\n        const statusBar = disposables.add(new EditorHoverStatusBar(this._keybindingService));\n        const fragment = document.createDocumentFragment();\n        let colorPicker = null;\n        const context = {\n            fragment,\n            statusBar,\n            setColorPicker: (widget) => colorPicker = widget,\n            onContentsChanged: () => this._widget.onContentsChanged(),\n            setMinimumDimensions: (dimensions) => this._widget.setMinimumDimensions(dimensions),\n            hide: () => this.hide()\n        };\n        for (const participant of this._participants) {\n            const hoverParts = messages.filter(msg => msg.owner === participant);\n            if (hoverParts.length > 0) {\n                disposables.add(participant.renderHoverParts(context, hoverParts));\n            }\n        }\n        const isBeforeContent = messages.some(m => m.isBeforeContent);\n        if (statusBar.hasContent) {\n            fragment.appendChild(statusBar.hoverElement);\n        }\n        if (fragment.hasChildNodes()) {\n            if (highlightRange) {\n                const highlightDecoration = this._editor.createDecorationsCollection();\n                highlightDecoration.set([{\n                        range: highlightRange,\n                        options: ContentHoverController._DECORATION_OPTIONS\n                    }]);\n                disposables.add(toDisposable(() => {\n                    highlightDecoration.clear();\n                }));\n            }\n            this._widget.showAt(fragment, new ContentHoverVisibleData(colorPicker, showAtPosition, showAtSecondaryPosition, this._editor.getOption(59 /* EditorOption.hover */).above, this._computer.shouldFocus, this._computer.source, isBeforeContent, anchor.initialMousePosX, anchor.initialMousePosY, disposables));\n        }\n        else {\n            disposables.dispose();\n        }\n    }\n    static computeHoverRanges(editor, anchorRange, messages) {\n        let startColumnBoundary = 1;\n        if (editor.hasModel()) {\n            // Ensure the range is on the current view line\n            const viewModel = editor._getViewModel();\n            const coordinatesConverter = viewModel.coordinatesConverter;\n            const anchorViewRange = coordinatesConverter.convertModelRangeToViewRange(anchorRange);\n            const anchorViewRangeStart = new Position(anchorViewRange.startLineNumber, viewModel.getLineMinColumn(anchorViewRange.startLineNumber));\n            startColumnBoundary = coordinatesConverter.convertViewPositionToModelPosition(anchorViewRangeStart).column;\n        }\n        // The anchor range is always on a single line\n        const anchorLineNumber = anchorRange.startLineNumber;\n        let renderStartColumn = anchorRange.startColumn;\n        let highlightRange = messages[0].range;\n        let forceShowAtRange = null;\n        for (const msg of messages) {\n            highlightRange = Range.plusRange(highlightRange, msg.range);\n            if (msg.range.startLineNumber === anchorLineNumber && msg.range.endLineNumber === anchorLineNumber) {\n                // this message has a range that is completely sitting on the line of the anchor\n                renderStartColumn = Math.max(Math.min(renderStartColumn, msg.range.startColumn), startColumnBoundary);\n            }\n            if (msg.forceShowAtRange) {\n                forceShowAtRange = msg.range;\n            }\n        }\n        return {\n            showAtPosition: forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchorLineNumber, anchorRange.startColumn),\n            showAtSecondaryPosition: forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchorLineNumber, renderStartColumn),\n            highlightRange\n        };\n    }\n    focus() {\n        this._widget.focus();\n    }\n    scrollUp() {\n        this._widget.scrollUp();\n    }\n    scrollDown() {\n        this._widget.scrollDown();\n    }\n    scrollLeft() {\n        this._widget.scrollLeft();\n    }\n    scrollRight() {\n        this._widget.scrollRight();\n    }\n    pageUp() {\n        this._widget.pageUp();\n    }\n    pageDown() {\n        this._widget.pageDown();\n    }\n    goToTop() {\n        this._widget.goToTop();\n    }\n    goToBottom() {\n        this._widget.goToBottom();\n    }\n};\nContentHoverController._DECORATION_OPTIONS = ModelDecorationOptions.register({\n    description: 'content-hover-highlight',\n    className: 'hoverHighlight'\n});\nContentHoverController = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IKeybindingService)\n], ContentHoverController);\nexport { ContentHoverController };\nclass HoverResult {\n    constructor(anchor, messages, isComplete) {\n        this.anchor = anchor;\n        this.messages = messages;\n        this.isComplete = isComplete;\n    }\n    filter(anchor) {\n        const filteredMessages = this.messages.filter((m) => m.isValidForHoverAnchor(anchor));\n        if (filteredMessages.length === this.messages.length) {\n            return this;\n        }\n        return new FilteredHoverResult(this, this.anchor, filteredMessages, this.isComplete);\n    }\n}\nclass FilteredHoverResult extends HoverResult {\n    constructor(original, anchor, messages, isComplete) {\n        super(anchor, messages, isComplete);\n        this.original = original;\n    }\n    filter(anchor) {\n        return this.original.filter(anchor);\n    }\n}\nclass ContentHoverVisibleData {\n    constructor(colorPicker, showAtPosition, showAtSecondaryPosition, preferAbove, stoleFocus, source, isBeforeContent, initialMousePosX, initialMousePosY, disposables) {\n        this.colorPicker = colorPicker;\n        this.showAtPosition = showAtPosition;\n        this.showAtSecondaryPosition = showAtSecondaryPosition;\n        this.preferAbove = preferAbove;\n        this.stoleFocus = stoleFocus;\n        this.source = source;\n        this.isBeforeContent = isBeforeContent;\n        this.initialMousePosX = initialMousePosX;\n        this.initialMousePosY = initialMousePosY;\n        this.disposables = disposables;\n        this.closestMouseDistance = undefined;\n    }\n}\nconst HORIZONTAL_SCROLLING_BY = 30;\nconst SCROLLBAR_WIDTH = 10;\nconst CONTAINER_HEIGHT_PADDING = 6;\nlet ContentHoverWidget = class ContentHoverWidget extends ResizableContentWidget {\n    get isColorPickerVisible() {\n        var _a;\n        return Boolean((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker);\n    }\n    get isVisibleFromKeyboard() {\n        var _a;\n        return (((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.source) === 1 /* HoverStartSource.Keyboard */);\n    }\n    get isVisible() {\n        var _a;\n        return (_a = this._hoverVisibleKey.get()) !== null && _a !== void 0 ? _a : false;\n    }\n    get isFocused() {\n        var _a;\n        return (_a = this._hoverFocusedKey.get()) !== null && _a !== void 0 ? _a : false;\n    }\n    constructor(editor, minimumSize, contextKeyService) {\n        super(editor, minimumSize);\n        this._hover = this._register(new HoverWidget());\n        this._hoverVisibleKey = EditorContextKeys.hoverVisible.bindTo(contextKeyService);\n        this._hoverFocusedKey = EditorContextKeys.hoverFocused.bindTo(contextKeyService);\n        dom.append(this._resizableNode.domNode, this._hover.containerDomNode);\n        this._resizableNode.domNode.style.zIndex = '50';\n        this._register(this._editor.onDidLayoutChange(() => this._layout()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(49 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        const focusTracker = this._register(dom.trackFocus(this._resizableNode.domNode));\n        this._register(focusTracker.onDidFocus(() => {\n            this._hoverFocusedKey.set(true);\n        }));\n        this._register(focusTracker.onDidBlur(() => {\n            this._hoverFocusedKey.set(false);\n        }));\n        this._setHoverData(undefined);\n        this._layout();\n        this._editor.addContentWidget(this);\n    }\n    dispose() {\n        var _a;\n        super.dispose();\n        (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return ContentHoverWidget.ID;\n    }\n    static _applyDimensions(container, width, height) {\n        const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n        const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n        container.style.width = transformedWidth;\n        container.style.height = transformedHeight;\n    }\n    _setContentsDomNodeDimensions(width, height) {\n        const contentsDomNode = this._hover.contentsDomNode;\n        return ContentHoverWidget._applyDimensions(contentsDomNode, width, height);\n    }\n    _setContainerDomNodeDimensions(width, height) {\n        const containerDomNode = this._hover.containerDomNode;\n        return ContentHoverWidget._applyDimensions(containerDomNode, width, height);\n    }\n    _setHoverWidgetDimensions(width, height) {\n        this._setContentsDomNodeDimensions(width, height);\n        this._setContainerDomNodeDimensions(width, height);\n        this._layoutContentWidget();\n    }\n    static _applyMaxDimensions(container, width, height) {\n        const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n        const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n        container.style.maxWidth = transformedWidth;\n        container.style.maxHeight = transformedHeight;\n    }\n    _setHoverWidgetMaxDimensions(width, height) {\n        ContentHoverWidget._applyMaxDimensions(this._hover.contentsDomNode, width, height);\n        ContentHoverWidget._applyMaxDimensions(this._hover.containerDomNode, width, height);\n        this._hover.containerDomNode.style.setProperty('--hover-maxWidth', typeof width === 'number' ? `${width}px` : width);\n        this._layoutContentWidget();\n    }\n    _hasHorizontalScrollbar() {\n        const scrollDimensions = this._hover.scrollbar.getScrollDimensions();\n        const hasHorizontalScrollbar = scrollDimensions.scrollWidth > scrollDimensions.width;\n        return hasHorizontalScrollbar;\n    }\n    _adjustContentsBottomPadding() {\n        const contentsDomNode = this._hover.contentsDomNode;\n        const extraBottomPadding = `${this._hover.scrollbar.options.horizontalScrollbarSize}px`;\n        if (contentsDomNode.style.paddingBottom !== extraBottomPadding) {\n            contentsDomNode.style.paddingBottom = extraBottomPadding;\n        }\n    }\n    _setAdjustedHoverWidgetDimensions(size) {\n        this._setHoverWidgetMaxDimensions('none', 'none');\n        const width = size.width;\n        const height = size.height;\n        this._setHoverWidgetDimensions(width, height);\n        // measure if widget has horizontal scrollbar after setting the dimensions\n        if (this._hasHorizontalScrollbar()) {\n            this._adjustContentsBottomPadding();\n            this._setContentsDomNodeDimensions(width, height - SCROLLBAR_WIDTH);\n        }\n    }\n    _setResizableNodeMaxDimensions() {\n        var _a, _b;\n        const maxRenderingWidth = (_a = this._findMaximumRenderingWidth()) !== null && _a !== void 0 ? _a : Infinity;\n        const maxRenderingHeight = (_b = this._findMaximumRenderingHeight()) !== null && _b !== void 0 ? _b : Infinity;\n        this._resizableNode.maxSize = new dom.Dimension(maxRenderingWidth, maxRenderingHeight);\n        this._setHoverWidgetMaxDimensions(maxRenderingWidth, maxRenderingHeight);\n    }\n    _resize(size) {\n        var _a, _b;\n        ContentHoverWidget._lastDimensions = new dom.Dimension(size.width, size.height);\n        this._setAdjustedHoverWidgetDimensions(size);\n        this._resizableNode.layout(size.height, size.width);\n        this._setResizableNodeMaxDimensions();\n        this._hover.scrollbar.scanDomNode();\n        this._editor.layoutContentWidget(this);\n        (_b = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker) === null || _b === void 0 ? void 0 : _b.layout();\n    }\n    _findAvailableSpaceVertically() {\n        var _a;\n        const position = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition;\n        if (!position) {\n            return;\n        }\n        return this._positionPreference === 1 /* ContentWidgetPositionPreference.ABOVE */ ? this._availableVerticalSpaceAbove(position) : this._availableVerticalSpaceBelow(position);\n    }\n    _findMaximumRenderingHeight() {\n        const availableSpace = this._findAvailableSpaceVertically();\n        if (!availableSpace) {\n            return;\n        }\n        // Padding needed in order to stop the resizing down to a smaller height\n        let maximumHeight = CONTAINER_HEIGHT_PADDING;\n        Array.from(this._hover.contentsDomNode.children).forEach((hoverPart) => {\n            maximumHeight += hoverPart.clientHeight;\n        });\n        if (this._hasHorizontalScrollbar()) {\n            maximumHeight += SCROLLBAR_WIDTH;\n        }\n        return Math.min(availableSpace, maximumHeight);\n    }\n    _findMaximumRenderingWidth() {\n        if (!this._editor || !this._editor.hasModel()) {\n            return;\n        }\n        const bodyBoxWidth = dom.getClientArea(document.body).width;\n        const horizontalPadding = 14;\n        return bodyBoxWidth - horizontalPadding;\n    }\n    isMouseGettingCloser(posx, posy) {\n        if (!this._visibleData) {\n            return false;\n        }\n        if (typeof this._visibleData.initialMousePosX === 'undefined' || typeof this._visibleData.initialMousePosY === 'undefined') {\n            this._visibleData.initialMousePosX = posx;\n            this._visibleData.initialMousePosY = posy;\n            return false;\n        }\n        const widgetRect = dom.getDomNodePagePosition(this.getDomNode());\n        if (typeof this._visibleData.closestMouseDistance === 'undefined') {\n            this._visibleData.closestMouseDistance = computeDistanceFromPointToRectangle(this._visibleData.initialMousePosX, this._visibleData.initialMousePosY, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n        }\n        const distance = computeDistanceFromPointToRectangle(posx, posy, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n        if (distance > this._visibleData.closestMouseDistance + 4 /* tolerance of 4 pixels */) {\n            // The mouse is getting farther away\n            return false;\n        }\n        this._visibleData.closestMouseDistance = Math.min(this._visibleData.closestMouseDistance, distance);\n        return true;\n    }\n    _setHoverData(hoverData) {\n        var _a;\n        (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.disposables.dispose();\n        this._visibleData = hoverData;\n        this._hoverVisibleKey.set(!!hoverData);\n        this._hover.containerDomNode.classList.toggle('hidden', !hoverData);\n    }\n    _layout() {\n        const { fontSize, lineHeight } = this._editor.getOption(49 /* EditorOption.fontInfo */);\n        const contentsDomNode = this._hover.contentsDomNode;\n        contentsDomNode.style.fontSize = `${fontSize}px`;\n        contentsDomNode.style.lineHeight = `${lineHeight / fontSize}`;\n        this._updateMaxDimensions();\n    }\n    _updateFont() {\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    _updateContent(node) {\n        const contentsDomNode = this._hover.contentsDomNode;\n        contentsDomNode.style.paddingBottom = '';\n        contentsDomNode.textContent = '';\n        contentsDomNode.appendChild(node);\n    }\n    _layoutContentWidget() {\n        this._editor.layoutContentWidget(this);\n        this._hover.onContentsChanged();\n    }\n    _updateMaxDimensions() {\n        const height = Math.max(this._editor.getLayoutInfo().height / 4, 250, ContentHoverWidget._lastDimensions.height);\n        const width = Math.max(this._editor.getLayoutInfo().width * 0.66, 500, ContentHoverWidget._lastDimensions.width);\n        this._setHoverWidgetMaxDimensions(width, height);\n    }\n    _render(node, hoverData) {\n        this._setHoverData(hoverData);\n        this._updateFont();\n        this._updateContent(node);\n        this._updateMaxDimensions();\n        this.onContentsChanged();\n        // Simply force a synchronous render on the editor\n        // such that the widget does not really render with left = '0px'\n        this._editor.render();\n    }\n    getPosition() {\n        var _a;\n        if (!this._visibleData) {\n            return null;\n        }\n        return {\n            position: this._visibleData.showAtPosition,\n            secondaryPosition: this._visibleData.showAtSecondaryPosition,\n            positionAffinity: this._visibleData.isBeforeContent ? 3 /* PositionAffinity.LeftOfInjectedText */ : undefined,\n            preference: [(_a = this._positionPreference) !== null && _a !== void 0 ? _a : 1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    showAt(node, hoverData) {\n        var _a, _b;\n        if (!this._editor || !this._editor.hasModel()) {\n            return;\n        }\n        this._render(node, hoverData);\n        const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n        const widgetPosition = hoverData.showAtPosition;\n        this._positionPreference = (_a = this._findPositionPreference(widgetHeight, widgetPosition)) !== null && _a !== void 0 ? _a : 1 /* ContentWidgetPositionPreference.ABOVE */;\n        // See https://github.com/microsoft/vscode/issues/140339\n        // TODO: Doing a second layout of the hover after force rendering the editor\n        this.onContentsChanged();\n        if (hoverData.stoleFocus) {\n            this._hover.containerDomNode.focus();\n        }\n        (_b = hoverData.colorPicker) === null || _b === void 0 ? void 0 : _b.layout();\n    }\n    hide() {\n        if (!this._visibleData) {\n            return;\n        }\n        const stoleFocus = this._visibleData.stoleFocus || this._hoverFocusedKey.get();\n        this._setHoverData(undefined);\n        this._resizableNode.maxSize = new dom.Dimension(Infinity, Infinity);\n        this._resizableNode.clearSashHoverState();\n        this._hoverFocusedKey.set(false);\n        this._editor.layoutContentWidget(this);\n        if (stoleFocus) {\n            this._editor.focus();\n        }\n    }\n    _removeConstraintsRenderNormally() {\n        // Added because otherwise the initial size of the hover content is smaller than should be\n        const layoutInfo = this._editor.getLayoutInfo();\n        this._resizableNode.layout(layoutInfo.height, layoutInfo.width);\n        this._setHoverWidgetDimensions('auto', 'auto');\n    }\n    _adjustHoverHeightForScrollbar(height) {\n        var _a;\n        const containerDomNode = this._hover.containerDomNode;\n        const contentsDomNode = this._hover.contentsDomNode;\n        const maxRenderingHeight = (_a = this._findMaximumRenderingHeight()) !== null && _a !== void 0 ? _a : Infinity;\n        this._setContainerDomNodeDimensions(dom.getTotalWidth(containerDomNode), Math.min(maxRenderingHeight, height));\n        this._setContentsDomNodeDimensions(dom.getTotalWidth(contentsDomNode), Math.min(maxRenderingHeight, height - SCROLLBAR_WIDTH));\n    }\n    setMinimumDimensions(dimensions) {\n        this._resizableNode.minSize = dimensions;\n    }\n    onContentsChanged() {\n        var _a;\n        this._removeConstraintsRenderNormally();\n        const containerDomNode = this._hover.containerDomNode;\n        let height = dom.getTotalHeight(containerDomNode);\n        let width = dom.getTotalWidth(containerDomNode);\n        this._resizableNode.layout(height, width);\n        this._setHoverWidgetDimensions(width, height);\n        height = dom.getTotalHeight(containerDomNode);\n        width = dom.getTotalWidth(containerDomNode);\n        this._resizableNode.layout(height, width);\n        if (this._hasHorizontalScrollbar()) {\n            this._adjustContentsBottomPadding();\n            this._adjustHoverHeightForScrollbar(height);\n        }\n        if ((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition) {\n            const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n            this._positionPreference = this._findPositionPreference(widgetHeight, this._visibleData.showAtPosition);\n        }\n        this._layoutContentWidget();\n    }\n    focus() {\n        this._hover.containerDomNode.focus();\n    }\n    scrollUp() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const fontInfo = this._editor.getOption(49 /* EditorOption.fontInfo */);\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop - fontInfo.lineHeight });\n    }\n    scrollDown() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const fontInfo = this._editor.getOption(49 /* EditorOption.fontInfo */);\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop + fontInfo.lineHeight });\n    }\n    scrollLeft() {\n        const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n        this._hover.scrollbar.setScrollPosition({ scrollLeft: scrollLeft - HORIZONTAL_SCROLLING_BY });\n    }\n    scrollRight() {\n        const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n        this._hover.scrollbar.setScrollPosition({ scrollLeft: scrollLeft + HORIZONTAL_SCROLLING_BY });\n    }\n    pageUp() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop - scrollHeight });\n    }\n    pageDown() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop + scrollHeight });\n    }\n    goToTop() {\n        this._hover.scrollbar.setScrollPosition({ scrollTop: 0 });\n    }\n    goToBottom() {\n        this._hover.scrollbar.setScrollPosition({ scrollTop: this._hover.scrollbar.getScrollDimensions().scrollHeight });\n    }\n};\nContentHoverWidget.ID = 'editor.contrib.resizableContentHoverWidget';\nContentHoverWidget._lastDimensions = new dom.Dimension(0, 0);\nContentHoverWidget = __decorate([\n    __param(2, IContextKeyService)\n], ContentHoverWidget);\nexport { ContentHoverWidget };\nlet EditorHoverStatusBar = class EditorHoverStatusBar extends Disposable {\n    get hasContent() {\n        return this._hasContent;\n    }\n    constructor(_keybindingService) {\n        super();\n        this._keybindingService = _keybindingService;\n        this._hasContent = false;\n        this.hoverElement = $('div.hover-row.status-bar');\n        this.actionsElement = dom.append(this.hoverElement, $('div.actions'));\n    }\n    addAction(actionOptions) {\n        const keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\n        const keybindingLabel = keybinding ? keybinding.getLabel() : null;\n        this._hasContent = true;\n        return this._register(HoverAction.render(this.actionsElement, actionOptions, keybindingLabel));\n    }\n    append(element) {\n        const result = dom.append(this.actionsElement, element);\n        this._hasContent = true;\n        return result;\n    }\n};\nEditorHoverStatusBar = __decorate([\n    __param(0, IKeybindingService)\n], EditorHoverStatusBar);\nexport { EditorHoverStatusBar };\nclass ContentHoverComputer {\n    get anchor() { return this._anchor; }\n    set anchor(value) { this._anchor = value; }\n    get shouldFocus() { return this._shouldFocus; }\n    set shouldFocus(value) { this._shouldFocus = value; }\n    get source() { return this._source; }\n    set source(value) { this._source = value; }\n    get insistOnKeepingHoverVisible() { return this._insistOnKeepingHoverVisible; }\n    set insistOnKeepingHoverVisible(value) { this._insistOnKeepingHoverVisible = value; }\n    constructor(_editor, _participants) {\n        this._editor = _editor;\n        this._participants = _participants;\n        this._anchor = null;\n        this._shouldFocus = false;\n        this._source = 0 /* HoverStartSource.Mouse */;\n        this._insistOnKeepingHoverVisible = false;\n    }\n    static _getLineDecorations(editor, anchor) {\n        if (anchor.type !== 1 /* HoverAnchorType.Range */ && !anchor.supportsMarkerHover) {\n            return [];\n        }\n        const model = editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        if (lineNumber > model.getLineCount()) {\n            // invalid line\n            return [];\n        }\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        return editor.getLineDecorations(lineNumber).filter((d) => {\n            if (d.options.isWholeLine) {\n                return true;\n            }\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            if (d.options.showIfCollapsed) {\n                // Relax check around `showIfCollapsed` decorations to also include +/- 1 character\n                if (startColumn > anchor.range.startColumn + 1 || anchor.range.endColumn - 1 > endColumn) {\n                    return false;\n                }\n            }\n            else {\n                if (startColumn > anchor.range.startColumn || anchor.range.endColumn > endColumn) {\n                    return false;\n                }\n            }\n            return true;\n        });\n    }\n    computeAsync(token) {\n        const anchor = this._anchor;\n        if (!this._editor.hasModel() || !anchor) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, anchor);\n        return AsyncIterableObject.merge(this._participants.map((participant) => {\n            if (!participant.computeAsync) {\n                return AsyncIterableObject.EMPTY;\n            }\n            return participant.computeAsync(anchor, lineDecorations, token);\n        }));\n    }\n    computeSync() {\n        if (!this._editor.hasModel() || !this._anchor) {\n            return [];\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, this._anchor);\n        let result = [];\n        for (const participant of this._participants) {\n            result = result.concat(participant.computeSync(this._anchor, lineDecorations));\n        }\n        return coalesce(result);\n    }\n}\nfunction computeDistanceFromPointToRectangle(pointX, pointY, left, top, width, height) {\n    const x = (left + width / 2); // x center of rectangle\n    const y = (top + height / 2); // y center of rectangle\n    const dx = Math.max(Math.abs(pointX - x) - width / 2, 0);\n    const dy = Math.max(Math.abs(pointY - y) - height / 2, 0);\n    return Math.sqrt(dx * dx + dy * dy);\n}\n"],"mappings":";AAAA;AACA;AACA;AACA;AACA,IAAIA,UAAU,GAAI,IAAI,IAAI,IAAI,CAACA,UAAU,IAAK,UAAUC,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,EAAE;EACnF,IAAIC,CAAC,GAAGC,SAAS,CAACC,MAAM;IAAEC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGH,MAAM,GAAGE,IAAI,KAAK,IAAI,GAAGA,IAAI,GAAGK,MAAM,CAACC,wBAAwB,CAACR,MAAM,EAAEC,GAAG,CAAC,GAAGC,IAAI;IAAEO,CAAC;EAC5H,IAAI,OAAOC,OAAO,KAAK,QAAQ,IAAI,OAAOA,OAAO,CAACC,QAAQ,KAAK,UAAU,EAAEL,CAAC,GAAGI,OAAO,CAACC,QAAQ,CAACZ,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,CAAC,CAAC,KAC1H,KAAK,IAAIU,CAAC,GAAGb,UAAU,CAACM,MAAM,GAAG,CAAC,EAAEO,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE,IAAIH,CAAC,GAAGV,UAAU,CAACa,CAAC,CAAC,EAAEN,CAAC,GAAG,CAACH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACH,CAAC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACT,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,GAAGG,CAAC,CAACT,MAAM,EAAEC,GAAG,CAAC,KAAKK,CAAC;EACjJ,OAAOH,CAAC,GAAG,CAAC,IAAIG,CAAC,IAAIC,MAAM,CAACM,cAAc,CAACb,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,EAAEA,CAAC;AACjE,CAAC;AACD,IAAIQ,OAAO,GAAI,IAAI,IAAI,IAAI,CAACA,OAAO,IAAK,UAAUC,UAAU,EAAEC,SAAS,EAAE;EACrE,OAAO,UAAUhB,MAAM,EAAEC,GAAG,EAAE;IAAEe,SAAS,CAAChB,MAAM,EAAEC,GAAG,EAAEc,UAAU,CAAC;EAAE,CAAC;AACzE,CAAC;AACD,OAAO,KAAKE,GAAG,MAAM,iCAAiC;AACtD,SAASC,WAAW,EAAEC,WAAW,QAAQ,kDAAkD;AAC3F,SAASC,QAAQ,QAAQ,mCAAmC;AAC5D,SAASC,UAAU,EAAEC,eAAe,EAAEC,YAAY,QAAQ,sCAAsC;AAChG,SAASC,QAAQ,QAAQ,kCAAkC;AAC3D,SAASC,KAAK,QAAQ,+BAA+B;AACrD,SAASC,sBAAsB,QAAQ,oCAAoC;AAC3E,SAASC,oBAAoB,QAAQ,8BAA8B;AACnE,SAASC,cAAc,QAAQ,qBAAqB;AACpD,SAASC,wBAAwB,EAAEC,gBAAgB,QAAQ,iBAAiB;AAC5E,SAASC,qBAAqB,QAAQ,4DAA4D;AAClG,SAASC,kBAAkB,QAAQ,sDAAsD;AACzF,SAASC,mBAAmB,QAAQ,kCAAkC;AACtE,SAASC,iBAAiB,QAAQ,sCAAsC;AACxE,SAASC,kBAAkB,QAAQ,sDAAsD;AACzF,SAASC,sBAAsB,QAAQ,6BAA6B;AACpE,MAAMC,CAAC,GAAGpB,GAAG,CAACoB,CAAC;AACf,IAAIC,sBAAsB,GAAG,MAAMA,sBAAsB,SAASjB,UAAU,CAAC;EACzEkB,WAAWA,CAACC,OAAO,EAAEC,qBAAqB,EAAEC,kBAAkB,EAAE;IAC5D,KAAK,CAAC,CAAC;IACP,IAAI,CAACF,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACC,qBAAqB,GAAGA,qBAAqB;IAClD,IAAI,CAACC,kBAAkB,GAAGA,kBAAkB;IAC5C,IAAI,CAACC,cAAc,GAAG,IAAI;IAC1B,MAAMC,aAAa,GAAG,IAAI,CAACJ,OAAO,CAACK,SAAS,CAAC,EAAE,CAAC,6BAA6B,CAAC,GAAG,CAAC;IAClF,MAAMC,YAAY,GAAG,CAAC,GAAG,CAAC,GAAGF,aAAa;IAC1C,MAAMG,WAAW,GAAG,IAAI9B,GAAG,CAAC+B,SAAS,CAACF,YAAY,EAAEF,aAAa,CAAC;IAClE,IAAI,CAACK,OAAO,GAAG,IAAI,CAACC,SAAS,CAAC,IAAI,CAACT,qBAAqB,CAACU,cAAc,CAACC,kBAAkB,EAAE,IAAI,CAACZ,OAAO,EAAEO,WAAW,CAAC,CAAC;IACvH;IACA,IAAI,CAACM,aAAa,GAAG,EAAE;IACvB,KAAK,MAAMC,WAAW,IAAIzB,wBAAwB,CAAC0B,MAAM,CAAC,CAAC,EAAE;MACzD,IAAI,CAACF,aAAa,CAACG,IAAI,CAAC,IAAI,CAACf,qBAAqB,CAACU,cAAc,CAACG,WAAW,EAAE,IAAI,CAACd,OAAO,CAAC,CAAC;IACjG;IACA,IAAI,CAACa,aAAa,CAACI,IAAI,CAAC,CAACC,EAAE,EAAEC,EAAE,KAAKD,EAAE,CAACE,YAAY,GAAGD,EAAE,CAACC,YAAY,CAAC;IACtE,IAAI,CAACC,SAAS,GAAG,IAAIC,oBAAoB,CAAC,IAAI,CAACtB,OAAO,EAAE,IAAI,CAACa,aAAa,CAAC;IAC3E,IAAI,CAACU,eAAe,GAAG,IAAI,CAACb,SAAS,CAAC,IAAItB,cAAc,CAAC,IAAI,CAACY,OAAO,EAAE,IAAI,CAACqB,SAAS,CAAC,CAAC;IACvF,IAAI,CAACX,SAAS,CAAC,IAAI,CAACa,eAAe,CAACC,QAAQ,CAAEC,MAAM,IAAK;MACrD,IAAI,CAAC,IAAI,CAACJ,SAAS,CAACK,MAAM,EAAE;QACxB;QACA;MACJ;MACA,MAAMC,QAAQ,GAAIF,MAAM,CAACG,iBAAiB,GAAG,IAAI,CAACC,kBAAkB,CAACJ,MAAM,CAACK,KAAK,CAAC,GAAGL,MAAM,CAACK,KAAM;MAClG,IAAI,CAACC,WAAW,CAAC,IAAIC,WAAW,CAAC,IAAI,CAACX,SAAS,CAACK,MAAM,EAAEC,QAAQ,EAAEF,MAAM,CAACQ,UAAU,CAAC,CAAC;IACzF,CAAC,CAAC,CAAC;IACH,IAAI,CAACvB,SAAS,CAACjC,GAAG,CAACyD,6BAA6B,CAAC,IAAI,CAACzB,OAAO,CAAC0B,UAAU,CAAC,CAAC,EAAE,SAAS,EAAGC,CAAC,IAAK;MAC1F,IAAIA,CAAC,CAACC,MAAM,CAAC,CAAC,CAAC,oBAAoB,CAAC,EAAE;QAClC,IAAI,CAACC,IAAI,CAAC,CAAC;MACf;IACJ,CAAC,CAAC,CAAC;IACH,IAAI,CAAC5B,SAAS,CAACvB,oBAAoB,CAACoD,WAAW,CAAC,MAAM;MAClD,IAAI,IAAI,CAAC9B,OAAO,CAAC+B,QAAQ,IAAI,IAAI,CAACrC,cAAc,EAAE;QAC9C,IAAI,CAACsC,iBAAiB,CAAC,IAAI,CAACtC,cAAc,CAAC,CAAC,CAAC;MACjD;IACJ,CAAC,CAAC,CAAC;EACP;;EACA,IAAIuC,MAAMA,CAAA,EAAG;IACT,OAAO,IAAI,CAACjC,OAAO;EACvB;EACA;AACJ;AACA;EACIkC,WAAWA,CAACC,UAAU,EAAE;IACpB,IAAI,IAAI,CAACnC,OAAO,CAACoC,UAAU,EAAE;MACzB,OAAO,IAAI;IACf;IACA,MAAMC,gBAAgB,GAAG,EAAE;IAC3B,KAAK,MAAMhC,WAAW,IAAI,IAAI,CAACD,aAAa,EAAE;MAC1C,IAAIC,WAAW,CAACiC,kBAAkB,EAAE;QAChC,MAAMrB,MAAM,GAAGZ,WAAW,CAACiC,kBAAkB,CAACH,UAAU,CAAC;QACzD,IAAIlB,MAAM,EAAE;UACRoB,gBAAgB,CAAC9B,IAAI,CAACU,MAAM,CAAC;QACjC;MACJ;IACJ;IACA,MAAMlE,MAAM,GAAGoF,UAAU,CAACpF,MAAM;IAChC,IAAIA,MAAM,CAACwF,IAAI,KAAK,CAAC,CAAC,oCAAoC;MACtDF,gBAAgB,CAAC9B,IAAI,CAAC,IAAI1B,gBAAgB,CAAC,CAAC,EAAE9B,MAAM,CAACyF,KAAK,EAAEL,UAAU,CAACM,KAAK,CAACC,IAAI,EAAEP,UAAU,CAACM,KAAK,CAACE,IAAI,CAAC,CAAC;IAC9G;IACA,IAAI5F,MAAM,CAACwF,IAAI,KAAK,CAAC,CAAC,qCAAqC;MACvD,MAAMK,OAAO,GAAG,IAAI,CAACrD,OAAO,CAACK,SAAS,CAAC,EAAE,CAAC,2BAA2B,CAAC,CAACiD,8BAA8B,GAAG,CAAC;MACzG,IAAI,CAAC9F,MAAM,CAAC+F,MAAM,CAACC,YAAY,IAAI,OAAOhG,MAAM,CAAC+F,MAAM,CAACE,wBAAwB,KAAK,QAAQ,IAAIjG,MAAM,CAAC+F,MAAM,CAACE,wBAAwB,GAAGJ,OAAO,EAAE;QAC/I;QACAP,gBAAgB,CAAC9B,IAAI,CAAC,IAAI1B,gBAAgB,CAAC,CAAC,EAAE9B,MAAM,CAACyF,KAAK,EAAEL,UAAU,CAACM,KAAK,CAACC,IAAI,EAAEP,UAAU,CAACM,KAAK,CAACE,IAAI,CAAC,CAAC;MAC9G;IACJ;IACA,IAAIN,gBAAgB,CAACjF,MAAM,KAAK,CAAC,EAAE;MAC/B,OAAO,IAAI,CAAC6F,0BAA0B,CAAC,IAAI,EAAE,CAAC,CAAC,8BAA8B,CAAC,CAAC,8BAA8B,KAAK,EAAEd,UAAU,CAAC;IACnI;IACAE,gBAAgB,CAAC7B,IAAI,CAAC,CAAC0C,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAACC,QAAQ,GAAGF,CAAC,CAACE,QAAQ,CAAC;IACxD,OAAO,IAAI,CAACH,0BAA0B,CAACZ,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,8BAA8B,CAAC,CAAC,8BAA8B,KAAK,EAAEF,UAAU,CAAC;EAClJ;EACAkB,mBAAmBA,CAACb,KAAK,EAAEc,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAE;IAC5C,IAAI,CAACP,0BAA0B,CAAC,IAAIpE,gBAAgB,CAAC,CAAC,EAAE2D,KAAK,EAAEiB,SAAS,EAAEA,SAAS,CAAC,EAAEH,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAE,IAAI,CAAC;EACpH;EACA;AACJ;AACA;EACIP,0BAA0BA,CAAChC,MAAM,EAAEqC,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAErB,UAAU,EAAE;IAChE,IAAI,CAAC,IAAI,CAACnC,OAAO,CAAC+B,QAAQ,IAAI,CAAC,IAAI,CAACrC,cAAc,EAAE;MAChD;MACA,IAAIuB,MAAM,EAAE;QACR,IAAI,CAACyC,+BAA+B,CAACzC,MAAM,EAAEqC,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAE,KAAK,CAAC;QACxE,OAAO,IAAI;MACf;MACA,OAAO,KAAK;IAChB;IACA;IACA,MAAMG,aAAa,GAAG,IAAI,CAACpE,OAAO,CAACK,SAAS,CAAC,EAAE,CAAC,wBAAwB,CAAC,CAACgE,MAAM;IAChF,MAAMC,eAAe,GAAIF,aAAa,IAAIxB,UAAU,IAAI,IAAI,CAACnC,OAAO,CAAC8D,oBAAoB,CAAC3B,UAAU,CAACM,KAAK,CAACC,IAAI,EAAEP,UAAU,CAACM,KAAK,CAACE,IAAI,CAAE;IACxI,IAAIkB,eAAe,EAAE;MACjB;MACA;MACA,IAAI5C,MAAM,EAAE;QACR,IAAI,CAACyC,+BAA+B,CAACzC,MAAM,EAAEqC,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAE,IAAI,CAAC;MAC3E;MACA,OAAO,IAAI;IACf;IACA,IAAI,CAACvC,MAAM,EAAE;MACT,IAAI,CAACe,iBAAiB,CAAC,IAAI,CAAC;MAC5B,OAAO,KAAK;IAChB;IACA,IAAIf,MAAM,IAAI,IAAI,CAACvB,cAAc,CAACuB,MAAM,CAACW,MAAM,CAACX,MAAM,CAAC,EAAE;MACrD;MACA,OAAO,IAAI;IACf;IACA,IAAI,CAACA,MAAM,CAAC8C,oBAAoB,CAAC,IAAI,CAACrE,cAAc,CAACuB,MAAM,EAAE,IAAI,CAACjB,OAAO,CAAC+B,QAAQ,CAAC,EAAE;MACjF;MACA,IAAI,CAACC,iBAAiB,CAAC,IAAI,CAAC;MAC5B,IAAI,CAAC0B,+BAA+B,CAACzC,MAAM,EAAEqC,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAE,KAAK,CAAC;MACxE,OAAO,IAAI;IACf;IACA;IACA;IACA,IAAI,CAACxB,iBAAiB,CAAC,IAAI,CAACtC,cAAc,CAACsE,MAAM,CAAC/C,MAAM,CAAC,CAAC;IAC1D,IAAI,CAACyC,+BAA+B,CAACzC,MAAM,EAAEqC,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAE,KAAK,CAAC;IACxE,OAAO,IAAI;EACf;EACAE,+BAA+BA,CAACzC,MAAM,EAAEqC,IAAI,EAAEC,MAAM,EAAEC,KAAK,EAAES,2BAA2B,EAAE;IACtF,IAAI,IAAI,CAACrD,SAAS,CAACK,MAAM,IAAI,IAAI,CAACL,SAAS,CAACK,MAAM,CAACW,MAAM,CAACX,MAAM,CAAC,EAAE;MAC/D;MACA;IACJ;IACA,IAAI,CAACH,eAAe,CAACoD,MAAM,CAAC,CAAC;IAC7B,IAAI,CAACtD,SAAS,CAACK,MAAM,GAAGA,MAAM;IAC9B,IAAI,CAACL,SAAS,CAACuD,WAAW,GAAGX,KAAK;IAClC,IAAI,CAAC5C,SAAS,CAAC2C,MAAM,GAAGA,MAAM;IAC9B,IAAI,CAAC3C,SAAS,CAACqD,2BAA2B,GAAGA,2BAA2B;IACxE,IAAI,CAACnD,eAAe,CAACsD,KAAK,CAACd,IAAI,CAAC;EACpC;EACAtB,iBAAiBA,CAACqC,WAAW,EAAE;IAC3B,IAAI,IAAI,CAAC3E,cAAc,KAAK2E,WAAW,EAAE;MACrC;MACA;IACJ;IACA,IAAIA,WAAW,IAAIA,WAAW,CAACnD,QAAQ,CAAC9D,MAAM,KAAK,CAAC,EAAE;MAClDiH,WAAW,GAAG,IAAI;IACtB;IACA,IAAI,CAAC3E,cAAc,GAAG2E,WAAW;IACjC,IAAI,IAAI,CAAC3E,cAAc,EAAE;MACrB,IAAI,CAAC4E,eAAe,CAAC,IAAI,CAAC5E,cAAc,CAACuB,MAAM,EAAE,IAAI,CAACvB,cAAc,CAACwB,QAAQ,CAAC;IAClF,CAAC,MACI;MACD,IAAI,CAAClB,OAAO,CAAC6B,IAAI,CAAC,CAAC;IACvB;EACJ;EACAA,IAAIA,CAAA,EAAG;IACH,IAAI,CAACjB,SAAS,CAACK,MAAM,GAAG,IAAI;IAC5B,IAAI,CAACH,eAAe,CAACoD,MAAM,CAAC,CAAC;IAC7B,IAAI,CAAClC,iBAAiB,CAAC,IAAI,CAAC;EAChC;EACA,IAAIuC,oBAAoBA,CAAA,EAAG;IACvB,OAAO,IAAI,CAACvE,OAAO,CAACuE,oBAAoB;EAC5C;EACA,IAAIC,qBAAqBA,CAAA,EAAG;IACxB,OAAO,IAAI,CAACxE,OAAO,CAACwE,qBAAqB;EAC7C;EACA,IAAIC,SAASA,CAAA,EAAG;IACZ,OAAO,IAAI,CAACzE,OAAO,CAACyE,SAAS;EACjC;EACA,IAAIC,SAASA,CAAA,EAAG;IACZ,OAAO,IAAI,CAAC1E,OAAO,CAAC0E,SAAS;EACjC;EACA,IAAItC,UAAUA,CAAA,EAAG;IACb,OAAO,IAAI,CAACpC,OAAO,CAACoC,UAAU;EAClC;EACAuC,YAAYA,CAACC,IAAI,EAAE;IACf,OAAQA,IAAI,GAAG,IAAI,CAAC5E,OAAO,CAAC0B,UAAU,CAAC,CAAC,CAACmD,QAAQ,CAACD,IAAI,CAAC,GAAG,KAAK;EACnE;EACAxD,kBAAkBA,CAACJ,MAAM,EAAE;IACvB,IAAI,IAAI,CAACJ,SAAS,CAACK,MAAM,EAAE;MACvB,KAAK,MAAMZ,WAAW,IAAI,IAAI,CAACD,aAAa,EAAE;QAC1C,IAAIC,WAAW,CAACyE,oBAAoB,EAAE;UAClC,MAAMC,cAAc,GAAG1E,WAAW,CAACyE,oBAAoB,CAAC,IAAI,CAAClE,SAAS,CAACK,MAAM,CAAC;UAC9E,IAAI8D,cAAc,EAAE;YAChB,OAAO/D,MAAM,CAACgE,KAAK,CAAC,CAAC,CAAC,CAACC,MAAM,CAAC,CAACF,cAAc,CAAC,CAAC;UACnD;QACJ;MACJ;IACJ;IACA,OAAO/D,MAAM;EACjB;EACAM,WAAWA,CAAC+C,WAAW,EAAE;IACrB,IAAI,IAAI,CAACrE,OAAO,CAAC+B,QAAQ,IAAI,IAAI,CAACrC,cAAc,IAAI,IAAI,CAACA,cAAc,CAAC8B,UAAU,EAAE;MAChF;MACA,IAAI,CAAC6C,WAAW,CAAC7C,UAAU,EAAE;QACzB;QACA;MACJ;MACA,IAAI,IAAI,CAACZ,SAAS,CAACqD,2BAA2B,IAAII,WAAW,CAACnD,QAAQ,CAAC9D,MAAM,KAAK,CAAC,EAAE;QACjF;QACA;MACJ;IACJ;IACA,IAAI,CAAC4E,iBAAiB,CAACqC,WAAW,CAAC;EACvC;EACAC,eAAeA,CAACrD,MAAM,EAAEC,QAAQ,EAAE;IAC9B,MAAM;MAAEgE,cAAc;MAAEC,uBAAuB;MAAEC;IAAe,CAAC,GAAG/F,sBAAsB,CAACgG,kBAAkB,CAAC,IAAI,CAAC9F,OAAO,EAAE0B,MAAM,CAACuB,KAAK,EAAEtB,QAAQ,CAAC;IACnJ,MAAMoE,WAAW,GAAG,IAAIjH,eAAe,CAAC,CAAC;IACzC,MAAMkH,SAAS,GAAGD,WAAW,CAACE,GAAG,CAAC,IAAIC,oBAAoB,CAAC,IAAI,CAAChG,kBAAkB,CAAC,CAAC;IACpF,MAAMiG,QAAQ,GAAGC,QAAQ,CAACC,sBAAsB,CAAC,CAAC;IAClD,IAAIC,WAAW,GAAG,IAAI;IACtB,MAAMC,OAAO,GAAG;MACZJ,QAAQ;MACRH,SAAS;MACTQ,cAAc,EAAG9D,MAAM,IAAK4D,WAAW,GAAG5D,MAAM;MAChD+D,iBAAiB,EAAEA,CAAA,KAAM,IAAI,CAAChG,OAAO,CAACgG,iBAAiB,CAAC,CAAC;MACzDC,oBAAoB,EAAGC,UAAU,IAAK,IAAI,CAAClG,OAAO,CAACiG,oBAAoB,CAACC,UAAU,CAAC;MACnFrE,IAAI,EAAEA,CAAA,KAAM,IAAI,CAACA,IAAI,CAAC;IAC1B,CAAC;IACD,KAAK,MAAMxB,WAAW,IAAI,IAAI,CAACD,aAAa,EAAE;MAC1C,MAAM+F,UAAU,GAAGjF,QAAQ,CAAC8C,MAAM,CAACoC,GAAG,IAAIA,GAAG,CAACC,KAAK,KAAKhG,WAAW,CAAC;MACpE,IAAI8F,UAAU,CAAC/I,MAAM,GAAG,CAAC,EAAE;QACvBkI,WAAW,CAACE,GAAG,CAACnF,WAAW,CAACiG,gBAAgB,CAACR,OAAO,EAAEK,UAAU,CAAC,CAAC;MACtE;IACJ;IACA,MAAMI,eAAe,GAAGrF,QAAQ,CAACsF,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACF,eAAe,CAAC;IAC7D,IAAIhB,SAAS,CAACmB,UAAU,EAAE;MACtBhB,QAAQ,CAACiB,WAAW,CAACpB,SAAS,CAACqB,YAAY,CAAC;IAChD;IACA,IAAIlB,QAAQ,CAACmB,aAAa,CAAC,CAAC,EAAE;MAC1B,IAAIzB,cAAc,EAAE;QAChB,MAAM0B,mBAAmB,GAAG,IAAI,CAACvH,OAAO,CAACwH,2BAA2B,CAAC,CAAC;QACtED,mBAAmB,CAACE,GAAG,CAAC,CAAC;UACjBxE,KAAK,EAAE4C,cAAc;UACrB6B,OAAO,EAAE5H,sBAAsB,CAAC6H;QACpC,CAAC,CAAC,CAAC;QACP5B,WAAW,CAACE,GAAG,CAAClH,YAAY,CAAC,MAAM;UAC/BwI,mBAAmB,CAACK,KAAK,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;MACP;MACA,IAAI,CAACnH,OAAO,CAACoH,MAAM,CAAC1B,QAAQ,EAAE,IAAI2B,uBAAuB,CAACxB,WAAW,EAAEX,cAAc,EAAEC,uBAAuB,EAAE,IAAI,CAAC5F,OAAO,CAACK,SAAS,CAAC,EAAE,CAAC,wBAAwB,CAAC,CAAC0H,KAAK,EAAE,IAAI,CAAC1G,SAAS,CAACuD,WAAW,EAAE,IAAI,CAACvD,SAAS,CAAC2C,MAAM,EAAEgD,eAAe,EAAEtF,MAAM,CAACsG,gBAAgB,EAAEtG,MAAM,CAACuG,gBAAgB,EAAElC,WAAW,CAAC,CAAC;IAClT,CAAC,MACI;MACDA,WAAW,CAACmC,OAAO,CAAC,CAAC;IACzB;EACJ;EACA,OAAOpC,kBAAkBA,CAACqC,MAAM,EAAEC,WAAW,EAAEzG,QAAQ,EAAE;IACrD,IAAI0G,mBAAmB,GAAG,CAAC;IAC3B,IAAIF,MAAM,CAACG,QAAQ,CAAC,CAAC,EAAE;MACnB;MACA,MAAMC,SAAS,GAAGJ,MAAM,CAACK,aAAa,CAAC,CAAC;MACxC,MAAMC,oBAAoB,GAAGF,SAAS,CAACE,oBAAoB;MAC3D,MAAMC,eAAe,GAAGD,oBAAoB,CAACE,4BAA4B,CAACP,WAAW,CAAC;MACtF,MAAMQ,oBAAoB,GAAG,IAAI5J,QAAQ,CAAC0J,eAAe,CAACG,eAAe,EAAEN,SAAS,CAACO,gBAAgB,CAACJ,eAAe,CAACG,eAAe,CAAC,CAAC;MACvIR,mBAAmB,GAAGI,oBAAoB,CAACM,kCAAkC,CAACH,oBAAoB,CAAC,CAACI,MAAM;IAC9G;IACA;IACA,MAAMC,gBAAgB,GAAGb,WAAW,CAACS,eAAe;IACpD,IAAIK,iBAAiB,GAAGd,WAAW,CAACe,WAAW;IAC/C,IAAItD,cAAc,GAAGlE,QAAQ,CAAC,CAAC,CAAC,CAACsB,KAAK;IACtC,IAAImG,gBAAgB,GAAG,IAAI;IAC3B,KAAK,MAAMvC,GAAG,IAAIlF,QAAQ,EAAE;MACxBkE,cAAc,GAAG5G,KAAK,CAACoK,SAAS,CAACxD,cAAc,EAAEgB,GAAG,CAAC5D,KAAK,CAAC;MAC3D,IAAI4D,GAAG,CAAC5D,KAAK,CAAC4F,eAAe,KAAKI,gBAAgB,IAAIpC,GAAG,CAAC5D,KAAK,CAACqG,aAAa,KAAKL,gBAAgB,EAAE;QAChG;QACAC,iBAAiB,GAAGK,IAAI,CAACC,GAAG,CAACD,IAAI,CAACE,GAAG,CAACP,iBAAiB,EAAErC,GAAG,CAAC5D,KAAK,CAACkG,WAAW,CAAC,EAAEd,mBAAmB,CAAC;MACzG;MACA,IAAIxB,GAAG,CAACuC,gBAAgB,EAAE;QACtBA,gBAAgB,GAAGvC,GAAG,CAAC5D,KAAK;MAChC;IACJ;IACA,OAAO;MACH0C,cAAc,EAAEyD,gBAAgB,GAAGA,gBAAgB,CAACM,gBAAgB,CAAC,CAAC,GAAG,IAAI1K,QAAQ,CAACiK,gBAAgB,EAAEb,WAAW,CAACe,WAAW,CAAC;MAChIvD,uBAAuB,EAAEwD,gBAAgB,GAAGA,gBAAgB,CAACM,gBAAgB,CAAC,CAAC,GAAG,IAAI1K,QAAQ,CAACiK,gBAAgB,EAAEC,iBAAiB,CAAC;MACnIrD;IACJ,CAAC;EACL;EACA5B,KAAKA,CAAA,EAAG;IACJ,IAAI,CAACxD,OAAO,CAACwD,KAAK,CAAC,CAAC;EACxB;EACA0F,QAAQA,CAAA,EAAG;IACP,IAAI,CAAClJ,OAAO,CAACkJ,QAAQ,CAAC,CAAC;EAC3B;EACAC,UAAUA,CAAA,EAAG;IACT,IAAI,CAACnJ,OAAO,CAACmJ,UAAU,CAAC,CAAC;EAC7B;EACAC,UAAUA,CAAA,EAAG;IACT,IAAI,CAACpJ,OAAO,CAACoJ,UAAU,CAAC,CAAC;EAC7B;EACAC,WAAWA,CAAA,EAAG;IACV,IAAI,CAACrJ,OAAO,CAACqJ,WAAW,CAAC,CAAC;EAC9B;EACAC,MAAMA,CAAA,EAAG;IACL,IAAI,CAACtJ,OAAO,CAACsJ,MAAM,CAAC,CAAC;EACzB;EACAC,QAAQA,CAAA,EAAG;IACP,IAAI,CAACvJ,OAAO,CAACuJ,QAAQ,CAAC,CAAC;EAC3B;EACAC,OAAOA,CAAA,EAAG;IACN,IAAI,CAACxJ,OAAO,CAACwJ,OAAO,CAAC,CAAC;EAC1B;EACAC,UAAUA,CAAA,EAAG;IACT,IAAI,CAACzJ,OAAO,CAACyJ,UAAU,CAAC,CAAC;EAC7B;AACJ,CAAC;AACDpK,sBAAsB,CAAC6H,mBAAmB,GAAGzI,sBAAsB,CAACiL,QAAQ,CAAC;EACzEC,WAAW,EAAE,yBAAyB;EACtCC,SAAS,EAAE;AACf,CAAC,CAAC;AACFvK,sBAAsB,GAAGxC,UAAU,CAAC,CAChCgB,OAAO,CAAC,CAAC,EAAEiB,qBAAqB,CAAC,EACjCjB,OAAO,CAAC,CAAC,EAAEkB,kBAAkB,CAAC,CACjC,EAAEM,sBAAsB,CAAC;AAC1B,SAASA,sBAAsB;AAC/B,MAAMkC,WAAW,CAAC;EACdjC,WAAWA,CAAC2B,MAAM,EAAEC,QAAQ,EAAEM,UAAU,EAAE;IACtC,IAAI,CAACP,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACM,UAAU,GAAGA,UAAU;EAChC;EACAwC,MAAMA,CAAC/C,MAAM,EAAE;IACX,MAAM4I,gBAAgB,GAAG,IAAI,CAAC3I,QAAQ,CAAC8C,MAAM,CAAEyC,CAAC,IAAKA,CAAC,CAACqD,qBAAqB,CAAC7I,MAAM,CAAC,CAAC;IACrF,IAAI4I,gBAAgB,CAACzM,MAAM,KAAK,IAAI,CAAC8D,QAAQ,CAAC9D,MAAM,EAAE;MAClD,OAAO,IAAI;IACf;IACA,OAAO,IAAI2M,mBAAmB,CAAC,IAAI,EAAE,IAAI,CAAC9I,MAAM,EAAE4I,gBAAgB,EAAE,IAAI,CAACrI,UAAU,CAAC;EACxF;AACJ;AACA,MAAMuI,mBAAmB,SAASxI,WAAW,CAAC;EAC1CjC,WAAWA,CAAC0K,QAAQ,EAAE/I,MAAM,EAAEC,QAAQ,EAAEM,UAAU,EAAE;IAChD,KAAK,CAACP,MAAM,EAAEC,QAAQ,EAAEM,UAAU,CAAC;IACnC,IAAI,CAACwI,QAAQ,GAAGA,QAAQ;EAC5B;EACAhG,MAAMA,CAAC/C,MAAM,EAAE;IACX,OAAO,IAAI,CAAC+I,QAAQ,CAAChG,MAAM,CAAC/C,MAAM,CAAC;EACvC;AACJ;AACA,MAAMoG,uBAAuB,CAAC;EAC1B/H,WAAWA,CAACuG,WAAW,EAAEX,cAAc,EAAEC,uBAAuB,EAAE8E,WAAW,EAAEC,UAAU,EAAE3G,MAAM,EAAEgD,eAAe,EAAEgB,gBAAgB,EAAEC,gBAAgB,EAAElC,WAAW,EAAE;IACjK,IAAI,CAACO,WAAW,GAAGA,WAAW;IAC9B,IAAI,CAACX,cAAc,GAAGA,cAAc;IACpC,IAAI,CAACC,uBAAuB,GAAGA,uBAAuB;IACtD,IAAI,CAAC8E,WAAW,GAAGA,WAAW;IAC9B,IAAI,CAACC,UAAU,GAAGA,UAAU;IAC5B,IAAI,CAAC3G,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACgD,eAAe,GAAGA,eAAe;IACtC,IAAI,CAACgB,gBAAgB,GAAGA,gBAAgB;IACxC,IAAI,CAACC,gBAAgB,GAAGA,gBAAgB;IACxC,IAAI,CAAClC,WAAW,GAAGA,WAAW;IAC9B,IAAI,CAAC6E,oBAAoB,GAAG1G,SAAS;EACzC;AACJ;AACA,MAAM2G,uBAAuB,GAAG,EAAE;AAClC,MAAMC,eAAe,GAAG,EAAE;AAC1B,MAAMC,wBAAwB,GAAG,CAAC;AAClC,IAAInK,kBAAkB,GAAG,MAAMA,kBAAkB,SAAShB,sBAAsB,CAAC;EAC7E,IAAIoF,oBAAoBA,CAAA,EAAG;IACvB,IAAIgG,EAAE;IACN,OAAOC,OAAO,CAAC,CAACD,EAAE,GAAG,IAAI,CAACE,YAAY,MAAM,IAAI,IAAIF,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAAC1E,WAAW,CAAC;EAChG;EACA,IAAIrB,qBAAqBA,CAAA,EAAG;IACxB,IAAI+F,EAAE;IACN,OAAQ,CAAC,CAACA,EAAE,GAAG,IAAI,CAACE,YAAY,MAAM,IAAI,IAAIF,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAAChH,MAAM,MAAM,CAAC,CAAC;EAC5F;;EACA,IAAIkB,SAASA,CAAA,EAAG;IACZ,IAAI8F,EAAE;IACN,OAAO,CAACA,EAAE,GAAG,IAAI,CAACG,gBAAgB,CAACC,GAAG,CAAC,CAAC,MAAM,IAAI,IAAIJ,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,KAAK;EACpF;EACA,IAAI7F,SAASA,CAAA,EAAG;IACZ,IAAI6F,EAAE;IACN,OAAO,CAACA,EAAE,GAAG,IAAI,CAACK,gBAAgB,CAACD,GAAG,CAAC,CAAC,MAAM,IAAI,IAAIJ,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,KAAK;EACpF;EACAjL,WAAWA,CAACoI,MAAM,EAAE5H,WAAW,EAAE+K,iBAAiB,EAAE;IAChD,KAAK,CAACnD,MAAM,EAAE5H,WAAW,CAAC;IAC1B,IAAI,CAACgL,MAAM,GAAG,IAAI,CAAC7K,SAAS,CAAC,IAAI/B,WAAW,CAAC,CAAC,CAAC;IAC/C,IAAI,CAACwM,gBAAgB,GAAGzL,iBAAiB,CAAC8L,YAAY,CAACC,MAAM,CAACH,iBAAiB,CAAC;IAChF,IAAI,CAACD,gBAAgB,GAAG3L,iBAAiB,CAACgM,YAAY,CAACD,MAAM,CAACH,iBAAiB,CAAC;IAChF7M,GAAG,CAACkN,MAAM,CAAC,IAAI,CAACC,cAAc,CAACC,OAAO,EAAE,IAAI,CAACN,MAAM,CAACO,gBAAgB,CAAC;IACrE,IAAI,CAACF,cAAc,CAACC,OAAO,CAACE,KAAK,CAACC,MAAM,GAAG,IAAI;IAC/C,IAAI,CAACtL,SAAS,CAAC,IAAI,CAACV,OAAO,CAACiM,iBAAiB,CAAC,MAAM,IAAI,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC;IACpE,IAAI,CAACxL,SAAS,CAAC,IAAI,CAACV,OAAO,CAACmM,wBAAwB,CAAE/J,CAAC,IAAK;MACxD,IAAIA,CAAC,CAACgK,UAAU,CAAC,EAAE,CAAC,2BAA2B,CAAC,EAAE;QAC9C,IAAI,CAACC,WAAW,CAAC,CAAC;MACtB;IACJ,CAAC,CAAC,CAAC;IACH,MAAMC,YAAY,GAAG,IAAI,CAAC5L,SAAS,CAACjC,GAAG,CAAC8N,UAAU,CAAC,IAAI,CAACX,cAAc,CAACC,OAAO,CAAC,CAAC;IAChF,IAAI,CAACnL,SAAS,CAAC4L,YAAY,CAACE,UAAU,CAAC,MAAM;MACzC,IAAI,CAACnB,gBAAgB,CAAC5D,GAAG,CAAC,IAAI,CAAC;IACnC,CAAC,CAAC,CAAC;IACH,IAAI,CAAC/G,SAAS,CAAC4L,YAAY,CAACG,SAAS,CAAC,MAAM;MACxC,IAAI,CAACpB,gBAAgB,CAAC5D,GAAG,CAAC,KAAK,CAAC;IACpC,CAAC,CAAC,CAAC;IACH,IAAI,CAACiF,aAAa,CAACxI,SAAS,CAAC;IAC7B,IAAI,CAACgI,OAAO,CAAC,CAAC;IACd,IAAI,CAAClM,OAAO,CAAC2M,gBAAgB,CAAC,IAAI,CAAC;EACvC;EACAzE,OAAOA,CAAA,EAAG;IACN,IAAI8C,EAAE;IACN,KAAK,CAAC9C,OAAO,CAAC,CAAC;IACf,CAAC8C,EAAE,GAAG,IAAI,CAACE,YAAY,MAAM,IAAI,IAAIF,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACjF,WAAW,CAACmC,OAAO,CAAC,CAAC;IACtF,IAAI,CAAClI,OAAO,CAAC4M,mBAAmB,CAAC,IAAI,CAAC;EAC1C;EACAC,KAAKA,CAAA,EAAG;IACJ,OAAOjM,kBAAkB,CAACkM,EAAE;EAChC;EACA,OAAOC,gBAAgBA,CAACC,SAAS,EAAEC,KAAK,EAAEC,MAAM,EAAE;IAC9C,MAAMC,gBAAgB,GAAG,OAAOF,KAAK,KAAK,QAAQ,GAAI,GAAEA,KAAM,IAAG,GAAGA,KAAK;IACzE,MAAMG,iBAAiB,GAAG,OAAOF,MAAM,KAAK,QAAQ,GAAI,GAAEA,MAAO,IAAG,GAAGA,MAAM;IAC7EF,SAAS,CAACjB,KAAK,CAACkB,KAAK,GAAGE,gBAAgB;IACxCH,SAAS,CAACjB,KAAK,CAACmB,MAAM,GAAGE,iBAAiB;EAC9C;EACAC,6BAA6BA,CAACJ,KAAK,EAAEC,MAAM,EAAE;IACzC,MAAMI,eAAe,GAAG,IAAI,CAAC/B,MAAM,CAAC+B,eAAe;IACnD,OAAO1M,kBAAkB,CAACmM,gBAAgB,CAACO,eAAe,EAAEL,KAAK,EAAEC,MAAM,CAAC;EAC9E;EACAK,8BAA8BA,CAACN,KAAK,EAAEC,MAAM,EAAE;IAC1C,MAAMpB,gBAAgB,GAAG,IAAI,CAACP,MAAM,CAACO,gBAAgB;IACrD,OAAOlL,kBAAkB,CAACmM,gBAAgB,CAACjB,gBAAgB,EAAEmB,KAAK,EAAEC,MAAM,CAAC;EAC/E;EACAM,yBAAyBA,CAACP,KAAK,EAAEC,MAAM,EAAE;IACrC,IAAI,CAACG,6BAA6B,CAACJ,KAAK,EAAEC,MAAM,CAAC;IACjD,IAAI,CAACK,8BAA8B,CAACN,KAAK,EAAEC,MAAM,CAAC;IAClD,IAAI,CAACO,oBAAoB,CAAC,CAAC;EAC/B;EACA,OAAOC,mBAAmBA,CAACV,SAAS,EAAEC,KAAK,EAAEC,MAAM,EAAE;IACjD,MAAMC,gBAAgB,GAAG,OAAOF,KAAK,KAAK,QAAQ,GAAI,GAAEA,KAAM,IAAG,GAAGA,KAAK;IACzE,MAAMG,iBAAiB,GAAG,OAAOF,MAAM,KAAK,QAAQ,GAAI,GAAEA,MAAO,IAAG,GAAGA,MAAM;IAC7EF,SAAS,CAACjB,KAAK,CAAC4B,QAAQ,GAAGR,gBAAgB;IAC3CH,SAAS,CAACjB,KAAK,CAAC6B,SAAS,GAAGR,iBAAiB;EACjD;EACAS,4BAA4BA,CAACZ,KAAK,EAAEC,MAAM,EAAE;IACxCtM,kBAAkB,CAAC8M,mBAAmB,CAAC,IAAI,CAACnC,MAAM,CAAC+B,eAAe,EAAEL,KAAK,EAAEC,MAAM,CAAC;IAClFtM,kBAAkB,CAAC8M,mBAAmB,CAAC,IAAI,CAACnC,MAAM,CAACO,gBAAgB,EAAEmB,KAAK,EAAEC,MAAM,CAAC;IACnF,IAAI,CAAC3B,MAAM,CAACO,gBAAgB,CAACC,KAAK,CAAC+B,WAAW,CAAC,kBAAkB,EAAE,OAAOb,KAAK,KAAK,QAAQ,GAAI,GAAEA,KAAM,IAAG,GAAGA,KAAK,CAAC;IACpH,IAAI,CAACQ,oBAAoB,CAAC,CAAC;EAC/B;EACAM,uBAAuBA,CAAA,EAAG;IACtB,MAAMC,gBAAgB,GAAG,IAAI,CAACzC,MAAM,CAAC0C,SAAS,CAACC,mBAAmB,CAAC,CAAC;IACpE,MAAMC,sBAAsB,GAAGH,gBAAgB,CAACI,WAAW,GAAGJ,gBAAgB,CAACf,KAAK;IACpF,OAAOkB,sBAAsB;EACjC;EACAE,4BAA4BA,CAAA,EAAG;IAC3B,MAAMf,eAAe,GAAG,IAAI,CAAC/B,MAAM,CAAC+B,eAAe;IACnD,MAAMgB,kBAAkB,GAAI,GAAE,IAAI,CAAC/C,MAAM,CAAC0C,SAAS,CAACvG,OAAO,CAAC6G,uBAAwB,IAAG;IACvF,IAAIjB,eAAe,CAACvB,KAAK,CAACyC,aAAa,KAAKF,kBAAkB,EAAE;MAC5DhB,eAAe,CAACvB,KAAK,CAACyC,aAAa,GAAGF,kBAAkB;IAC5D;EACJ;EACAG,iCAAiCA,CAACC,IAAI,EAAE;IACpC,IAAI,CAACb,4BAA4B,CAAC,MAAM,EAAE,MAAM,CAAC;IACjD,MAAMZ,KAAK,GAAGyB,IAAI,CAACzB,KAAK;IACxB,MAAMC,MAAM,GAAGwB,IAAI,CAACxB,MAAM;IAC1B,IAAI,CAACM,yBAAyB,CAACP,KAAK,EAAEC,MAAM,CAAC;IAC7C;IACA,IAAI,IAAI,CAACa,uBAAuB,CAAC,CAAC,EAAE;MAChC,IAAI,CAACM,4BAA4B,CAAC,CAAC;MACnC,IAAI,CAAChB,6BAA6B,CAACJ,KAAK,EAAEC,MAAM,GAAGpC,eAAe,CAAC;IACvE;EACJ;EACA6D,8BAA8BA,CAAA,EAAG;IAC7B,IAAI3D,EAAE,EAAE4D,EAAE;IACV,MAAMC,iBAAiB,GAAG,CAAC7D,EAAE,GAAG,IAAI,CAAC8D,0BAA0B,CAAC,CAAC,MAAM,IAAI,IAAI9D,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG+D,QAAQ;IAC5G,MAAMC,kBAAkB,GAAG,CAACJ,EAAE,GAAG,IAAI,CAACK,2BAA2B,CAAC,CAAC,MAAM,IAAI,IAAIL,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAGG,QAAQ;IAC9G,IAAI,CAACnD,cAAc,CAACsD,OAAO,GAAG,IAAIzQ,GAAG,CAAC+B,SAAS,CAACqO,iBAAiB,EAAEG,kBAAkB,CAAC;IACtF,IAAI,CAACnB,4BAA4B,CAACgB,iBAAiB,EAAEG,kBAAkB,CAAC;EAC5E;EACAG,OAAOA,CAACT,IAAI,EAAE;IACV,IAAI1D,EAAE,EAAE4D,EAAE;IACVhO,kBAAkB,CAACwO,eAAe,GAAG,IAAI3Q,GAAG,CAAC+B,SAAS,CAACkO,IAAI,CAACzB,KAAK,EAAEyB,IAAI,CAACxB,MAAM,CAAC;IAC/E,IAAI,CAACuB,iCAAiC,CAACC,IAAI,CAAC;IAC5C,IAAI,CAAC9C,cAAc,CAACyD,MAAM,CAACX,IAAI,CAACxB,MAAM,EAAEwB,IAAI,CAACzB,KAAK,CAAC;IACnD,IAAI,CAAC0B,8BAA8B,CAAC,CAAC;IACrC,IAAI,CAACpD,MAAM,CAAC0C,SAAS,CAACqB,WAAW,CAAC,CAAC;IACnC,IAAI,CAACtP,OAAO,CAACuP,mBAAmB,CAAC,IAAI,CAAC;IACtC,CAACX,EAAE,GAAG,CAAC5D,EAAE,GAAG,IAAI,CAACE,YAAY,MAAM,IAAI,IAAIF,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAAC1E,WAAW,MAAM,IAAI,IAAIsI,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACS,MAAM,CAAC,CAAC;EACxI;EACAG,6BAA6BA,CAAA,EAAG;IAC5B,IAAIxE,EAAE;IACN,MAAMxI,QAAQ,GAAG,CAACwI,EAAE,GAAG,IAAI,CAACE,YAAY,MAAM,IAAI,IAAIF,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACrF,cAAc;IAChG,IAAI,CAACnD,QAAQ,EAAE;MACX;IACJ;IACA,OAAO,IAAI,CAACiN,mBAAmB,KAAK,CAAC,CAAC,8CAA8C,IAAI,CAACC,4BAA4B,CAAClN,QAAQ,CAAC,GAAG,IAAI,CAACmN,4BAA4B,CAACnN,QAAQ,CAAC;EACjL;EACAyM,2BAA2BA,CAAA,EAAG;IAC1B,MAAMW,cAAc,GAAG,IAAI,CAACJ,6BAA6B,CAAC,CAAC;IAC3D,IAAI,CAACI,cAAc,EAAE;MACjB;IACJ;IACA;IACA,IAAIC,aAAa,GAAG9E,wBAAwB;IAC5C+E,KAAK,CAACC,IAAI,CAAC,IAAI,CAACxE,MAAM,CAAC+B,eAAe,CAAC0C,QAAQ,CAAC,CAACC,OAAO,CAAEC,SAAS,IAAK;MACpEL,aAAa,IAAIK,SAAS,CAACC,YAAY;IAC3C,CAAC,CAAC;IACF,IAAI,IAAI,CAACpC,uBAAuB,CAAC,CAAC,EAAE;MAChC8B,aAAa,IAAI/E,eAAe;IACpC;IACA,OAAOvB,IAAI,CAACE,GAAG,CAACmG,cAAc,EAAEC,aAAa,CAAC;EAClD;EACAf,0BAA0BA,CAAA,EAAG;IACzB,IAAI,CAAC,IAAI,CAAC9O,OAAO,IAAI,CAAC,IAAI,CAACA,OAAO,CAACsI,QAAQ,CAAC,CAAC,EAAE;MAC3C;IACJ;IACA,MAAM8H,YAAY,GAAG3R,GAAG,CAAC4R,aAAa,CAACjK,QAAQ,CAACkK,IAAI,CAAC,CAACrD,KAAK;IAC3D,MAAMsD,iBAAiB,GAAG,EAAE;IAC5B,OAAOH,YAAY,GAAGG,iBAAiB;EAC3C;EACAhM,oBAAoBA,CAACpB,IAAI,EAAEC,IAAI,EAAE;IAC7B,IAAI,CAAC,IAAI,CAAC8H,YAAY,EAAE;MACpB,OAAO,KAAK;IAChB;IACA,IAAI,OAAO,IAAI,CAACA,YAAY,CAAClD,gBAAgB,KAAK,WAAW,IAAI,OAAO,IAAI,CAACkD,YAAY,CAACjD,gBAAgB,KAAK,WAAW,EAAE;MACxH,IAAI,CAACiD,YAAY,CAAClD,gBAAgB,GAAG7E,IAAI;MACzC,IAAI,CAAC+H,YAAY,CAACjD,gBAAgB,GAAG7E,IAAI;MACzC,OAAO,KAAK;IAChB;IACA,MAAMoN,UAAU,GAAG/R,GAAG,CAACgS,sBAAsB,CAAC,IAAI,CAACtO,UAAU,CAAC,CAAC,CAAC;IAChE,IAAI,OAAO,IAAI,CAAC+I,YAAY,CAACN,oBAAoB,KAAK,WAAW,EAAE;MAC/D,IAAI,CAACM,YAAY,CAACN,oBAAoB,GAAG8F,mCAAmC,CAAC,IAAI,CAACxF,YAAY,CAAClD,gBAAgB,EAAE,IAAI,CAACkD,YAAY,CAACjD,gBAAgB,EAAEuI,UAAU,CAACG,IAAI,EAAEH,UAAU,CAACI,GAAG,EAAEJ,UAAU,CAACvD,KAAK,EAAEuD,UAAU,CAACtD,MAAM,CAAC;IAC9N;IACA,MAAM2D,QAAQ,GAAGH,mCAAmC,CAACvN,IAAI,EAAEC,IAAI,EAAEoN,UAAU,CAACG,IAAI,EAAEH,UAAU,CAACI,GAAG,EAAEJ,UAAU,CAACvD,KAAK,EAAEuD,UAAU,CAACtD,MAAM,CAAC;IACtI,IAAI2D,QAAQ,GAAG,IAAI,CAAC3F,YAAY,CAACN,oBAAoB,GAAG,CAAC,CAAC,6BAA6B;MACnF;MACA,OAAO,KAAK;IAChB;IACA,IAAI,CAACM,YAAY,CAACN,oBAAoB,GAAGrB,IAAI,CAACE,GAAG,CAAC,IAAI,CAACyB,YAAY,CAACN,oBAAoB,EAAEiG,QAAQ,CAAC;IACnG,OAAO,IAAI;EACf;EACAnE,aAAaA,CAACoE,SAAS,EAAE;IACrB,IAAI9F,EAAE;IACN,CAACA,EAAE,GAAG,IAAI,CAACE,YAAY,MAAM,IAAI,IAAIF,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACjF,WAAW,CAACmC,OAAO,CAAC,CAAC;IACtF,IAAI,CAACgD,YAAY,GAAG4F,SAAS;IAC7B,IAAI,CAAC3F,gBAAgB,CAAC1D,GAAG,CAAC,CAAC,CAACqJ,SAAS,CAAC;IACtC,IAAI,CAACvF,MAAM,CAACO,gBAAgB,CAACiF,SAAS,CAACC,MAAM,CAAC,QAAQ,EAAE,CAACF,SAAS,CAAC;EACvE;EACA5E,OAAOA,CAAA,EAAG;IACN,MAAM;MAAE+E,QAAQ;MAAEC;IAAW,CAAC,GAAG,IAAI,CAAClR,OAAO,CAACK,SAAS,CAAC,EAAE,CAAC,2BAA2B,CAAC;IACvF,MAAMiN,eAAe,GAAG,IAAI,CAAC/B,MAAM,CAAC+B,eAAe;IACnDA,eAAe,CAACvB,KAAK,CAACkF,QAAQ,GAAI,GAAEA,QAAS,IAAG;IAChD3D,eAAe,CAACvB,KAAK,CAACmF,UAAU,GAAI,GAAEA,UAAU,GAAGD,QAAS,EAAC;IAC7D,IAAI,CAACE,oBAAoB,CAAC,CAAC;EAC/B;EACA9E,WAAWA,CAAA,EAAG;IACV,MAAM+E,WAAW,GAAGtB,KAAK,CAACuB,SAAS,CAAC5L,KAAK,CAAC6L,IAAI,CAAC,IAAI,CAAC/F,MAAM,CAAC+B,eAAe,CAACiE,sBAAsB,CAAC,MAAM,CAAC,CAAC;IAC1GH,WAAW,CAACnB,OAAO,CAAC5K,IAAI,IAAI,IAAI,CAACrF,OAAO,CAACwR,aAAa,CAACnM,IAAI,CAAC,CAAC;EACjE;EACAoM,cAAcA,CAACpM,IAAI,EAAE;IACjB,MAAMiI,eAAe,GAAG,IAAI,CAAC/B,MAAM,CAAC+B,eAAe;IACnDA,eAAe,CAACvB,KAAK,CAACyC,aAAa,GAAG,EAAE;IACxClB,eAAe,CAACoE,WAAW,GAAG,EAAE;IAChCpE,eAAe,CAAClG,WAAW,CAAC/B,IAAI,CAAC;EACrC;EACAoI,oBAAoBA,CAAA,EAAG;IACnB,IAAI,CAACzN,OAAO,CAACuP,mBAAmB,CAAC,IAAI,CAAC;IACtC,IAAI,CAAChE,MAAM,CAAC9E,iBAAiB,CAAC,CAAC;EACnC;EACA0K,oBAAoBA,CAAA,EAAG;IACnB,MAAMjE,MAAM,GAAG3D,IAAI,CAACC,GAAG,CAAC,IAAI,CAACxJ,OAAO,CAAC2R,aAAa,CAAC,CAAC,CAACzE,MAAM,GAAG,CAAC,EAAE,GAAG,EAAEtM,kBAAkB,CAACwO,eAAe,CAAClC,MAAM,CAAC;IAChH,MAAMD,KAAK,GAAG1D,IAAI,CAACC,GAAG,CAAC,IAAI,CAACxJ,OAAO,CAAC2R,aAAa,CAAC,CAAC,CAAC1E,KAAK,GAAG,IAAI,EAAE,GAAG,EAAErM,kBAAkB,CAACwO,eAAe,CAACnC,KAAK,CAAC;IAChH,IAAI,CAACY,4BAA4B,CAACZ,KAAK,EAAEC,MAAM,CAAC;EACpD;EACA0E,OAAOA,CAACvM,IAAI,EAAEyL,SAAS,EAAE;IACrB,IAAI,CAACpE,aAAa,CAACoE,SAAS,CAAC;IAC7B,IAAI,CAACzE,WAAW,CAAC,CAAC;IAClB,IAAI,CAACoF,cAAc,CAACpM,IAAI,CAAC;IACzB,IAAI,CAAC8L,oBAAoB,CAAC,CAAC;IAC3B,IAAI,CAAC1K,iBAAiB,CAAC,CAAC;IACxB;IACA;IACA,IAAI,CAACzG,OAAO,CAAC6R,MAAM,CAAC,CAAC;EACzB;EACAC,WAAWA,CAAA,EAAG;IACV,IAAI9G,EAAE;IACN,IAAI,CAAC,IAAI,CAACE,YAAY,EAAE;MACpB,OAAO,IAAI;IACf;IACA,OAAO;MACH1I,QAAQ,EAAE,IAAI,CAAC0I,YAAY,CAACvF,cAAc;MAC1CoM,iBAAiB,EAAE,IAAI,CAAC7G,YAAY,CAACtF,uBAAuB;MAC5DoM,gBAAgB,EAAE,IAAI,CAAC9G,YAAY,CAAClE,eAAe,GAAG,CAAC,CAAC,4CAA4C9C,SAAS;MAC7G+N,UAAU,EAAE,CAAC,CAACjH,EAAE,GAAG,IAAI,CAACyE,mBAAmB,MAAM,IAAI,IAAIzE,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,CAAC,CAAC;IACpF,CAAC;EACL;;EACAnD,MAAMA,CAACxC,IAAI,EAAEyL,SAAS,EAAE;IACpB,IAAI9F,EAAE,EAAE4D,EAAE;IACV,IAAI,CAAC,IAAI,CAAC5O,OAAO,IAAI,CAAC,IAAI,CAACA,OAAO,CAACsI,QAAQ,CAAC,CAAC,EAAE;MAC3C;IACJ;IACA,IAAI,CAACsJ,OAAO,CAACvM,IAAI,EAAEyL,SAAS,CAAC;IAC7B,MAAMoB,YAAY,GAAGzT,GAAG,CAAC0T,cAAc,CAAC,IAAI,CAAC5G,MAAM,CAACO,gBAAgB,CAAC;IACrE,MAAMsG,cAAc,GAAGtB,SAAS,CAACnL,cAAc;IAC/C,IAAI,CAAC8J,mBAAmB,GAAG,CAACzE,EAAE,GAAG,IAAI,CAACqH,uBAAuB,CAACH,YAAY,EAAEE,cAAc,CAAC,MAAM,IAAI,IAAIpH,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,CAAC,CAAC;IAChI;IACA;IACA,IAAI,CAACvE,iBAAiB,CAAC,CAAC;IACxB,IAAIqK,SAAS,CAACnG,UAAU,EAAE;MACtB,IAAI,CAACY,MAAM,CAACO,gBAAgB,CAAC7H,KAAK,CAAC,CAAC;IACxC;IACA,CAAC2K,EAAE,GAAGkC,SAAS,CAACxK,WAAW,MAAM,IAAI,IAAIsI,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACS,MAAM,CAAC,CAAC;EACjF;EACA/M,IAAIA,CAAA,EAAG;IACH,IAAI,CAAC,IAAI,CAAC4I,YAAY,EAAE;MACpB;IACJ;IACA,MAAMP,UAAU,GAAG,IAAI,CAACO,YAAY,CAACP,UAAU,IAAI,IAAI,CAACU,gBAAgB,CAACD,GAAG,CAAC,CAAC;IAC9E,IAAI,CAACsB,aAAa,CAACxI,SAAS,CAAC;IAC7B,IAAI,CAAC0H,cAAc,CAACsD,OAAO,GAAG,IAAIzQ,GAAG,CAAC+B,SAAS,CAACuO,QAAQ,EAAEA,QAAQ,CAAC;IACnE,IAAI,CAACnD,cAAc,CAAC0G,mBAAmB,CAAC,CAAC;IACzC,IAAI,CAACjH,gBAAgB,CAAC5D,GAAG,CAAC,KAAK,CAAC;IAChC,IAAI,CAACzH,OAAO,CAACuP,mBAAmB,CAAC,IAAI,CAAC;IACtC,IAAI5E,UAAU,EAAE;MACZ,IAAI,CAAC3K,OAAO,CAACiE,KAAK,CAAC,CAAC;IACxB;EACJ;EACAsO,gCAAgCA,CAAA,EAAG;IAC/B;IACA,MAAMC,UAAU,GAAG,IAAI,CAACxS,OAAO,CAAC2R,aAAa,CAAC,CAAC;IAC/C,IAAI,CAAC/F,cAAc,CAACyD,MAAM,CAACmD,UAAU,CAACtF,MAAM,EAAEsF,UAAU,CAACvF,KAAK,CAAC;IAC/D,IAAI,CAACO,yBAAyB,CAAC,MAAM,EAAE,MAAM,CAAC;EAClD;EACAiF,8BAA8BA,CAACvF,MAAM,EAAE;IACnC,IAAIlC,EAAE;IACN,MAAMc,gBAAgB,GAAG,IAAI,CAACP,MAAM,CAACO,gBAAgB;IACrD,MAAMwB,eAAe,GAAG,IAAI,CAAC/B,MAAM,CAAC+B,eAAe;IACnD,MAAM0B,kBAAkB,GAAG,CAAChE,EAAE,GAAG,IAAI,CAACiE,2BAA2B,CAAC,CAAC,MAAM,IAAI,IAAIjE,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG+D,QAAQ;IAC9G,IAAI,CAACxB,8BAA8B,CAAC9O,GAAG,CAACiU,aAAa,CAAC5G,gBAAgB,CAAC,EAAEvC,IAAI,CAACE,GAAG,CAACuF,kBAAkB,EAAE9B,MAAM,CAAC,CAAC;IAC9G,IAAI,CAACG,6BAA6B,CAAC5O,GAAG,CAACiU,aAAa,CAACpF,eAAe,CAAC,EAAE/D,IAAI,CAACE,GAAG,CAACuF,kBAAkB,EAAE9B,MAAM,GAAGpC,eAAe,CAAC,CAAC;EAClI;EACApE,oBAAoBA,CAACC,UAAU,EAAE;IAC7B,IAAI,CAACiF,cAAc,CAAC+G,OAAO,GAAGhM,UAAU;EAC5C;EACAF,iBAAiBA,CAAA,EAAG;IAChB,IAAIuE,EAAE;IACN,IAAI,CAACuH,gCAAgC,CAAC,CAAC;IACvC,MAAMzG,gBAAgB,GAAG,IAAI,CAACP,MAAM,CAACO,gBAAgB;IACrD,IAAIoB,MAAM,GAAGzO,GAAG,CAAC0T,cAAc,CAACrG,gBAAgB,CAAC;IACjD,IAAImB,KAAK,GAAGxO,GAAG,CAACiU,aAAa,CAAC5G,gBAAgB,CAAC;IAC/C,IAAI,CAACF,cAAc,CAACyD,MAAM,CAACnC,MAAM,EAAED,KAAK,CAAC;IACzC,IAAI,CAACO,yBAAyB,CAACP,KAAK,EAAEC,MAAM,CAAC;IAC7CA,MAAM,GAAGzO,GAAG,CAAC0T,cAAc,CAACrG,gBAAgB,CAAC;IAC7CmB,KAAK,GAAGxO,GAAG,CAACiU,aAAa,CAAC5G,gBAAgB,CAAC;IAC3C,IAAI,CAACF,cAAc,CAACyD,MAAM,CAACnC,MAAM,EAAED,KAAK,CAAC;IACzC,IAAI,IAAI,CAACc,uBAAuB,CAAC,CAAC,EAAE;MAChC,IAAI,CAACM,4BAA4B,CAAC,CAAC;MACnC,IAAI,CAACoE,8BAA8B,CAACvF,MAAM,CAAC;IAC/C;IACA,IAAI,CAAClC,EAAE,GAAG,IAAI,CAACE,YAAY,MAAM,IAAI,IAAIF,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACrF,cAAc,EAAE;MACjF,MAAMuM,YAAY,GAAGzT,GAAG,CAAC0T,cAAc,CAAC,IAAI,CAAC5G,MAAM,CAACO,gBAAgB,CAAC;MACrE,IAAI,CAAC2D,mBAAmB,GAAG,IAAI,CAAC4C,uBAAuB,CAACH,YAAY,EAAE,IAAI,CAAChH,YAAY,CAACvF,cAAc,CAAC;IAC3G;IACA,IAAI,CAAC8H,oBAAoB,CAAC,CAAC;EAC/B;EACAxJ,KAAKA,CAAA,EAAG;IACJ,IAAI,CAACsH,MAAM,CAACO,gBAAgB,CAAC7H,KAAK,CAAC,CAAC;EACxC;EACA0F,QAAQA,CAAA,EAAG;IACP,MAAMiJ,SAAS,GAAG,IAAI,CAACrH,MAAM,CAAC0C,SAAS,CAAC4E,iBAAiB,CAAC,CAAC,CAACD,SAAS;IACrE,MAAME,QAAQ,GAAG,IAAI,CAAC9S,OAAO,CAACK,SAAS,CAAC,EAAE,CAAC,2BAA2B,CAAC;IACvE,IAAI,CAACkL,MAAM,CAAC0C,SAAS,CAAC8E,iBAAiB,CAAC;MAAEH,SAAS,EAAEA,SAAS,GAAGE,QAAQ,CAAC5B;IAAW,CAAC,CAAC;EAC3F;EACAtH,UAAUA,CAAA,EAAG;IACT,MAAMgJ,SAAS,GAAG,IAAI,CAACrH,MAAM,CAAC0C,SAAS,CAAC4E,iBAAiB,CAAC,CAAC,CAACD,SAAS;IACrE,MAAME,QAAQ,GAAG,IAAI,CAAC9S,OAAO,CAACK,SAAS,CAAC,EAAE,CAAC,2BAA2B,CAAC;IACvE,IAAI,CAACkL,MAAM,CAAC0C,SAAS,CAAC8E,iBAAiB,CAAC;MAAEH,SAAS,EAAEA,SAAS,GAAGE,QAAQ,CAAC5B;IAAW,CAAC,CAAC;EAC3F;EACArH,UAAUA,CAAA,EAAG;IACT,MAAMA,UAAU,GAAG,IAAI,CAAC0B,MAAM,CAAC0C,SAAS,CAAC4E,iBAAiB,CAAC,CAAC,CAAChJ,UAAU;IACvE,IAAI,CAAC0B,MAAM,CAAC0C,SAAS,CAAC8E,iBAAiB,CAAC;MAAElJ,UAAU,EAAEA,UAAU,GAAGgB;IAAwB,CAAC,CAAC;EACjG;EACAf,WAAWA,CAAA,EAAG;IACV,MAAMD,UAAU,GAAG,IAAI,CAAC0B,MAAM,CAAC0C,SAAS,CAAC4E,iBAAiB,CAAC,CAAC,CAAChJ,UAAU;IACvE,IAAI,CAAC0B,MAAM,CAAC0C,SAAS,CAAC8E,iBAAiB,CAAC;MAAElJ,UAAU,EAAEA,UAAU,GAAGgB;IAAwB,CAAC,CAAC;EACjG;EACAd,MAAMA,CAAA,EAAG;IACL,MAAM6I,SAAS,GAAG,IAAI,CAACrH,MAAM,CAAC0C,SAAS,CAAC4E,iBAAiB,CAAC,CAAC,CAACD,SAAS;IACrE,MAAMI,YAAY,GAAG,IAAI,CAACzH,MAAM,CAAC0C,SAAS,CAACC,mBAAmB,CAAC,CAAC,CAAChB,MAAM;IACvE,IAAI,CAAC3B,MAAM,CAAC0C,SAAS,CAAC8E,iBAAiB,CAAC;MAAEH,SAAS,EAAEA,SAAS,GAAGI;IAAa,CAAC,CAAC;EACpF;EACAhJ,QAAQA,CAAA,EAAG;IACP,MAAM4I,SAAS,GAAG,IAAI,CAACrH,MAAM,CAAC0C,SAAS,CAAC4E,iBAAiB,CAAC,CAAC,CAACD,SAAS;IACrE,MAAMI,YAAY,GAAG,IAAI,CAACzH,MAAM,CAAC0C,SAAS,CAACC,mBAAmB,CAAC,CAAC,CAAChB,MAAM;IACvE,IAAI,CAAC3B,MAAM,CAAC0C,SAAS,CAAC8E,iBAAiB,CAAC;MAAEH,SAAS,EAAEA,SAAS,GAAGI;IAAa,CAAC,CAAC;EACpF;EACA/I,OAAOA,CAAA,EAAG;IACN,IAAI,CAACsB,MAAM,CAAC0C,SAAS,CAAC8E,iBAAiB,CAAC;MAAEH,SAAS,EAAE;IAAE,CAAC,CAAC;EAC7D;EACA1I,UAAUA,CAAA,EAAG;IACT,IAAI,CAACqB,MAAM,CAAC0C,SAAS,CAAC8E,iBAAiB,CAAC;MAAEH,SAAS,EAAE,IAAI,CAACrH,MAAM,CAAC0C,SAAS,CAACC,mBAAmB,CAAC,CAAC,CAAC8E;IAAa,CAAC,CAAC;EACpH;AACJ,CAAC;AACDpS,kBAAkB,CAACkM,EAAE,GAAG,4CAA4C;AACpElM,kBAAkB,CAACwO,eAAe,GAAG,IAAI3Q,GAAG,CAAC+B,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;AAC5DI,kBAAkB,GAAGtD,UAAU,CAAC,CAC5BgB,OAAO,CAAC,CAAC,EAAEqB,kBAAkB,CAAC,CACjC,EAAEiB,kBAAkB,CAAC;AACtB,SAASA,kBAAkB;AAC3B,IAAIsF,oBAAoB,GAAG,MAAMA,oBAAoB,SAASrH,UAAU,CAAC;EACrE,IAAIsI,UAAUA,CAAA,EAAG;IACb,OAAO,IAAI,CAAC8L,WAAW;EAC3B;EACAlT,WAAWA,CAACG,kBAAkB,EAAE;IAC5B,KAAK,CAAC,CAAC;IACP,IAAI,CAACA,kBAAkB,GAAGA,kBAAkB;IAC5C,IAAI,CAAC+S,WAAW,GAAG,KAAK;IACxB,IAAI,CAAC5L,YAAY,GAAGxH,CAAC,CAAC,0BAA0B,CAAC;IACjD,IAAI,CAACqT,cAAc,GAAGzU,GAAG,CAACkN,MAAM,CAAC,IAAI,CAACtE,YAAY,EAAExH,CAAC,CAAC,aAAa,CAAC,CAAC;EACzE;EACAsT,SAASA,CAACC,aAAa,EAAE;IACrB,MAAMC,UAAU,GAAG,IAAI,CAACnT,kBAAkB,CAACoT,gBAAgB,CAACF,aAAa,CAACG,SAAS,CAAC;IACpF,MAAMC,eAAe,GAAGH,UAAU,GAAGA,UAAU,CAACI,QAAQ,CAAC,CAAC,GAAG,IAAI;IACjE,IAAI,CAACR,WAAW,GAAG,IAAI;IACvB,OAAO,IAAI,CAACvS,SAAS,CAAChC,WAAW,CAACmT,MAAM,CAAC,IAAI,CAACqB,cAAc,EAAEE,aAAa,EAAEI,eAAe,CAAC,CAAC;EAClG;EACA7H,MAAMA,CAAC+H,OAAO,EAAE;IACZ,MAAMjS,MAAM,GAAGhD,GAAG,CAACkN,MAAM,CAAC,IAAI,CAACuH,cAAc,EAAEQ,OAAO,CAAC;IACvD,IAAI,CAACT,WAAW,GAAG,IAAI;IACvB,OAAOxR,MAAM;EACjB;AACJ,CAAC;AACDyE,oBAAoB,GAAG5I,UAAU,CAAC,CAC9BgB,OAAO,CAAC,CAAC,EAAEkB,kBAAkB,CAAC,CACjC,EAAE0G,oBAAoB,CAAC;AACxB,SAASA,oBAAoB;AAC7B,MAAM5E,oBAAoB,CAAC;EACvB,IAAII,MAAMA,CAAA,EAAG;IAAE,OAAO,IAAI,CAACiS,OAAO;EAAE;EACpC,IAAIjS,MAAMA,CAACI,KAAK,EAAE;IAAE,IAAI,CAAC6R,OAAO,GAAG7R,KAAK;EAAE;EAC1C,IAAI8C,WAAWA,CAAA,EAAG;IAAE,OAAO,IAAI,CAACgP,YAAY;EAAE;EAC9C,IAAIhP,WAAWA,CAAC9C,KAAK,EAAE;IAAE,IAAI,CAAC8R,YAAY,GAAG9R,KAAK;EAAE;EACpD,IAAIkC,MAAMA,CAAA,EAAG;IAAE,OAAO,IAAI,CAAC6P,OAAO;EAAE;EACpC,IAAI7P,MAAMA,CAAClC,KAAK,EAAE;IAAE,IAAI,CAAC+R,OAAO,GAAG/R,KAAK;EAAE;EAC1C,IAAI4C,2BAA2BA,CAAA,EAAG;IAAE,OAAO,IAAI,CAACoP,4BAA4B;EAAE;EAC9E,IAAIpP,2BAA2BA,CAAC5C,KAAK,EAAE;IAAE,IAAI,CAACgS,4BAA4B,GAAGhS,KAAK;EAAE;EACpF/B,WAAWA,CAACC,OAAO,EAAEa,aAAa,EAAE;IAChC,IAAI,CAACb,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACa,aAAa,GAAGA,aAAa;IAClC,IAAI,CAAC8S,OAAO,GAAG,IAAI;IACnB,IAAI,CAACC,YAAY,GAAG,KAAK;IACzB,IAAI,CAACC,OAAO,GAAG,CAAC,CAAC;IACjB,IAAI,CAACC,4BAA4B,GAAG,KAAK;EAC7C;EACA,OAAOC,mBAAmBA,CAAC5L,MAAM,EAAEzG,MAAM,EAAE;IACvC,IAAIA,MAAM,CAACsB,IAAI,KAAK,CAAC,CAAC,+BAA+B,CAACtB,MAAM,CAACsS,mBAAmB,EAAE;MAC9E,OAAO,EAAE;IACb;IACA,MAAMC,KAAK,GAAG9L,MAAM,CAAC+L,QAAQ,CAAC,CAAC;IAC/B,MAAMC,UAAU,GAAGzS,MAAM,CAACuB,KAAK,CAAC4F,eAAe;IAC/C,IAAIsL,UAAU,GAAGF,KAAK,CAACG,YAAY,CAAC,CAAC,EAAE;MACnC;MACA,OAAO,EAAE;IACb;IACA,MAAMC,SAAS,GAAGJ,KAAK,CAACK,gBAAgB,CAACH,UAAU,CAAC;IACpD,OAAOhM,MAAM,CAACoM,kBAAkB,CAACJ,UAAU,CAAC,CAAC1P,MAAM,CAAExG,CAAC,IAAK;MACvD,IAAIA,CAAC,CAACyJ,OAAO,CAAC8M,WAAW,EAAE;QACvB,OAAO,IAAI;MACf;MACA,MAAMrL,WAAW,GAAIlL,CAAC,CAACgF,KAAK,CAAC4F,eAAe,KAAKsL,UAAU,GAAIlW,CAAC,CAACgF,KAAK,CAACkG,WAAW,GAAG,CAAC;MACtF,MAAMsL,SAAS,GAAIxW,CAAC,CAACgF,KAAK,CAACqG,aAAa,KAAK6K,UAAU,GAAIlW,CAAC,CAACgF,KAAK,CAACwR,SAAS,GAAGJ,SAAS;MACxF,IAAIpW,CAAC,CAACyJ,OAAO,CAACgN,eAAe,EAAE;QAC3B;QACA,IAAIvL,WAAW,GAAGzH,MAAM,CAACuB,KAAK,CAACkG,WAAW,GAAG,CAAC,IAAIzH,MAAM,CAACuB,KAAK,CAACwR,SAAS,GAAG,CAAC,GAAGA,SAAS,EAAE;UACtF,OAAO,KAAK;QAChB;MACJ,CAAC,MACI;QACD,IAAItL,WAAW,GAAGzH,MAAM,CAACuB,KAAK,CAACkG,WAAW,IAAIzH,MAAM,CAACuB,KAAK,CAACwR,SAAS,GAAGA,SAAS,EAAE;UAC9E,OAAO,KAAK;QAChB;MACJ;MACA,OAAO,IAAI;IACf,CAAC,CAAC;EACN;EACAE,YAAYA,CAACC,KAAK,EAAE;IAChB,MAAMlT,MAAM,GAAG,IAAI,CAACiS,OAAO;IAC3B,IAAI,CAAC,IAAI,CAAC3T,OAAO,CAACsI,QAAQ,CAAC,CAAC,IAAI,CAAC5G,MAAM,EAAE;MACrC,OAAOjC,mBAAmB,CAACoV,KAAK;IACpC;IACA,MAAMC,eAAe,GAAGxT,oBAAoB,CAACyS,mBAAmB,CAAC,IAAI,CAAC/T,OAAO,EAAE0B,MAAM,CAAC;IACtF,OAAOjC,mBAAmB,CAACsV,KAAK,CAAC,IAAI,CAAClU,aAAa,CAACmU,GAAG,CAAElU,WAAW,IAAK;MACrE,IAAI,CAACA,WAAW,CAAC6T,YAAY,EAAE;QAC3B,OAAOlV,mBAAmB,CAACoV,KAAK;MACpC;MACA,OAAO/T,WAAW,CAAC6T,YAAY,CAACjT,MAAM,EAAEoT,eAAe,EAAEF,KAAK,CAAC;IACnE,CAAC,CAAC,CAAC;EACP;EACAK,WAAWA,CAAA,EAAG;IACV,IAAI,CAAC,IAAI,CAACjV,OAAO,CAACsI,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAACqL,OAAO,EAAE;MAC3C,OAAO,EAAE;IACb;IACA,MAAMmB,eAAe,GAAGxT,oBAAoB,CAACyS,mBAAmB,CAAC,IAAI,CAAC/T,OAAO,EAAE,IAAI,CAAC2T,OAAO,CAAC;IAC5F,IAAIlS,MAAM,GAAG,EAAE;IACf,KAAK,MAAMX,WAAW,IAAI,IAAI,CAACD,aAAa,EAAE;MAC1CY,MAAM,GAAGA,MAAM,CAACiE,MAAM,CAAC5E,WAAW,CAACmU,WAAW,CAAC,IAAI,CAACtB,OAAO,EAAEmB,eAAe,CAAC,CAAC;IAClF;IACA,OAAOlW,QAAQ,CAAC6C,MAAM,CAAC;EAC3B;AACJ;AACA,SAASiP,mCAAmCA,CAACwE,MAAM,EAAEC,MAAM,EAAExE,IAAI,EAAEC,GAAG,EAAE3D,KAAK,EAAEC,MAAM,EAAE;EACnF,MAAMkI,CAAC,GAAIzE,IAAI,GAAG1D,KAAK,GAAG,CAAE,CAAC,CAAC;EAC9B,MAAMoI,CAAC,GAAIzE,GAAG,GAAG1D,MAAM,GAAG,CAAE,CAAC,CAAC;EAC9B,MAAMoI,EAAE,GAAG/L,IAAI,CAACC,GAAG,CAACD,IAAI,CAACgM,GAAG,CAACL,MAAM,GAAGE,CAAC,CAAC,GAAGnI,KAAK,GAAG,CAAC,EAAE,CAAC,CAAC;EACxD,MAAMuI,EAAE,GAAGjM,IAAI,CAACC,GAAG,CAACD,IAAI,CAACgM,GAAG,CAACJ,MAAM,GAAGE,CAAC,CAAC,GAAGnI,MAAM,GAAG,CAAC,EAAE,CAAC,CAAC;EACzD,OAAO3D,IAAI,CAACkM,IAAI,CAACH,EAAE,GAAGA,EAAE,GAAGE,EAAE,GAAGA,EAAE,CAAC;AACvC"},"metadata":{},"sourceType":"module","externalDependencies":[]}