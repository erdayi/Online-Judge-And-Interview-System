{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { withNullAsUndefined } from '../../../../../base/common/types.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../../common/model/textModel.js';\nlet GotoDefinitionAtPositionEditorContribution = class GotoDefinitionAtPositionEditorContribution {\n  constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n    this.textModelResolverService = textModelResolverService;\n    this.languageService = languageService;\n    this.languageFeaturesService = languageFeaturesService;\n    this.toUnhook = new DisposableStore();\n    this.toUnhookForKeyboard = new DisposableStore();\n    this.currentWordAtPosition = null;\n    this.previousPromise = null;\n    this.editor = editor;\n    this.linkDecorations = this.editor.createDecorationsCollection();\n    const linkGesture = new ClickLinkGesture(editor);\n    this.toUnhook.add(linkGesture);\n    this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n      this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\n    }));\n    this.toUnhook.add(linkGesture.onExecute(mouseEvent => {\n      if (this.isEnabled(mouseEvent)) {\n        this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier).catch(error => {\n          onUnexpectedError(error);\n        }).finally(() => {\n          this.removeLinkDecorations();\n        });\n      }\n    }));\n    this.toUnhook.add(linkGesture.onCancel(() => {\n      this.removeLinkDecorations();\n      this.currentWordAtPosition = null;\n    }));\n  }\n  static get(editor) {\n    return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\n  }\n  startFindDefinitionFromCursor(position) {\n    return __awaiter(this, void 0, void 0, function* () {\n      // For issue: https://github.com/microsoft/vscode/issues/46257\n      // equivalent to mouse move with meta/ctrl key\n      // First find the definition and add decorations\n      // to the editor to be shown with the content hover widget\n      yield this.startFindDefinition(position);\n      // Add listeners for editor cursor move and key down events\n      // Dismiss the \"extended\" editor decorations when the user hides\n      // the hover widget. There is no event for the widget itself so these\n      // serve as a best effort. After removing the link decorations, the hover\n      // widget is clean and will only show declarations per next request.\n      this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n        this.currentWordAtPosition = null;\n        this.removeLinkDecorations();\n        this.toUnhookForKeyboard.clear();\n      }));\n      this.toUnhookForKeyboard.add(this.editor.onKeyDown(e => {\n        if (e) {\n          this.currentWordAtPosition = null;\n          this.removeLinkDecorations();\n          this.toUnhookForKeyboard.clear();\n        }\n      }));\n    });\n  }\n  startFindDefinitionFromMouse(mouseEvent, withKey) {\n    // check if we are active and on a content widget\n    if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n      return;\n    }\n    if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n      this.currentWordAtPosition = null;\n      this.removeLinkDecorations();\n      return;\n    }\n    const position = mouseEvent.target.position;\n    this.startFindDefinition(position);\n  }\n  startFindDefinition(position) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function* () {\n      // Dispose listeners for updating decorations when using keyboard to show definition hover\n      this.toUnhookForKeyboard.clear();\n      // Find word at mouse position\n      const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n      if (!word) {\n        this.currentWordAtPosition = null;\n        this.removeLinkDecorations();\n        return;\n      }\n      // Return early if word at position is still the same\n      if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n        return;\n      }\n      this.currentWordAtPosition = word;\n      // Find definition and decorate word if found\n      const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n      if (this.previousPromise) {\n        this.previousPromise.cancel();\n        this.previousPromise = null;\n      }\n      this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n      let results;\n      try {\n        results = yield this.previousPromise;\n      } catch (error) {\n        onUnexpectedError(error);\n        return;\n      }\n      if (!results || !results.length || !state.validate(this.editor)) {\n        this.removeLinkDecorations();\n        return;\n      }\n      const linkRange = results[0].originSelectionRange ? Range.lift(results[0].originSelectionRange) : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n      // Multiple results\n      if (results.length > 1) {\n        let combinedRange = linkRange;\n        for (const {\n          originSelectionRange\n        } of results) {\n          if (originSelectionRange) {\n            combinedRange = Range.plusRange(combinedRange, originSelectionRange);\n          }\n        }\n        this.addDecoration(combinedRange, new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n      } else {\n        // Single result\n        const result = results[0];\n        if (!result.uri) {\n          return;\n        }\n        this.textModelResolverService.createModelReference(result.uri).then(ref => {\n          if (!ref.object || !ref.object.textEditorModel) {\n            ref.dispose();\n            return;\n          }\n          const {\n            object: {\n              textEditorModel\n            }\n          } = ref;\n          const {\n            startLineNumber\n          } = result.range;\n          if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n            // invalid range\n            ref.dispose();\n            return;\n          }\n          const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n          const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n          this.addDecoration(linkRange, previewValue ? new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue) : undefined);\n          ref.dispose();\n        });\n      }\n    });\n  }\n  getPreviewValue(textEditorModel, startLineNumber, result) {\n    let rangeToUse = result.range;\n    const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n    if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\n      rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n    }\n    const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n    return previewValue;\n  }\n  stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n    const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n    let minIndent = startIndent;\n    for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n      const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n      minIndent = Math.min(minIndent, endIndent);\n    }\n    const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n    return previewValue;\n  }\n  getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n    const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n    const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n    let endLineNumber = startLineNumber + 1;\n    for (; endLineNumber < maxLineNumber; endLineNumber++) {\n      const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n      if (startIndent === endIndent) {\n        break;\n      }\n    }\n    return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n  }\n  addDecoration(range, hoverMessage) {\n    const newDecorations = {\n      range: range,\n      options: {\n        description: 'goto-definition-link',\n        inlineClassName: 'goto-definition-link',\n        hoverMessage\n      }\n    };\n    this.linkDecorations.set([newDecorations]);\n  }\n  removeLinkDecorations() {\n    this.linkDecorations.clear();\n  }\n  isEnabled(mouseEvent, withKey) {\n    var _a;\n    return this.editor.hasModel() && mouseEvent.isLeftClick && mouseEvent.isNoneOrSingleMouseDown && mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */ && !(((_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options) instanceof ModelDecorationInjectedTextOptions) && (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false)) && this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n  }\n  findDefinition(position, token) {\n    const model = this.editor.getModel();\n    if (!model) {\n      return Promise.resolve(null);\n    }\n    return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, token);\n  }\n  gotoDefinition(position, openToSide) {\n    this.editor.setPosition(position);\n    return this.editor.invokeWithinContext(accessor => {\n      const canPeek = !openToSide && this.editor.getOption(86 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n      const action = new DefinitionAction({\n        openToSide,\n        openInPeek: canPeek,\n        muteMessage: true\n      }, {\n        title: {\n          value: '',\n          original: ''\n        },\n        id: '',\n        precondition: undefined\n      });\n      return action.run(accessor);\n    });\n  }\n  isInPeekEditor(accessor) {\n    const contextKeyService = accessor.get(IContextKeyService);\n    return PeekContext.inPeekEditor.getValue(contextKeyService);\n  }\n  dispose() {\n    this.toUnhook.dispose();\n    this.toUnhookForKeyboard.dispose();\n  }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = __decorate([__param(1, ITextModelService), __param(2, ILanguageService), __param(3, ILanguageFeaturesService)], GotoDefinitionAtPositionEditorContribution);\nexport { GotoDefinitionAtPositionEditorContribution };\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","createCancelablePromise","onUnexpectedError","MarkdownString","DisposableStore","withNullAsUndefined","EditorState","registerEditorContribution","Range","ILanguageService","ITextModelService","ClickLinkGesture","PeekContext","nls","IContextKeyService","DefinitionAction","getDefinitionsAtPosition","ILanguageFeaturesService","ModelDecorationInjectedTextOptions","GotoDefinitionAtPositionEditorContribution","constructor","editor","textModelResolverService","languageService","languageFeaturesService","toUnhook","toUnhookForKeyboard","currentWordAtPosition","previousPromise","linkDecorations","createDecorationsCollection","linkGesture","add","onMouseMoveOrRelevantKeyDown","mouseEvent","keyboardEvent","startFindDefinitionFromMouse","onExecute","isEnabled","gotoDefinition","position","hasSideBySideModifier","catch","error","finally","removeLinkDecorations","onCancel","get","getContribution","ID","startFindDefinitionFromCursor","startFindDefinition","onDidChangeCursorPosition","clear","onKeyDown","withKey","type","hasModel","_a","word","getModel","getWordAtPosition","startColumn","endColumn","state","cancel","token","findDefinition","results","validate","linkRange","originSelectionRange","lift","lineNumber","combinedRange","plusRange","addDecoration","appendText","localize","uri","createModelReference","ref","object","textEditorModel","dispose","startLineNumber","range","getLineCount","previewValue","getPreviewValue","languageId","guessLanguageIdByFilepathOrFirstLine","appendCodeblock","undefined","rangeToUse","numberOfLinesInRange","endLineNumber","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","startIndent","getLineFirstNonWhitespaceColumn","minIndent","endIndent","Math","min","getValueInRange","replace","RegExp","trim","maxLineNumber","hoverMessage","newDecorations","options","description","inlineClassName","set","isLeftClick","isNoneOrSingleMouseDown","detail","injectedText","hasTriggerModifier","keyCodeIsTriggerKey","definitionProvider","has","model","openToSide","setPosition","invokeWithinContext","accessor","canPeek","getOption","isInPeekEditor","action","openInPeek","muteMessage","title","original","id","precondition","run","contextKeyService","inPeekEditor","getValue"],"sources":["D:/code/java/program/oj/code/yuoj-frontend-master/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { withNullAsUndefined } from '../../../../../base/common/types.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../../common/model/textModel.js';\nlet GotoDefinitionAtPositionEditorContribution = class GotoDefinitionAtPositionEditorContribution {\n    constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        this.linkDecorations = this.editor.createDecorationsCollection();\n        const linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier)\n                    .catch((error) => {\n                    onUnexpectedError(error);\n                })\n                    .finally(() => {\n                    this.removeLinkDecorations();\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\n    }\n    startFindDefinitionFromCursor(position) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // For issue: https://github.com/microsoft/vscode/issues/46257\n            // equivalent to mouse move with meta/ctrl key\n            // First find the definition and add decorations\n            // to the editor to be shown with the content hover widget\n            yield this.startFindDefinition(position);\n            // Add listeners for editor cursor move and key down events\n            // Dismiss the \"extended\" editor decorations when the user hides\n            // the hover widget. There is no event for the widget itself so these\n            // serve as a best effort. After removing the link decorations, the hover\n            // widget is clean and will only show declarations per next request.\n            this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }));\n            this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n                if (e) {\n                    this.currentWordAtPosition = null;\n                    this.removeLinkDecorations();\n                    this.toUnhookForKeyboard.clear();\n                }\n            }));\n        });\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    startFindDefinition(position) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // Dispose listeners for updating decorations when using keyboard to show definition hover\n            this.toUnhookForKeyboard.clear();\n            // Find word at mouse position\n            const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n            if (!word) {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                return;\n            }\n            // Return early if word at position is still the same\n            if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n                return;\n            }\n            this.currentWordAtPosition = word;\n            // Find definition and decorate word if found\n            const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n            if (this.previousPromise) {\n                this.previousPromise.cancel();\n                this.previousPromise = null;\n            }\n            this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n            let results;\n            try {\n                results = yield this.previousPromise;\n            }\n            catch (error) {\n                onUnexpectedError(error);\n                return;\n            }\n            if (!results || !results.length || !state.validate(this.editor)) {\n                this.removeLinkDecorations();\n                return;\n            }\n            const linkRange = results[0].originSelectionRange\n                ? Range.lift(results[0].originSelectionRange)\n                : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n            // Multiple results\n            if (results.length > 1) {\n                let combinedRange = linkRange;\n                for (const { originSelectionRange } of results) {\n                    if (originSelectionRange) {\n                        combinedRange = Range.plusRange(combinedRange, originSelectionRange);\n                    }\n                }\n                this.addDecoration(combinedRange, new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n            }\n            else {\n                // Single result\n                const result = results[0];\n                if (!result.uri) {\n                    return;\n                }\n                this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                    if (!ref.object || !ref.object.textEditorModel) {\n                        ref.dispose();\n                        return;\n                    }\n                    const { object: { textEditorModel } } = ref;\n                    const { startLineNumber } = result.range;\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                        // invalid range\n                        ref.dispose();\n                        return;\n                    }\n                    const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                    const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                    this.addDecoration(linkRange, previewValue ? new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue) : undefined);\n                    ref.dispose();\n                });\n            }\n        });\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.range;\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations.set([newDecorations]);\n    }\n    removeLinkDecorations() {\n        this.linkDecorations.clear();\n    }\n    isEnabled(mouseEvent, withKey) {\n        var _a;\n        return this.editor.hasModel()\n            && mouseEvent.isLeftClick\n            && mouseEvent.isNoneOrSingleMouseDown\n            && mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */\n            && !(((_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options) instanceof ModelDecorationInjectedTextOptions)\n            && (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false))\n            && this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(86 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n            return action.run(accessor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n        this.toUnhookForKeyboard.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService),\n    __param(3, ILanguageFeaturesService)\n], GotoDefinitionAtPositionEditorContribution);\nexport { GotoDefinitionAtPositionEditorContribution };\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}