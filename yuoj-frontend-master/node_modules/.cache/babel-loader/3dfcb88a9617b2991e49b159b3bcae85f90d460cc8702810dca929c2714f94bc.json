{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { getDomNodePagePosition } from '../../../../base/browser/dom.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ApplyCodeActionReason, applyCodeAction } from './codeAction.js';\nimport { CodeActionKeybindingResolver } from './codeActionKeybindingResolver.js';\nimport { toMenuItems } from './codeActionMenu.js';\nimport { LightBulbWidget } from './lightBulbWidget.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { localize } from '../../../../nls.js';\nimport { IActionWidgetService } from '../../../../platform/actionWidget/browser/actionWidget.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService } from '../../../../platform/markers/common/markers.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { CodeActionTriggerSource } from '../common/types.js';\nimport { CodeActionModel } from './codeActionModel.js';\nlet CodeActionController = class CodeActionController extends Disposable {\n  static get(editor) {\n    return editor.getContribution(CodeActionController.ID);\n  }\n  constructor(editor, markerService, contextKeyService, instantiationService, languageFeaturesService, progressService, _commandService, _configurationService, _actionWidgetService, _instantiationService) {\n    super();\n    this._commandService = _commandService;\n    this._configurationService = _configurationService;\n    this._actionWidgetService = _actionWidgetService;\n    this._instantiationService = _instantiationService;\n    this._activeCodeActions = this._register(new MutableDisposable());\n    this._showDisabled = false;\n    this._disposed = false;\n    this._editor = editor;\n    this._model = this._register(new CodeActionModel(this._editor, languageFeaturesService.codeActionProvider, markerService, contextKeyService, progressService));\n    this._register(this._model.onDidChangeState(newState => this.update(newState)));\n    this._lightBulbWidget = new Lazy(() => {\n      const widget = this._editor.getContribution(LightBulbWidget.ID);\n      if (widget) {\n        this._register(widget.onClick(e => this.showCodeActionList(e.actions, e, {\n          includeDisabledActions: false,\n          fromLightbulb: true\n        })));\n      }\n      return widget;\n    });\n    this._resolver = instantiationService.createInstance(CodeActionKeybindingResolver);\n    this._register(this._editor.onDidLayoutChange(() => this._actionWidgetService.hide()));\n  }\n  dispose() {\n    this._disposed = true;\n    super.dispose();\n  }\n  showCodeActions(_trigger, actions, at) {\n    return this.showCodeActionList(actions, at, {\n      includeDisabledActions: false,\n      fromLightbulb: false\n    });\n  }\n  manualTriggerAtCurrentPosition(notAvailableMessage, triggerAction, filter, autoApply) {\n    var _a;\n    if (!this._editor.hasModel()) {\n      return;\n    }\n    (_a = MessageController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.closeMessage();\n    const triggerPosition = this._editor.getPosition();\n    this._trigger({\n      type: 1 /* CodeActionTriggerType.Invoke */,\n      triggerAction,\n      filter,\n      autoApply,\n      context: {\n        notAvailableMessage,\n        position: triggerPosition\n      }\n    });\n  }\n  _trigger(trigger) {\n    return this._model.trigger(trigger);\n  }\n  _applyCodeAction(action, retrigger, preview) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        yield this._instantiationService.invokeFunction(applyCodeAction, action, ApplyCodeActionReason.FromCodeActions, {\n          preview,\n          editor: this._editor\n        });\n      } finally {\n        if (retrigger) {\n          this._trigger({\n            type: 2 /* CodeActionTriggerType.Auto */,\n            triggerAction: CodeActionTriggerSource.QuickFix,\n            filter: {}\n          });\n        }\n      }\n    });\n  }\n  update(newState) {\n    var _a, _b, _c, _d, _e, _f, _g;\n    return __awaiter(this, void 0, void 0, function* () {\n      if (newState.type !== 1 /* CodeActionsState.Type.Triggered */) {\n        (_a = this._lightBulbWidget.rawValue) === null || _a === void 0 ? void 0 : _a.hide();\n        return;\n      }\n      let actions;\n      try {\n        actions = yield newState.actions;\n      } catch (e) {\n        onUnexpectedError(e);\n        return;\n      }\n      if (this._disposed) {\n        return;\n      }\n      (_b = this._lightBulbWidget.value) === null || _b === void 0 ? void 0 : _b.update(actions, newState.trigger, newState.position);\n      if (newState.trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n        if ((_c = newState.trigger.filter) === null || _c === void 0 ? void 0 : _c.include) {\n          // Triggered for specific scope\n          // Check to see if we want to auto apply.\n          const validActionToApply = this.tryGetValidActionToApply(newState.trigger, actions);\n          if (validActionToApply) {\n            try {\n              (_d = this._lightBulbWidget.value) === null || _d === void 0 ? void 0 : _d.hide();\n              yield this._applyCodeAction(validActionToApply, false, false);\n            } finally {\n              actions.dispose();\n            }\n            return;\n          }\n          // Check to see if there is an action that we would have applied were it not invalid\n          if (newState.trigger.context) {\n            const invalidAction = this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger, actions);\n            if (invalidAction && invalidAction.action.disabled) {\n              (_e = MessageController.get(this._editor)) === null || _e === void 0 ? void 0 : _e.showMessage(invalidAction.action.disabled, newState.trigger.context.position);\n              actions.dispose();\n              return;\n            }\n          }\n        }\n        const includeDisabledActions = !!((_f = newState.trigger.filter) === null || _f === void 0 ? void 0 : _f.include);\n        if (newState.trigger.context) {\n          if (!actions.allActions.length || !includeDisabledActions && !actions.validActions.length) {\n            (_g = MessageController.get(this._editor)) === null || _g === void 0 ? void 0 : _g.showMessage(newState.trigger.context.notAvailableMessage, newState.trigger.context.position);\n            this._activeCodeActions.value = actions;\n            actions.dispose();\n            return;\n          }\n        }\n        this._activeCodeActions.value = actions;\n        this.showCodeActionList(actions, this.toCoords(newState.position), {\n          includeDisabledActions,\n          fromLightbulb: false\n        });\n      } else {\n        // auto magically triggered\n        if (this._actionWidgetService.isVisible) {\n          // TODO: Figure out if we should update the showing menu?\n          actions.dispose();\n        } else {\n          this._activeCodeActions.value = actions;\n        }\n      }\n    });\n  }\n  getInvalidActionThatWouldHaveBeenApplied(trigger, actions) {\n    if (!actions.allActions.length) {\n      return undefined;\n    }\n    if (trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length === 0 || trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.allActions.length === 1) {\n      return actions.allActions.find(({\n        action\n      }) => action.disabled);\n    }\n    return undefined;\n  }\n  tryGetValidActionToApply(trigger, actions) {\n    if (!actions.validActions.length) {\n      return undefined;\n    }\n    if (trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length > 0 || trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.validActions.length === 1) {\n      return actions.validActions[0];\n    }\n    return undefined;\n  }\n  showCodeActionList(actions, at, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const editorDom = this._editor.getDomNode();\n      if (!editorDom) {\n        return;\n      }\n      const actionsToShow = options.includeDisabledActions && (this._showDisabled || actions.validActions.length === 0) ? actions.allActions : actions.validActions;\n      if (!actionsToShow.length) {\n        return;\n      }\n      const anchor = Position.isIPosition(at) ? this.toCoords(at) : at;\n      const delegate = {\n        onSelect: (action, preview) => __awaiter(this, void 0, void 0, function* () {\n          this._applyCodeAction(action, /* retrigger */true, !!preview);\n          this._actionWidgetService.hide();\n        }),\n        onHide: () => {\n          var _a;\n          (_a = this._editor) === null || _a === void 0 ? void 0 : _a.focus();\n        }\n      };\n      this._actionWidgetService.show('codeActionWidget', true, toMenuItems(actionsToShow, this._shouldShowHeaders(), this._resolver.getResolver()), delegate, anchor, editorDom, this._getActionBarActions(actions, at, options));\n    });\n  }\n  toCoords(position) {\n    if (!this._editor.hasModel()) {\n      return {\n        x: 0,\n        y: 0\n      };\n    }\n    this._editor.revealPosition(position, 1 /* ScrollType.Immediate */);\n    this._editor.render();\n    // Translate to absolute editor position\n    const cursorCoords = this._editor.getScrolledVisiblePosition(position);\n    const editorCoords = getDomNodePagePosition(this._editor.getDomNode());\n    const x = editorCoords.left + cursorCoords.left;\n    const y = editorCoords.top + cursorCoords.top + cursorCoords.height;\n    return {\n      x,\n      y\n    };\n  }\n  _shouldShowHeaders() {\n    var _a;\n    const model = (_a = this._editor) === null || _a === void 0 ? void 0 : _a.getModel();\n    return this._configurationService.getValue('editor.codeActionWidget.showHeaders', {\n      resource: model === null || model === void 0 ? void 0 : model.uri\n    });\n  }\n  _getActionBarActions(actions, at, options) {\n    if (options.fromLightbulb) {\n      return [];\n    }\n    const resultActions = actions.documentation.map(command => {\n      var _a;\n      return {\n        id: command.id,\n        label: command.title,\n        tooltip: (_a = command.tooltip) !== null && _a !== void 0 ? _a : '',\n        class: undefined,\n        enabled: true,\n        run: () => {\n          var _a;\n          return this._commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : []));\n        }\n      };\n    });\n    if (options.includeDisabledActions && actions.validActions.length > 0 && actions.allActions.length !== actions.validActions.length) {\n      resultActions.push(this._showDisabled ? {\n        id: 'hideMoreActions',\n        label: localize('hideMoreActions', 'Hide Disabled'),\n        enabled: true,\n        tooltip: '',\n        class: undefined,\n        run: () => {\n          this._showDisabled = false;\n          return this.showCodeActionList(actions, at, options);\n        }\n      } : {\n        id: 'showMoreActions',\n        label: localize('showMoreActions', 'Show Disabled'),\n        enabled: true,\n        tooltip: '',\n        class: undefined,\n        run: () => {\n          this._showDisabled = true;\n          return this.showCodeActionList(actions, at, options);\n        }\n      });\n    }\n    return resultActions;\n  }\n};\nCodeActionController.ID = 'editor.contrib.codeActionController';\nCodeActionController = __decorate([__param(1, IMarkerService), __param(2, IContextKeyService), __param(3, IInstantiationService), __param(4, ILanguageFeaturesService), __param(5, IEditorProgressService), __param(6, ICommandService), __param(7, IConfigurationService), __param(8, IActionWidgetService), __param(9, IInstantiationService)], CodeActionController);\nexport { CodeActionController };","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","getDomNodePagePosition","onUnexpectedError","Lazy","Disposable","MutableDisposable","Position","ILanguageFeaturesService","ApplyCodeActionReason","applyCodeAction","CodeActionKeybindingResolver","toMenuItems","LightBulbWidget","MessageController","localize","IActionWidgetService","ICommandService","IConfigurationService","IContextKeyService","IInstantiationService","IMarkerService","IEditorProgressService","CodeActionTriggerSource","CodeActionModel","CodeActionController","get","editor","getContribution","ID","constructor","markerService","contextKeyService","instantiationService","languageFeaturesService","progressService","_commandService","_configurationService","_actionWidgetService","_instantiationService","_activeCodeActions","_register","_showDisabled","_disposed","_editor","_model","codeActionProvider","onDidChangeState","newState","update","_lightBulbWidget","widget","onClick","showCodeActionList","actions","includeDisabledActions","fromLightbulb","_resolver","createInstance","onDidLayoutChange","hide","dispose","showCodeActions","_trigger","at","manualTriggerAtCurrentPosition","notAvailableMessage","triggerAction","filter","autoApply","_a","hasModel","closeMessage","triggerPosition","getPosition","type","context","position","trigger","_applyCodeAction","action","retrigger","preview","invokeFunction","FromCodeActions","QuickFix","_b","_c","_d","_e","_f","_g","rawValue","include","validActionToApply","tryGetValidActionToApply","invalidAction","getInvalidActionThatWouldHaveBeenApplied","disabled","showMessage","allActions","validActions","toCoords","isVisible","undefined","find","options","editorDom","getDomNode","actionsToShow","anchor","isIPosition","delegate","onSelect","onHide","focus","show","_shouldShowHeaders","getResolver","_getActionBarActions","x","y","revealPosition","render","cursorCoords","getScrolledVisiblePosition","editorCoords","left","top","height","model","getModel","getValue","resource","uri","resultActions","documentation","map","command","id","label","title","tooltip","class","enabled","run","executeCommand","push"],"sources":["D:/code/java/program/oj/code/yuoj-frontend-master/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/browser/codeActionController.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { getDomNodePagePosition } from '../../../../base/browser/dom.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Lazy } from '../../../../base/common/lazy.js';\nimport { Disposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ApplyCodeActionReason, applyCodeAction } from './codeAction.js';\nimport { CodeActionKeybindingResolver } from './codeActionKeybindingResolver.js';\nimport { toMenuItems } from './codeActionMenu.js';\nimport { LightBulbWidget } from './lightBulbWidget.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { localize } from '../../../../nls.js';\nimport { IActionWidgetService } from '../../../../platform/actionWidget/browser/actionWidget.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService } from '../../../../platform/markers/common/markers.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { CodeActionTriggerSource } from '../common/types.js';\nimport { CodeActionModel } from './codeActionModel.js';\nlet CodeActionController = class CodeActionController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(CodeActionController.ID);\n    }\n    constructor(editor, markerService, contextKeyService, instantiationService, languageFeaturesService, progressService, _commandService, _configurationService, _actionWidgetService, _instantiationService) {\n        super();\n        this._commandService = _commandService;\n        this._configurationService = _configurationService;\n        this._actionWidgetService = _actionWidgetService;\n        this._instantiationService = _instantiationService;\n        this._activeCodeActions = this._register(new MutableDisposable());\n        this._showDisabled = false;\n        this._disposed = false;\n        this._editor = editor;\n        this._model = this._register(new CodeActionModel(this._editor, languageFeaturesService.codeActionProvider, markerService, contextKeyService, progressService));\n        this._register(this._model.onDidChangeState(newState => this.update(newState)));\n        this._lightBulbWidget = new Lazy(() => {\n            const widget = this._editor.getContribution(LightBulbWidget.ID);\n            if (widget) {\n                this._register(widget.onClick(e => this.showCodeActionList(e.actions, e, { includeDisabledActions: false, fromLightbulb: true })));\n            }\n            return widget;\n        });\n        this._resolver = instantiationService.createInstance(CodeActionKeybindingResolver);\n        this._register(this._editor.onDidLayoutChange(() => this._actionWidgetService.hide()));\n    }\n    dispose() {\n        this._disposed = true;\n        super.dispose();\n    }\n    showCodeActions(_trigger, actions, at) {\n        return this.showCodeActionList(actions, at, { includeDisabledActions: false, fromLightbulb: false });\n    }\n    manualTriggerAtCurrentPosition(notAvailableMessage, triggerAction, filter, autoApply) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        (_a = MessageController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.closeMessage();\n        const triggerPosition = this._editor.getPosition();\n        this._trigger({ type: 1 /* CodeActionTriggerType.Invoke */, triggerAction, filter, autoApply, context: { notAvailableMessage, position: triggerPosition } });\n    }\n    _trigger(trigger) {\n        return this._model.trigger(trigger);\n    }\n    _applyCodeAction(action, retrigger, preview) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this._instantiationService.invokeFunction(applyCodeAction, action, ApplyCodeActionReason.FromCodeActions, { preview, editor: this._editor });\n            }\n            finally {\n                if (retrigger) {\n                    this._trigger({ type: 2 /* CodeActionTriggerType.Auto */, triggerAction: CodeActionTriggerSource.QuickFix, filter: {} });\n                }\n            }\n        });\n    }\n    update(newState) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (newState.type !== 1 /* CodeActionsState.Type.Triggered */) {\n                (_a = this._lightBulbWidget.rawValue) === null || _a === void 0 ? void 0 : _a.hide();\n                return;\n            }\n            let actions;\n            try {\n                actions = yield newState.actions;\n            }\n            catch (e) {\n                onUnexpectedError(e);\n                return;\n            }\n            if (this._disposed) {\n                return;\n            }\n            (_b = this._lightBulbWidget.value) === null || _b === void 0 ? void 0 : _b.update(actions, newState.trigger, newState.position);\n            if (newState.trigger.type === 1 /* CodeActionTriggerType.Invoke */) {\n                if ((_c = newState.trigger.filter) === null || _c === void 0 ? void 0 : _c.include) { // Triggered for specific scope\n                    // Check to see if we want to auto apply.\n                    const validActionToApply = this.tryGetValidActionToApply(newState.trigger, actions);\n                    if (validActionToApply) {\n                        try {\n                            (_d = this._lightBulbWidget.value) === null || _d === void 0 ? void 0 : _d.hide();\n                            yield this._applyCodeAction(validActionToApply, false, false);\n                        }\n                        finally {\n                            actions.dispose();\n                        }\n                        return;\n                    }\n                    // Check to see if there is an action that we would have applied were it not invalid\n                    if (newState.trigger.context) {\n                        const invalidAction = this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger, actions);\n                        if (invalidAction && invalidAction.action.disabled) {\n                            (_e = MessageController.get(this._editor)) === null || _e === void 0 ? void 0 : _e.showMessage(invalidAction.action.disabled, newState.trigger.context.position);\n                            actions.dispose();\n                            return;\n                        }\n                    }\n                }\n                const includeDisabledActions = !!((_f = newState.trigger.filter) === null || _f === void 0 ? void 0 : _f.include);\n                if (newState.trigger.context) {\n                    if (!actions.allActions.length || !includeDisabledActions && !actions.validActions.length) {\n                        (_g = MessageController.get(this._editor)) === null || _g === void 0 ? void 0 : _g.showMessage(newState.trigger.context.notAvailableMessage, newState.trigger.context.position);\n                        this._activeCodeActions.value = actions;\n                        actions.dispose();\n                        return;\n                    }\n                }\n                this._activeCodeActions.value = actions;\n                this.showCodeActionList(actions, this.toCoords(newState.position), { includeDisabledActions, fromLightbulb: false });\n            }\n            else {\n                // auto magically triggered\n                if (this._actionWidgetService.isVisible) {\n                    // TODO: Figure out if we should update the showing menu?\n                    actions.dispose();\n                }\n                else {\n                    this._activeCodeActions.value = actions;\n                }\n            }\n        });\n    }\n    getInvalidActionThatWouldHaveBeenApplied(trigger, actions) {\n        if (!actions.allActions.length) {\n            return undefined;\n        }\n        if ((trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length === 0)\n            || (trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.allActions.length === 1)) {\n            return actions.allActions.find(({ action }) => action.disabled);\n        }\n        return undefined;\n    }\n    tryGetValidActionToApply(trigger, actions) {\n        if (!actions.validActions.length) {\n            return undefined;\n        }\n        if ((trigger.autoApply === \"first\" /* CodeActionAutoApply.First */ && actions.validActions.length > 0)\n            || (trigger.autoApply === \"ifSingle\" /* CodeActionAutoApply.IfSingle */ && actions.validActions.length === 1)) {\n            return actions.validActions[0];\n        }\n        return undefined;\n    }\n    showCodeActionList(actions, at, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const editorDom = this._editor.getDomNode();\n            if (!editorDom) {\n                return;\n            }\n            const actionsToShow = options.includeDisabledActions && (this._showDisabled || actions.validActions.length === 0) ? actions.allActions : actions.validActions;\n            if (!actionsToShow.length) {\n                return;\n            }\n            const anchor = Position.isIPosition(at) ? this.toCoords(at) : at;\n            const delegate = {\n                onSelect: (action, preview) => __awaiter(this, void 0, void 0, function* () {\n                    this._applyCodeAction(action, /* retrigger */ true, !!preview);\n                    this._actionWidgetService.hide();\n                }),\n                onHide: () => {\n                    var _a;\n                    (_a = this._editor) === null || _a === void 0 ? void 0 : _a.focus();\n                }\n            };\n            this._actionWidgetService.show('codeActionWidget', true, toMenuItems(actionsToShow, this._shouldShowHeaders(), this._resolver.getResolver()), delegate, anchor, editorDom, this._getActionBarActions(actions, at, options));\n        });\n    }\n    toCoords(position) {\n        if (!this._editor.hasModel()) {\n            return { x: 0, y: 0 };\n        }\n        this._editor.revealPosition(position, 1 /* ScrollType.Immediate */);\n        this._editor.render();\n        // Translate to absolute editor position\n        const cursorCoords = this._editor.getScrolledVisiblePosition(position);\n        const editorCoords = getDomNodePagePosition(this._editor.getDomNode());\n        const x = editorCoords.left + cursorCoords.left;\n        const y = editorCoords.top + cursorCoords.top + cursorCoords.height;\n        return { x, y };\n    }\n    _shouldShowHeaders() {\n        var _a;\n        const model = (_a = this._editor) === null || _a === void 0 ? void 0 : _a.getModel();\n        return this._configurationService.getValue('editor.codeActionWidget.showHeaders', { resource: model === null || model === void 0 ? void 0 : model.uri });\n    }\n    _getActionBarActions(actions, at, options) {\n        if (options.fromLightbulb) {\n            return [];\n        }\n        const resultActions = actions.documentation.map((command) => {\n            var _a;\n            return ({\n                id: command.id,\n                label: command.title,\n                tooltip: (_a = command.tooltip) !== null && _a !== void 0 ? _a : '',\n                class: undefined,\n                enabled: true,\n                run: () => { var _a; return this._commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : [])); },\n            });\n        });\n        if (options.includeDisabledActions && actions.validActions.length > 0 && actions.allActions.length !== actions.validActions.length) {\n            resultActions.push(this._showDisabled ? {\n                id: 'hideMoreActions',\n                label: localize('hideMoreActions', 'Hide Disabled'),\n                enabled: true,\n                tooltip: '',\n                class: undefined,\n                run: () => {\n                    this._showDisabled = false;\n                    return this.showCodeActionList(actions, at, options);\n                }\n            } : {\n                id: 'showMoreActions',\n                label: localize('showMoreActions', 'Show Disabled'),\n                enabled: true,\n                tooltip: '',\n                class: undefined,\n                run: () => {\n                    this._showDisabled = true;\n                    return this.showCodeActionList(actions, at, options);\n                }\n            });\n        }\n        return resultActions;\n    }\n};\nCodeActionController.ID = 'editor.contrib.codeActionController';\nCodeActionController = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IContextKeyService),\n    __param(3, IInstantiationService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, IEditorProgressService),\n    __param(6, ICommandService),\n    __param(7, IConfigurationService),\n    __param(8, IActionWidgetService),\n    __param(9, IInstantiationService)\n], CodeActionController);\nexport { CodeActionController };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}